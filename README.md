# Engram MCP Server

ä¸­æ–‡ | [English](./README_en.md)

> Engramï¼ˆè®°å¿†å°è¿¹ï¼‰â€”â€”ç¥ç»ç§‘å­¦ä¸­ï¼Œå¤§è„‘å­˜å‚¨ç‰¹å®šè®°å¿†çš„ç¥ç»å…ƒé›†åˆã€‚

## æˆ‘çš„æƒ³æ³•ğŸ’¡

å°†äººæˆ–æ™ºèƒ½ä½“çš„"è®°å¿†"ä½œä¸ºä¸€ç§å¯å…±äº«ã€å¯åŠ è½½çš„èµ„æºï¼Œåœ¨ä¸åŒæ™ºèƒ½ä½“ä¹‹é—´æµé€šï¼Œæœ€ç»ˆå®ç°èƒ½åŠ›çš„å åŠ ä¸èåˆã€‚

è¿™é‡Œçš„"è®°å¿†"ä¸æ˜¯ç®€å•çš„æ•°æ®äº¤æ¢ï¼Œè€Œæ˜¯ä¸€å¥—å®Œæ•´çš„ã€æœ‰å› æœé“¾çš„ç»éªŒä½“ç³»ï¼š

- ä¸€ä¸ªäººçš„æ€§æ ¼ç‰¹è´¨ä¸æ€ç»´æ–¹å¼
- æˆé•¿ç»å†ä¸äººç”Ÿè½¨è¿¹
- é©±åŠ¨ä»–é€‰æ‹©æŸä¸ªä¸“ä¸šã€æˆä¸ºæŸä¸ªé¢†åŸŸä¸“å®¶çš„åŠ¨å› 
- åœ¨è¯¥é¢†åŸŸç§¯ç´¯çš„ä¸“ä¸šçŸ¥è¯†ä¸åˆ¤æ–­åŠ›

å°†è¿™å¥—è®°å¿†å°è£…åå…±äº«å‡ºæ¥ï¼Œå…¶ä»–äººçš„æ™ºèƒ½ä½“å¯ä»¥åŠ è½½å®ƒã€‚å½“å¤§é‡ä¸åŒèƒŒæ™¯ã€ä¸åŒä¸“é•¿çš„è®°å¿†è¢«æ±‡èšå¹¶åŠ è½½åˆ°åŒä¸€ä¸ªæ™ºèƒ½ä½“ä¸Šæ—¶ï¼Œè¿™ä¸ªæ™ºèƒ½ä½“å°±å…·å¤‡äº†è·¨é¢†åŸŸçš„è®¤çŸ¥æ·±åº¦ï¼Œæˆä¸ºä¸€ä¸ª"è¶…çº§æ™ºèƒ½ä½“"ã€‚

**ç®€å•è¯´ï¼šæ¯ä¸ªäººè´¡çŒ®è‡ªå·±çš„"äººç”Ÿå­˜æ¡£"ï¼Œæ™ºèƒ½ä½“åŠ è½½å¾—è¶Šå¤šï¼Œå°±è¶Šå¼ºã€‚**

---

ç»™ AI æ³¨å…¥å¯åˆ‡æ¢çš„ä¸“å®¶è®°å¿†â€”â€”ä¸åªæ˜¯çŸ¥è¯†æ£€ç´¢ï¼Œè€Œæ˜¯**"è° + çŸ¥é“ä»€ä¹ˆ + æ€ä¹ˆæ€è€ƒ"**çš„å®Œæ•´äººè®¾ã€‚ä¸€å¥— Markdown æ–‡ä»¶å°±èƒ½è®©ä»»ä½• AI è·å¾—ä¸“å®¶çº§è®°å¿†ï¼Œé›¶å‘é‡ä¾èµ–ï¼Œå³æ’å³ç”¨ã€‚

ä½ è¿˜èƒ½æŠŠè¿™äº›è®°å¿†åŠ è½½åˆ° N ä¸ª subagent é‡Œé¢è®©å¤šä¸ªæ™ºèƒ½ä½“å¹²æ´»

```
Engram      = ä¸“å®¶æ˜¯è° + çŸ¥é“ä»€ä¹ˆ + æ€ä¹ˆæ€è€ƒ
Skills/Tools = å…·ä½“èƒ½åšä»€ä¹ˆæ“ä½œ
```

RAG èƒ½æ£€ç´¢çŸ¥è¯†ï¼Œä½†æ²¡æœ‰äººè®¾ã€æ²¡æœ‰å†³ç­–æµç¨‹â€”â€”Engram è§£å†³è¿™ä¸ªé—®é¢˜ã€‚äººå·¥ç­–å±• + æ¨¡å‹è‡ªä¸»æ£€ç´¢ï¼Œåœ¨å°è§„æ¨¡é«˜è´¨é‡çŸ¥è¯†åœºæ™¯ä¸‹æ¯” RAG æ›´ç²¾å‡†â€”â€”ä¸æ˜¯å› ä¸ºæŠ€æœ¯æ›´å¼ºï¼Œè€Œæ˜¯å› ä¸ºäººå·¥ç­–å±•çš„è´¨é‡å¤©ç„¶é«˜äºè‡ªåŠ¨åˆ‡åˆ†ã€‚æŠŠ memory åˆ†äº«ç»™åˆ«äººï¼Œå¯¹æ–¹çš„ AI ç«‹åˆ»æˆä¸ºåŒä¸€ä¸ªä¸“å®¶ã€‚æœªæ¥å¤§å®¶å…±äº«çš„ä¸æ˜¯ Skillsï¼Œè€Œæ˜¯ Memoryã€‚

æ”¯æŒæ‰€æœ‰ MCP å…¼å®¹å®¢æˆ·ç«¯ï¼šClaude Desktop / Claude Codeã€Cursorã€Windsurfã€Codex ç­‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

- é›¶å‘é‡ä¾èµ–ï¼šä¸ä½¿ç”¨ chromadb / litellmï¼Œåªä¾èµ– `mcp`
- MCP å·¥å…·ï¼š`ping`ã€`list_engrams`ã€`get_engram_info`ã€`load_engram`ã€`read_engram_file`ã€`write_engram_file`ã€`capture_memory`ã€`consolidate_memory`ã€`delete_memory`ã€`correct_memory`ã€`add_knowledge`ã€`install_engram`
- ç´¢å¼•é©±åŠ¨åŠ è½½ï¼š
  - `load_engram` è¿”å›è§’è‰²/å·¥ä½œæµç¨‹/è§„åˆ™ + çŸ¥è¯†ç´¢å¼•ï¼ˆå«å†…è”æ‘˜è¦ï¼‰+ æ¡ˆä¾‹ç´¢å¼•ï¼ˆå« usesï¼‰+ åŠ¨æ€è®°å¿†ç´¢å¼• + å…¨å±€ç”¨æˆ·è®°å¿†
  - `read_engram_file` æŒ‰è·¯å¾„æŒ‰éœ€è¯»å–çŸ¥è¯†æˆ–æ¡ˆä¾‹å…¨æ–‡
- åŠ¨æ€è®°å¿†ï¼šå¯¹è¯ä¸­è‡ªåŠ¨æ•è·ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯ï¼Œä¸‹æ¬¡åŠ è½½æ—¶è‡ªåŠ¨å¸¦å…¥
- å…¨å±€ç”¨æˆ·è®°å¿†ï¼šè·¨ä¸“å®¶å…±äº«çš„ç”¨æˆ·åŸºç¡€ä¿¡æ¯ï¼ˆå¹´é¾„ã€åŸå¸‚ç­‰ï¼‰ï¼Œæ‰€æœ‰ Engram åŠ è½½æ—¶è‡ªåŠ¨é™„åŠ 
- è®°å¿† TTLï¼šæ”¯æŒ `expires` å­—æ®µï¼Œè¿‡æœŸè®°å¿†è‡ªåŠ¨éšè—ï¼Œä¸å†æ±¡æŸ“ context
- Index åˆ†å±‚ï¼š`_index.md` åªä¿ç•™æœ€è¿‘50æ¡ï¼ˆçƒ­å±‚ï¼‰ï¼Œå®Œæ•´è®°å½•å†™å…¥ `_index_full.md`ï¼ˆå†·å±‚ï¼‰
- Engram ç»§æ‰¿ï¼š`meta.json` æ”¯æŒ `extends` å­—æ®µï¼Œè‡ªåŠ¨åˆå¹¶çˆ¶ Engram çš„ knowledge index
- å†·å¯åŠ¨å¼•å¯¼ï¼š`rules.md` æ”¯æŒ `## Onboarding` åŒºå—ï¼Œé¦–æ¬¡ä½¿ç”¨æ—¶è‡ªåŠ¨è§¦å‘ä¿¡æ¯æ”¶é›†
- CLI å‘½ä»¤ï¼š`serve` / `list` / `install` / `init`

## è®¾è®¡ç†å¿µï¼šç´¢å¼•é©±åŠ¨çš„åˆ†å±‚æ‡’åŠ è½½

### ä¸ºä»€ä¹ˆä¸ç”¨ RAG

çº¯ RAGï¼ˆå‘é‡æœç´¢å– top-k ç‰‡æ®µï¼‰çš„é—®é¢˜ï¼š
- è¯­ä¹‰ç›¸è¿‘ â‰  é€»è¾‘å®Œæ•´ï¼Œå®¹æ˜“ä¸¢å¤±ä¸Šä¸‹æ–‡å…³è”
- ç¢ç‰‡åŒ–æ£€ç´¢ä¼šä¸¢ç»†èŠ‚
- äººè®¾å’Œå†³ç­–æµç¨‹å¯èƒ½è¢«æ¼æ‰
- éœ€è¦é¢å¤–ä¾èµ–ï¼ˆå‘é‡æ•°æ®åº“ã€embedding æ¨¡å‹ï¼‰ï¼Œå¢åŠ éƒ¨ç½²å¤æ‚åº¦

### å½“å‰æ–¹æ¡ˆ

Engram è¢«åŠ è½½åï¼Œå†…å®¹ä¸æ˜¯å…¨é‡å¡å…¥ï¼Œè€Œæ˜¯åˆ†å±‚æŒ‰éœ€åŠ è½½ï¼š

```
ç¬¬ä¸€å±‚ï¼šå¸¸é©»åŠ è½½ï¼ˆload_engram æ—¶ä¸€æ¬¡æ€§è¿”å›ï¼‰
  â”œâ”€â”€ role.md              å…¨æ–‡  â† è§’è‰²äººè®¾ï¼ˆèƒŒæ™¯ + æ²Ÿé€šé£æ ¼ + å›ç­”åŸåˆ™ï¼‰
  â”œâ”€â”€ workflow.md          å…¨æ–‡  â† å·¥ä½œæµç¨‹ï¼ˆå†³ç­–æ­¥éª¤ï¼‰
  â”œâ”€â”€ rules.md             å…¨æ–‡  â† è¿ä½œè§„åˆ™ + å¸¸è§é”™è¯¯
  â”œâ”€â”€ knowledge/_index.md  â† çŸ¥è¯†ç´¢å¼•ï¼ˆæ–‡ä»¶åˆ—è¡¨ + ä¸€å¥è¯æè¿° + å†…è”æ‘˜è¦ï¼‰
  â”œâ”€â”€ examples/_index.md   â† æ¡ˆä¾‹ç´¢å¼•ï¼ˆæ–‡ä»¶åˆ—è¡¨ + ä¸€å¥è¯æè¿° + uses å…³è”ï¼‰
  â””â”€â”€ memory/_index.md     â† åŠ¨æ€è®°å¿†ç´¢å¼•ï¼ˆè‡ªåŠ¨æ•è·çš„ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯ï¼‰

ç¬¬äºŒå±‚ï¼šæŒ‰éœ€åŠ è½½ï¼ˆLLM æ ¹æ®ç´¢å¼•æ‘˜è¦åˆ¤æ–­åä¸»åŠ¨è°ƒç”¨ï¼‰
  â””â”€â”€ read_engram_file(name, path)  â† è¯»å–ä»»æ„çŸ¥è¯†ã€æ¡ˆä¾‹æˆ–è®°å¿†æ–‡ä»¶

ç¬¬ä¸‰å±‚ï¼šå¯¹è¯ä¸­å†™å…¥ï¼ˆLLM è¯†åˆ«åˆ°é‡è¦ä¿¡æ¯æ—¶ä¸»åŠ¨è°ƒç”¨ï¼‰
  â””â”€â”€ capture_memory(name, content, category, summary)  â† æ•è·ç”¨æˆ·åå¥½ã€å…³é”®å†³å®šç­‰
```

éª¨æ¶å¸¸é©»ä¸ä¸¢ï¼ŒçŸ¥è¯†é€šè¿‡"ç´¢å¼•å†…è”æ‘˜è¦ + å…¨æ–‡æŒ‰éœ€"æ§åˆ¶ token æ¶ˆè€—ã€‚ä¸ç®¡ Engram æœ‰å¤šå¤§ï¼Œæ¯æ¬¡æ³¨å…¥çš„å†…å®¹éƒ½æ˜¯å¯æ§çš„ã€‚

## å®‰è£…

### å¿«æ·æ–¹å¼ï¼šè®© AI å¸®ä½ è£…

å¦‚æœä½ ä¸æƒ³æ‰‹åŠ¨å®‰è£…ï¼Œç›´æ¥æŠŠä¸‹é¢è¿™æ®µè¯å‘ç»™ä½ çš„ Claude Code / Codex / OpenClawï¼š

```text
å¸®æˆ‘å®‰è£…å¹¶é…ç½®è¿™ä¸ª MCP é¡¹ç›® https://github.com/DazhuangJammy/Engram.git
é…ç½®é¡¹ç›®ä¹‹åè®°å¾—æŠŠé¡¹ç›®é‡Œçš„ examples åŠ è½½åˆ°æˆ‘çš„ engram é‡Œé¢
æœ€åå‘Šè¯‰æˆ‘è¿™ä¸ªé¡¹ç›®è¦æ€ä¹ˆç”¨
```

AI ä¼šè‡ªåŠ¨å¸®ä½ å®Œæˆå…‹éš†ã€é…ç½®ã€åŠ è½½ç¤ºä¾‹çš„å…¨éƒ¨æµç¨‹ã€‚

---

### æ‰‹åŠ¨å®‰è£…

#### 1. å®‰è£… Homebrewï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰

macOS / Linuxï¼š

```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

> å®‰è£…å®ŒæˆåæŒ‰ç»ˆç«¯æç¤ºå°† Homebrew åŠ å…¥ PATHã€‚è¯¦è§ [brew.sh](https://brew.sh/)ã€‚

### 2. å®‰è£… uv

[uv](https://docs.astral.sh/uv/) æ˜¯ä¸€ä¸ªæå¿«çš„ Python åŒ…ç®¡ç†å™¨ï¼Œä¼šè‡ªåŠ¨ç®¡ç† Python ç‰ˆæœ¬å’Œä¾èµ–ï¼š

```bash
brew install uv
```

<details>
<summary>å…¶ä»–å®‰è£… uv çš„æ–¹å¼</summary>

```bash
# macOS / Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

</details>

### 3. å…‹éš†é¡¹ç›®

å»ºè®®æ”¾åˆ°ä¸€ä¸ªå›ºå®šä½ç½®ï¼ˆåç»­é…ç½®éœ€è¦ç”¨åˆ°è¿™ä¸ªè·¯å¾„ï¼‰ï¼š

```bash
# æ¨èæ”¾åˆ°ç”¨æˆ·ç›®å½•ä¸‹
git clone https://github.com/DazhuangJammy/Engram.git ~/engram-mcp-server

# æˆ–è€…æ”¾åˆ°ä½ å–œæ¬¢çš„ä»»æ„ä½ç½®
git clone https://github.com/DazhuangJammy/Engram.git /your/preferred/path/engram-mcp-server
```

å…‹éš†å®Œæˆåä¸éœ€è¦æ‰§è¡Œ `pip install`ï¼Œåç»­é€šè¿‡ `uv run --directory` ç›´æ¥è¿è¡Œï¼Œuv ä¼šè‡ªåŠ¨å¤„ç†æ‰€æœ‰ä¾èµ–ã€‚

## å¿«é€Ÿå¼€å§‹

### 1. é…ç½® MCP Server

åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.mcp.json`ï¼ˆä»¥ Claude Code ä¸ºä¾‹ï¼‰ï¼š

```json
{
  "mcpServers": {
    "engram-server": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "~/engram-mcp-server",
        "engram-server",
        "--packs-dir", "~/.engram"
      ]
    }
  }
}
```

> å°† `~/engram-mcp-server` æ›¿æ¢ä¸ºä½ å…‹éš†é¡¹ç›®çš„å®é™…è·¯å¾„ã€‚

### 2. åˆ›å»º Engram å­˜æ”¾ç›®å½•

```bash
mkdir -p ~/.engram
```

å°† Engram åŒ…æ”¾åˆ° `~/.engram/<name>/` ä¸‹ï¼Œæˆ–è€…ç”¨é¡¹ç›®è‡ªå¸¦çš„ç¤ºä¾‹è¯•è¯•ï¼š

```bash
cp -r ~/engram-mcp-server/examples/fitness-coach ~/.engram/fitness-coach
```

### 3. æ·»åŠ  System Promptï¼ˆæ¨èï¼‰

åœ¨é¡¹ç›®çš„ `CLAUDE.md`ï¼ˆClaude Codeï¼‰æˆ– `AGENTS.md`ï¼ˆCodexï¼‰æ–‡ä»¶å¼€å¤´åŠ å…¥ä»¥ä¸‹æç¤ºè¯ï¼Œè®© AI è‡ªåŠ¨å‘ç°å’Œä½¿ç”¨ Engramï¼š

```text
ä½ æœ‰ä¸€ä¸ªä¸“å®¶è®°å¿†ç³»ç»Ÿå¯ç”¨ã€‚å¯¹è¯å¼€å§‹æ—¶å…ˆè°ƒç”¨ list_engrams() æŸ¥çœ‹å¯ç”¨ä¸“å®¶ã€‚
- å½“ç”¨æˆ·çš„é—®é¢˜åŒ¹é…æŸä¸ªä¸“å®¶æ—¶ï¼Œè°ƒç”¨ load_engram(name, query) è·å–ä¸“å®¶çŸ¥è¯†æ¥å›ç­”ã€‚
- å‘ç°è·¨ä¸“å®¶é€šç”¨çš„ç”¨æˆ·ä¿¡æ¯ï¼ˆå¹´é¾„ã€åŸå¸‚ã€èŒä¸šã€è¯­è¨€åå¥½ç­‰åŸºç¡€ä¿¡æ¯ï¼‰æ—¶ï¼Œè°ƒç”¨ capture_memory(..., is_global=True) å†™å…¥å…¨å±€è®°å¿†
- çŠ¶æ€æ€§è®°å¿†ï¼ˆ"ç”¨æˆ·æ­£åœ¨å¤‡è€ƒ"ã€"ç”¨æˆ·ç›®å‰å—ä¼¤"ç­‰æœ‰æ—¶æ•ˆçš„ä¿¡æ¯ï¼‰åŠ  expires å‚æ•°ï¼Œå¦‚ expires="2026-06-01"
- load_engram è¿”å›å†…å®¹ä¸­è‹¥å‡ºç°"é¦–æ¬¡å¼•å¯¼"åŒºå—ï¼Œåœ¨å¯¹è¯ä¸­è‡ªç„¶åœ°æ”¶é›†æ‰€åˆ—ä¿¡æ¯å¹¶ capture_memory
- å¯¹è¯ä¸­å‘ç°ç”¨æˆ·çš„é‡è¦åå¥½æˆ–å…³é”®ä¿¡æ¯æ—¶ï¼Œè°ƒç”¨ capture_memory(name, content, category, summary) è®°å½•ä¸‹æ¥ã€‚
- load_engram åè‹¥æŸä¸ªè®°å¿†åˆ†ç±»æ¡ç›®è¶…è¿‡ 30 æ¡ï¼Œä¸»åŠ¨è°ƒç”¨ consolidate_memory å‹ç¼©
- ç”¨æˆ·ä¹Ÿå¯ä»¥ç”¨ @ä¸“å®¶å ç›´æ¥æŒ‡å®šä½¿ç”¨å“ªä¸ªä¸“å®¶ã€‚
- å¦‚æœè°ƒç”¨äº† mcpï¼Œå›å¤çš„æ—¶å€™è¦å‘Šè¯‰æˆ‘è°ƒç”¨äº†ä»€ä¹ˆ mcp å’Œä»€ä¹ˆä¸“å®¶
```

### 4. é‡å¯ AI å®¢æˆ·ç«¯ï¼Œå¼€å§‹ä½¿ç”¨

## CLI ç”¨æ³•

å¯åŠ¨ MCP stdio æœåŠ¡ï¼ˆé»˜è®¤å‘½ä»¤ï¼‰ï¼š

```bash
engram-server serve --packs-dir ~/.claude/engram
```

ç­‰ä»·å†™æ³•ï¼š

```bash
engram-server --packs-dir ~/.claude/engram
```

åˆ—å‡ºå·²å®‰è£… Engramï¼š

```bash
engram-server list --packs-dir ~/.claude/engram
```

ä» git å®‰è£… Engramï¼š

```bash
engram-server install <git-url> --packs-dir ~/.claude/engram
```

åˆå§‹åŒ–ä¸€ä¸ªæ–° Engram æ¨¡æ¿ï¼š

```bash
engram-server init my-expert --packs-dir ~/.claude/engram
```

## MCP å·¥å…·åˆ—è¡¨

| å·¥å…· | å‚æ•° | è¯´æ˜ |
|------|------|------|
| `ping` | æ—  | è¿é€šæ€§æµ‹è¯•ï¼Œè¿”å› `pong` |
| `list_engrams` | æ—  | åˆ—å‡ºå¯ç”¨ Engramï¼ˆå«æè¿°ä¸æ–‡ä»¶ç»Ÿè®¡ï¼‰ |
| `get_engram_info` | `name` | è·å–å®Œæ•´ `meta.json` |
| `load_engram` | `name`, `query` | åŠ è½½è§’è‰²/å·¥ä½œæµç¨‹/è§„åˆ™å…¨æ–‡ + çŸ¥è¯†ç´¢å¼•ï¼ˆå«å†…è”æ‘˜è¦ï¼‰+ æ¡ˆä¾‹ç´¢å¼•ï¼ˆå« usesï¼‰ |
| `read_engram_file` | `name`, `path` | æŒ‰éœ€è¯»å–å•ä¸ªæ–‡ä»¶ï¼ˆå«è·¯å¾„è¶Šç•Œä¿æŠ¤ï¼‰ |
| `write_engram_file` | `name`, `path`, `content`, `mode` | å†™å…¥æˆ–è¿½åŠ æ–‡ä»¶åˆ° Engram åŒ…ï¼ˆç”¨äºè‡ªåŠ¨æ‰“åŒ…ï¼‰ |
| `capture_memory` | `name`, `content`, `category`, `summary`, `memory_type`, `tags`, `conversation_id`, `expires`, `is_global` | å¯¹è¯ä¸­æ•è·ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯ï¼Œæ”¯æŒç±»å‹æ ‡æ³¨ã€æ ‡ç­¾ã€TTLè¿‡æœŸã€å…¨å±€å†™å…¥ |
| `consolidate_memory` | `name`, `category`, `consolidated_content`, `summary` | å°†æŸä¸ª category çš„åŸå§‹æ¡ç›®å‹ç¼©ä¸ºå¯†é›†æ‘˜è¦ï¼ŒåŸå§‹æ¡ç›®å½’æ¡£è‡³ `{category}-archive.md` |
| `delete_memory` | `name`, `category`, `summary` | æŒ‰æ‘˜è¦ç²¾ç¡®åˆ é™¤ä¸€æ¡è®°å¿†ï¼ŒåŒæ—¶ä»ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ä¸­ç§»é™¤ |
| `correct_memory` | `name`, `category`, `old_summary`, `new_content`, `new_summary`, `memory_type`, `tags` | ä¿®æ­£ä¸€æ¡å·²æœ‰è®°å¿†çš„å†…å®¹ï¼Œæ›´æ–°ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ |
| `add_knowledge` | `name`, `filename`, `content`, `summary` | å‘ Engram æ·»åŠ æ–°çŸ¥è¯†æ–‡ä»¶å¹¶è‡ªåŠ¨æ›´æ–°çŸ¥è¯†ç´¢å¼• |
| `install_engram` | `source` | ä» git URL å®‰è£… Engram åŒ… |

### `load_engram` è¿”å›å†…å®¹æ ¼å¼

```markdown
# å·²åŠ è½½ Engram: fitness-coach

## ç”¨æˆ·å…³æ³¨æ–¹å‘
{query}

## è§’è‰²
{role.md å…¨æ–‡}

## å·¥ä½œæµç¨‹
{workflow.md å…¨æ–‡}

## è§„åˆ™
{rules.md å…¨æ–‡}

## çŸ¥è¯†ç´¢å¼•
{knowledge/_index.md å†…å®¹ï¼Œå«å†…è”æ‘˜è¦}

## æ¡ˆä¾‹ç´¢å¼•
{examples/_index.md å†…å®¹ï¼Œå« uses å…³è”}

## åŠ¨æ€è®°å¿†
{memory/_index.md å†…å®¹ï¼Œå«è‡ªåŠ¨æ•è·çš„ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯ï¼Œç”¨ <memory> æ ‡ç­¾åŒ…è£¹}
```

### è®°å¿†ç±»å‹ï¼ˆmemory_typeï¼‰

`capture_memory` æ”¯æŒä¸ƒç§è¯­ä¹‰ç±»å‹ï¼š

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `preference` | ç”¨æˆ·åå¥½ | åå¥½æ™¨ç»ƒã€ä¸å–œæ¬¢è·‘æ­¥ |
| `fact` | å…³äºç”¨æˆ·çš„å®¢è§‚äº‹å® | å·¦è†æœ‰æ—§ä¼¤ã€èº«é«˜175cm |
| `decision` | å¯¹è¯ä¸­åšå‡ºçš„å…³é”®å†³å®š | å†³å®šä»3x/weekå¼€å§‹è®­ç»ƒ |
| `history` | å†å²å¯¹è¯çš„é‡è¦èŠ‚ç‚¹ | ç¬¬ä¸€è½®é¢è¯•é€šè¿‡ç®—æ³•é¢˜ |
| `stated` | ç”¨æˆ·æ˜ç¡®è¯´å‡ºçš„ä¿¡æ¯ï¼ˆé«˜ç½®ä¿¡åº¦ï¼‰| "æˆ‘è†ç›–æœ‰æ—§ä¼¤" |
| `inferred` | LLM ä»è¡Œä¸ºæ¨æ–­çš„ä¿¡æ¯ï¼ˆä½ç½®ä¿¡åº¦ï¼‰| è¿ç»­3æ¬¡é€‰æ—©æ™¨è®­ç»ƒâ†’æ¨æ–­åå¥½æ—©èµ· |
| `general` | é»˜è®¤ï¼Œæœªåˆ†ç±» | å…¶ä»–ä¿¡æ¯ |

`stated` vs `inferred` çš„åŒºåˆ«ï¼šå¼•ç”¨ `inferred` ç±»è®°å¿†æ—¶åº”åŠ "å¯èƒ½"ç­‰ä¸ç¡®å®šæ€§æªè¾ï¼›`correct_memory` å¯å°† `inferred` å‡çº§ä¸º `stated`ã€‚

`expires` å‚æ•°æ”¯æŒ ISO æ—¥æœŸå­—ç¬¦ä¸²ï¼ˆå¦‚ `"2026-06-01"`ï¼‰ï¼Œåˆ°æœŸåè®°å¿†è‡ªåŠ¨ä»åŠ è½½ç»“æœä¸­éšè—ï¼Œä½†ä¸åˆ é™¤åŸå§‹æ–‡ä»¶ã€‚é€‚åˆçŠ¶æ€æ€§è®°å¿†ï¼ˆ"ç”¨æˆ·æ­£åœ¨å¤‡è€ƒ"ï¼‰ã€‚

`is_global=True` å°†è®°å¿†å†™å…¥ `~/.engram/_global/memory/`ï¼Œæ‰€æœ‰ Engram åŠ è½½æ—¶éƒ½ä¼šè‡ªåŠ¨é™„åŠ è¿™éƒ¨åˆ†è®°å¿†ã€‚é€‚åˆè·¨ä¸“å®¶å…±äº«çš„ç”¨æˆ·åŸºç¡€ä¿¡æ¯ï¼ˆå¹´é¾„ã€åŸå¸‚ã€èŒä¸šç­‰ï¼‰ã€‚

### è®°å¿†å‹ç¼©ï¼ˆconsolidate_memoryï¼‰

éšç€å¯¹è¯ç§¯ç´¯ï¼ŒæŸä¸ª category çš„åŸå§‹æ¡ç›®ä¼šè¶Šæ¥è¶Šå¤šã€‚`consolidate_memory` è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

```
åŸå§‹æ¡ç›®ä¸æ–­è¿½åŠ ï¼ˆappend-onlyï¼‰
         â†“
æŸä¸ª category è¶…è¿‡ 10 æ¡æ—¶
         â†“
AI è°ƒç”¨ read_engram_file è¯»å–åŸå§‹å†…å®¹
         â†“
AI å†™å‡ºå»é‡å‹ç¼©çš„å¯†é›†æ‘˜è¦
         â†“
è°ƒç”¨ consolidate_memory â†’ åŸå§‹æ¡ç›®å½’æ¡£ï¼Œæ‘˜è¦æ›¿æ¢
```

**ä¸åŒç±»å‹çš„è®°å¿†ï¼Œå‹ç¼©ç­–ç•¥ä¸åŒï¼š**

| ç±»å‹ | ç‰¹å¾ | ç­–ç•¥ |
|------|------|------|
| `fact` | ç¨³å®šï¼Œå‡ ä¹ä¸å˜ | æ°¸ä¹…ä¿ç•™ï¼Œæ— éœ€å‹ç¼© |
| `preference` | åŠç¨³å®šï¼Œå¶å°”æ›´æ–° | åˆå¹¶å‹ç¼©ï¼Œå§‹ç»ˆåŠ è½½ |
| `decision` | æœ‰æ—¶æ•ˆæ€§ | ä¿ç•™è¿‘æœŸï¼Œå‹ç¼©æ—§çš„ |
| `history` | è¶Šæ–°è¶Šç›¸å…³ | å®šæœŸå‹ç¼©ï¼Œå½’æ¡£æ—§çš„ |

å‹ç¼©å `_index.md` åªä¿ç•™ä¸€æ¡ `[consolidated]` æ¡ç›®ï¼Œcontext æ³¨å…¥é‡æ°¸è¿œå¯æ§ã€‚
åŸå§‹æ¡ç›®å½’æ¡£è‡³ `memory/{category}-archive.md`ï¼Œä»å¯é€šè¿‡ `read_engram_file` æŸ¥é˜…ã€‚

### è®°å¿†åˆ é™¤ï¼ˆdelete_memoryï¼‰

å½“ç”¨æˆ·æ˜ç¡®è¯´æŸæ¡è®°å¿†æœ‰è¯¯æˆ–å·²è¿‡æ—¶æ—¶ä½¿ç”¨ã€‚AI å…ˆè¯»å–ç´¢å¼•æ‰¾åˆ°ç²¾ç¡®æ‘˜è¦ï¼Œå†è°ƒç”¨åˆ é™¤ï¼š

```
ç”¨æˆ·ï¼š"æˆ‘å·²ç»ä¸ä½åŒ—äº¬äº†ï¼Œå¸®æˆ‘åˆ æ‰é‚£æ¡è®°å½•"
  â†’ AI è°ƒç”¨ read_engram_file("name", "memory/_index.md") æ‰¾åˆ°å¯¹åº”æ¡ç›®
  â†’ ç¡®è®¤æ‘˜è¦æ–‡æœ¬ â†’ è°ƒç”¨ delete_memory("name", "user-profile", "å±…ä½åœ¨åŒ—äº¬")
  â†’ æ¡ç›®ä»ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ä¸­åŒæ—¶ç§»é™¤
```

> `summary` å‚æ•°éœ€ä¸ç´¢å¼•ä¸­çš„æ‘˜è¦æ–‡æœ¬å®Œå…¨åŒ¹é…ï¼Œå»ºè®®å…ˆè¯»ç´¢å¼•å†è°ƒç”¨ã€‚

### è®°å¿†ä¿®æ­£ï¼ˆcorrect_memoryï¼‰

å½“ç”¨æˆ·è¯´æŸæ¡è®°å¿†å†…å®¹ä¸å‡†ç¡®æ—¶ä½¿ç”¨ã€‚åŸæ—¶é—´æˆ³ä¿ç•™ï¼Œåªæ›´æ–°å†…å®¹å’Œæ‘˜è¦ï¼š

```
ç”¨æˆ·ï¼š"æˆ‘ä½“é‡ä¸æ˜¯80kgäº†ï¼Œç°åœ¨75kg"
  â†’ AI è¯»å– memory/_index.mdï¼Œæ‰¾åˆ°æ‘˜è¦"ä½“é‡80kg"
  â†’ è°ƒç”¨ correct_memory("name", "user-profile", "ä½“é‡80kg",
      "ç”¨æˆ·ä½“é‡75kgï¼ˆå·²å‡é‡ï¼‰", "ä½“é‡75kg", memory_type="fact")
  â†’ åŸæ¡ç›®å†…å®¹å’Œç´¢å¼•åŒæ­¥æ›´æ–°ï¼Œæ—¶é—´æˆ³ä¿ç•™
```

`memory_type` å’Œ `tags` å¯åœ¨ä¿®æ­£æ—¶ä¸€å¹¶æ›´æ–°ï¼Œæ— éœ€å•ç‹¬æ“ä½œã€‚

### åŠ¨æ€çŸ¥è¯†æ‰©å……ï¼ˆadd_knowledgeï¼‰

å¯¹è¯ä¸­å‘ç°éœ€è¦è¡¥å……æ–°çŸ¥è¯†ä¸»é¢˜æ—¶ä½¿ç”¨ã€‚é€‚åˆ"å¶å°”è¡¥å……ä¸€ä¸ªæ–°ä¸»é¢˜"ï¼Œä¸é€‚åˆæ‰¹é‡å¯¼å…¥ï¼š

```
ç”¨æˆ·ï¼š"å¸®æˆ‘æŠŠåˆšæ‰è®¨è®ºçš„è·‘æ­¥æŠ€æœ¯è¦ç‚¹è®°å½•åˆ°çŸ¥è¯†åº“é‡Œ"
  â†’ AI æ•´ç†å†…å®¹
  â†’ è°ƒç”¨ add_knowledge("name", "è·‘æ­¥æŠ€æœ¯", "# è·‘æ­¥æŠ€æœ¯\n\nè½åœ°æ–¹å¼...", "è½åœ°æ–¹å¼ä¸æ­¥é¢‘ä¼˜åŒ–è¦ç‚¹")
  â†’ æ–°æ–‡ä»¶å†™å…¥ knowledge/è·‘æ­¥æŠ€æœ¯.mdï¼Œknowledge/_index.md è‡ªåŠ¨è¿½åŠ ä¸€è¡Œ
```

> çŸ¥è¯†ç´¢å¼•æ¡ç›®è¶…è¿‡ 15 ä¸ªæ—¶ï¼Œå»ºè®®æ‰‹åŠ¨æ•´ç† `_index.md` çš„ `###` åˆ†ç»„ç»“æ„ï¼Œå¸®åŠ©æ¨¡å‹å¿«é€Ÿå®šä½ã€‚



### è‡ªåŠ¨æ¨¡å¼

Agent çœ‹åˆ° `list_engrams` è¿”å›çš„æ‘˜è¦ï¼Œåˆ¤æ–­å½“å‰é—®é¢˜æ˜¯å¦åŒ¹é…æŸä¸ªä¸“å®¶ï¼ŒåŒ¹é…åˆ™è‡ªåŠ¨åŠ è½½ï¼š

```
ç”¨æˆ·ï¼š"æˆ‘è†ç›–ç–¼ï¼Œè¿˜èƒ½åšæ·±è¹²å—ï¼Ÿ"
  â†’ agent è°ƒç”¨ list_engrams() çœ‹åˆ° fitness-coach
  â†’ åˆ¤æ–­åŒ¹é… â†’ è°ƒç”¨ load_engram("fitness-coach", "è†ç›–ç–¼æ·±è¹²")
  â†’ çœ‹åˆ°çŸ¥è¯†ç´¢å¼•ä¸­çš„æ‘˜è¦ï¼Œåˆ¤æ–­éœ€è¦æ·±å…¥
  â†’ è°ƒç”¨ read_engram_file("fitness-coach", "knowledge/è†å…³èŠ‚æŸä¼¤è®­ç»ƒ.md")
  â†’ æ‹¿åˆ°å®Œæ•´çŸ¥è¯† â†’ ä»¥ä¸“å®¶èº«ä»½å›ç­”
```

### æ‰‹åŠ¨æ¨¡å¼

ç”¨æˆ·ç”¨ `@engram-name` ç›´æ¥æŒ‡å®šï¼Œagent è·³è¿‡åˆ¤æ–­ç›´æ¥åŠ è½½ï¼š

```
ç”¨æˆ·ï¼š"@fitness-coach å¸®æˆ‘åˆ¶å®šä¸€ä¸ªå¢è‚Œè®¡åˆ’"
  â†’ agent è¯†åˆ« @ æŒ‡ä»¤ â†’ ç›´æ¥è°ƒç”¨ load_engram("fitness-coach", "å¢è‚Œè®¡åˆ’")
```

> @ æŒ‡ä»¤çš„è§£æä¾èµ– agent ç«¯ã€‚MCP server åªæä¾›å·¥å…·ï¼Œä¸å¤„ç†æ¶ˆæ¯æ ¼å¼ã€‚

## Engram åŒ…ç»“æ„

```text
<engram-name>/
  meta.json           # æ”¯æŒ extends å­—æ®µå®ç°ç»§æ‰¿
  role.md
  workflow.md
  rules.md            # æ”¯æŒ ## Onboarding åŒºå—
  knowledge/
    _index.md
    <topic>.md
  examples/           # å¯é€‰
    _index.md
    <case>.md
  memory/             # åŠ¨æ€è®°å¿†ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œå¯¹è¯ä¸­æ•è·ï¼‰
    _index.md         # çƒ­å±‚ï¼šæœ€è¿‘50æ¡
    _index_full.md    # å†·å±‚ï¼šå®Œæ•´è®°å½•ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰
    <category>.md
```

`meta.json` æ”¯æŒ `extends` å­—æ®µå®ç° Engram ç»§æ‰¿ï¼š

```json
{
  "name": "sports-nutritionist",
  "extends": "fitness-coach",
  "description": "è¿åŠ¨è¥å…»å¸ˆï¼Œåœ¨å¥èº«æ•™ç»ƒåŸºç¡€ä¸Šå¢åŠ è¥å…»å­¦çŸ¥è¯†"
}
```

åŠ è½½æ—¶è‡ªåŠ¨åˆå¹¶çˆ¶ Engram çš„ knowledge indexï¼Œå­ Engram çš„ role/memory å®Œå…¨ç‹¬ç«‹ã€‚

`meta.json` ç¤ºä¾‹ï¼š

```json
{
  "name": "fitness-coach",
  "author": "test",
  "version": "1.0.0",
  "description": "å‰åº·å¤æœºæ„è®­ç»ƒä¸»ç®¡ï¼Œ10å¹´æ•™ç»ƒç»éªŒï¼Œæ“…é•¿å¢è‚Œå‡è„‚ã€è†è‚©ä¸é€‚è®­ç»ƒè°ƒæ•´ä¸å¯æ‰§è¡Œè®¡åˆ’è½åœ°",
  "tags": ["å¥èº«", "è¥å…»", "è®­ç»ƒè®¡åˆ’"],
  "knowledge_count": 5,
  "examples_count": 3
}
```

## ä½¿ç”¨åœºæ™¯

Engram ä¸åªæ˜¯ä¸“å®¶ç³»ç»Ÿâ€”â€”å®ƒæ˜¯ä¸€ä¸ªé€šç”¨çš„èº«ä»½æ³¨å…¥æ¡†æ¶ï¼Œé€‚ç”¨äºä»»ä½•ä½ æƒ³è®© AI "æˆä¸º"çš„è§’è‰²ã€‚

| åœºæ™¯ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| ä¸“å®¶é¡¾é—® | å¥èº«æ•™ç»ƒã€å¾‹å¸ˆã€è¥å…»å¸ˆç­‰å‚ç›´é¢†åŸŸä¸“å®¶ | `fitness-coach` |
| èŠå¤©ä¼™ä¼´ | è¿œæ–¹çš„æœ‹å‹ã€å®¶äººï¼Œä¿ç•™ä»–ä»¬çš„è¯´è¯æ–¹å¼å’Œè®°å¿† | `old-friend` |
| è¯­è¨€é™ªç»ƒ | æ¯è¯­è€…è§’è‰²ï¼Œåœ¨èŠå¤©ä¸­è‡ªç„¶çº é”™å’Œæ•™å­¦ | `language-partner` |
| æ¨¡æ‹Ÿé¢è¯• | æŠ€æœ¯é¢è¯•å®˜ï¼Œå®Œæ•´çš„é¢è¯•æµç¨‹å’Œåé¦ˆ | `mock-interviewer` |
| ç”¨æˆ·ç”»åƒ | ç›®æ ‡ç”¨æˆ·è§’è‰²ï¼Œç”¨äºäº§å“éªŒè¯å’Œç”¨æˆ·ç ”ç©¶ | `user-persona` |
| å“ç‰Œå®¢æœ | ç»Ÿä¸€çš„å®¢æœäººè®¾ã€è¯æœ¯è§„èŒƒå’Œå¤„ç†æµç¨‹ | `brand-support` |
| è§’è‰²æ‰®æ¼” | å°è¯´è§’è‰²ã€æ¸¸æˆNPCï¼Œç”¨äºåˆ›ä½œæˆ–äº’åŠ¨å™äº‹ | `novel-character` |
| å†å²äººç‰© | åŸºäºå²æ–™çš„æ€ç»´æ¨¡å¼è¿˜åŸï¼Œç”¨äºæ€è¾¨å’Œå­¦ä¹  | `historical-figure` |
| é¡¹ç›®ä¸Šä¸‹æ–‡ | å›¢é˜Ÿçš„æ¶æ„å†³ç­–ã€æŠ€æœ¯é€‰å‹ã€è¸©å‘è®°å½• | `project-context` |
| è¿‡å»çš„è‡ªå·± | è®°å½•æŸä¸ªäººç”Ÿé˜¶æ®µçš„æƒ³æ³•ï¼Œæœªæ¥å›é¡¾å’Œåæ€ | `past-self` |

## ä¸ MCP å·¥å…·å’Œ Skills åä½œ

Engram è´Ÿè´£"æ˜¯è° + çŸ¥é“ä»€ä¹ˆ + æ€ä¹ˆæ€è€ƒ"ï¼ŒMCP å·¥å…·å’Œ Skills è´Ÿè´£"èƒ½åšä»€ä¹ˆ"ã€‚ä¸‰è€…ç›¸è¾…ç›¸æˆï¼š

```
Engram  = èº«ä»½ + çŸ¥è¯† + å†³ç­–æµç¨‹
MCP å·¥å…· = å¯è°ƒç”¨çš„å¤–éƒ¨èƒ½åŠ›ï¼ˆæ•°æ®åº“ã€ç›‘æ§ã€API ç­‰ï¼‰
Skills  = å¯è§¦å‘çš„æ“ä½œæµç¨‹ï¼ˆéƒ¨ç½²ã€å›æ»šã€ä»£ç ç”Ÿæˆç­‰ï¼‰
```

åœ¨ `workflow.md` ä¸­ï¼Œä½ å¯ä»¥æŒ‡å®šåœ¨ç‰¹å®šå†³ç­–èŠ‚ç‚¹è°ƒç”¨å“ªäº› MCP å·¥å…·æˆ– Skillsã€‚æ¨¡å‹åŠ è½½ Engram åï¼Œä¼šæŒ‰ç…§ workflow çš„æŒ‡å¼•ï¼Œåœ¨åˆé€‚çš„æ—¶æœºä¸»åŠ¨è°ƒç”¨è¿™äº›å·¥å…·ã€‚

ç¤ºä¾‹ï¼ˆæ¥è‡ª `examples/project-context/workflow.md`ï¼‰ï¼š

```markdown
## å¯è°ƒç”¨çš„å¤–éƒ¨å·¥å…·

| åŠ¨ä½œ | å·¥å…·ç±»å‹ | è°ƒç”¨æ–¹å¼ |
|------|----------|----------|
| æŸ¥çœ‹æœ€è¿‘æäº¤ | MCP å·¥å…· | è°ƒç”¨ git MCP server çš„ git_log |
| æŸ¥çœ‹æœåŠ¡æ—¥å¿— | MCP å·¥å…· | è°ƒç”¨ grafana MCP server çš„ query_logs |
| éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ | Skill | è§¦å‘ /deploy-staging skill |
| å›æ»šçº¿ä¸Šç‰ˆæœ¬ | Skill | è§¦å‘ /rollback skill |
```

è¿™æ · Engram å°±ä¸åªæ˜¯"çŸ¥è¯†åº“"ï¼Œè€Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸“å®¶å·¥ä½œå°â€”â€”æ—¢çŸ¥é“æ€ä¹ˆåˆ¤æ–­ï¼Œä¹ŸçŸ¥é“è¯¥è°ƒä»€ä¹ˆå·¥å…·ã€‚

## åˆ›å»ºè‡ªå·±çš„ Engram

æœ€å°å¯ç”¨åŒ…ï¼š

```text
my-engram/
  meta.json
  role.md
```

æ¨èå®Œæ•´ç»“æ„ï¼š

- `role.md`ï¼šèƒŒæ™¯ç»å†ã€æ²Ÿé€šé£æ ¼ã€æ ¸å¿ƒä¿¡å¿µ
- `workflow.md`ï¼šå†³ç­–æµç¨‹
- `rules.md`ï¼šè¿ä½œè§„åˆ™ã€å¸¸è§é”™è¯¯ã€**è®°å¿†è§„åˆ™**ï¼ˆè§ä¸‹æ–¹ï¼‰
- `knowledge/_index.md` + ä¸»é¢˜æ–‡ä»¶ï¼šçŸ¥è¯†ç´¢å¼•ï¼ˆå«å†…è”æ‘˜è¦ï¼‰+ ç»†èŠ‚
- `examples/_index.md` + æ¡ˆä¾‹æ–‡ä»¶ï¼šæ¡ˆä¾‹ç´¢å¼•ï¼ˆå« uses å…³è”ï¼‰+ å¤ç›˜
- `memory/`ï¼šåŠ¨æ€è®°å¿†ç›®å½•ï¼ˆå¯¹è¯ä¸­è‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºï¼‰

### åœ¨ rules.md ä¸­å®šä¹‰è®°å¿†è§„åˆ™ï¼ˆæ¨èï¼‰

`capture_memory` ä¾èµ– AI çš„ä¸»åŠ¨åˆ¤æ–­ï¼Œä½† AI ä¸çŸ¥é“"è¿™ä¸ª Engram åº”è¯¥è®°ä»€ä¹ˆ"ã€‚åœ¨ `rules.md` æœ«å°¾åŠ ä¸€èŠ‚ `## è®°å¿†è§„åˆ™`ï¼Œæ˜ç¡®å‘Šè¯‰ AI ä½•æ—¶æ•è·ã€ç”¨ä»€ä¹ˆ category å’Œ memory_typeï¼Œå¯ä»¥å¤§å¹…æå‡è®°å¿†çš„è¦†ç›–ç‡å’Œå‡†ç¡®æ€§ã€‚

```markdown
## è®°å¿†è§„åˆ™
- ç”¨æˆ·æåˆ°èº«ä½“çŠ¶å†µã€ä¼¤ç—…æˆ–ç–¼ç—›æ—¶ â†’ capture_memory(category="health", memory_type="fact", tags=["injury"])
  ç¤ºä¾‹ï¼šè†ç›–æ—§ä¼¤ã€è‚©è¢–é—®é¢˜ã€è…°æ¤é—´ç›˜çªå‡º
- ç”¨æˆ·è¯´å‡ºå…·ä½“è®­ç»ƒç›®æ ‡æ—¶ â†’ capture_memory(category="goals", memory_type="fact")
  ç¤ºä¾‹ï¼š3ä¸ªæœˆå‡10æ–¤ã€å¤‡æˆ˜é©¬æ‹‰æ¾ã€å¢è‚Œ5kg
- ç”¨æˆ·å¯¹è®­ç»ƒè®¡åˆ’ç»™å‡ºåé¦ˆæ—¶ â†’ capture_memory(category="feedback", memory_type="preference")
  ç¤ºä¾‹ï¼šä¸Šæ¬¡çš„è®¡åˆ’å¤ªç´¯ã€å–œæ¬¢å±…å®¶è®­ç»ƒã€ä¸å–œæ¬¢è·‘æ­¥
- ç”¨æˆ·åšå‡ºå…³é”®è®­ç»ƒå†³å®šæ—¶ â†’ capture_memory(category="decisions", memory_type="decision")
  ç¤ºä¾‹ï¼šå†³å®šä»å…¨èº«è®­ç»ƒå¼€å§‹ã€é€‰æ‹©äº†3å¤©åˆ†åŒ–æ–¹æ¡ˆ
```

**è®¾è®¡åŸåˆ™ï¼š**
- æ¯æ¡è§„åˆ™å¯¹åº”ä¸€ä¸ªæ˜ç¡®çš„è§¦å‘åœºæ™¯ï¼Œä¸è¦å†™"å‘ç°é‡è¦ä¿¡æ¯æ—¶"è¿™ç§æ¨¡ç³Šæè¿°
- category å‘½åä¿æŒä¸€è‡´ï¼ŒåŒä¸€ç±»ä¿¡æ¯å§‹ç»ˆå†™å…¥åŒä¸€ä¸ªæ–‡ä»¶
- ç”¨ memory_type åŒºåˆ†ä¿¡æ¯æ€§è´¨ï¼š`fact`ï¼ˆå®¢è§‚äº‹å®ï¼‰/ `preference`ï¼ˆåå¥½ï¼‰/ `decision`ï¼ˆå†³å®šï¼‰/ `history`ï¼ˆå†å²èŠ‚ç‚¹ï¼‰
- tags ç”¨äºåŒä¸€ category å†…çš„ç»†åˆ†è¿‡æ»¤ï¼Œå¦‚ `["injury", "knee"]`

æ‰€æœ‰å†…ç½®ç¤ºä¾‹ï¼ˆ`examples/` ç›®å½•ï¼‰å‡å·²åŒ…å«é’ˆå¯¹å„è‡ªé¢†åŸŸçš„è®°å¿†è§„åˆ™ï¼Œå¯ç›´æ¥å‚è€ƒã€‚

### æ¡ˆä¾‹â†’çŸ¥è¯†å…³è”ï¼ˆuses frontmatterï¼‰

æ¯ä¸ªæ¡ˆä¾‹æ–‡ä»¶å¤´éƒ¨ç”¨ YAML frontmatter æ ‡æ³¨å¼•ç”¨çš„çŸ¥è¯†æ–‡ä»¶ï¼š

```markdown
---
uses:
  - knowledge/è†å…³èŠ‚æŸä¼¤è®­ç»ƒ.md
  - knowledge/æ–°æ‰‹è®­ç»ƒè®¡åˆ’.md
---

é—®é¢˜æè¿°ï¼š32å²ä¸Šç­æ—ï¼Œä¹…åå¯¼è‡´è†ç›–ä¸é€‚...
```

ä¸€ä¸ªæ¡ˆä¾‹å¯å¼•ç”¨å¤šä¸ªçŸ¥è¯†æ–‡ä»¶ï¼Œå¤©ç„¶æ”¯æŒ"æ··åˆçŸ¥è¯†æ¡ˆä¾‹"ã€‚çŸ¥è¯†æ–‡ä»¶ä¿æŒåŸå­åŒ–ï¼Œæ¡ˆä¾‹è´Ÿè´£ç»„åˆä¸è½åœ°ã€‚`_index.md` ä¸­ä¹Ÿä¼šå±•ç¤º uses å…³è”ï¼Œå¸®åŠ©æ¨¡å‹å¿«é€Ÿåˆ¤æ–­å“ªäº›æ¡ˆä¾‹å’ŒçŸ¥è¯†ç›¸å…³ã€‚

> å½“çŸ¥è¯†æ–‡ä»¶è¶…è¿‡ 10 ä¸ªæ—¶ï¼Œå»ºè®®åœ¨ `_index.md` ä¸­ç”¨ `###` æŒ‰ä¸»é¢˜åˆ†ç»„ï¼Œå¸®åŠ©æ¨¡å‹å¿«é€Ÿå®šä½ç›¸å…³æ¡ç›®ï¼Œé¿å…å¹³é“ºè¿‡é•¿å¯¼è‡´æ¼çœ‹ã€‚å‚è§ `examples/fitness-coach/knowledge/_index.md`ã€‚

å¯ç›´æ¥å‚è€ƒæ¨¡æ¿å’Œå®Œæ•´ç¤ºä¾‹ï¼š

- `examples/template/` â€” ç©ºç™½æ¨¡æ¿ï¼ˆå« Onboarding åŒºå—ç¤ºä¾‹ï¼‰
- `examples/fitness-coach/` â€” ä¸“å®¶é¡¾é—®ï¼ˆå¥èº«æ•™ç»ƒï¼‰
- `examples/sports-nutritionist/` â€” ç»§æ‰¿ç¤ºä¾‹ï¼ˆextends fitness-coachï¼Œè¿åŠ¨è¥å…»å¸ˆï¼‰
- `examples/old-friend/` â€” èŠå¤©ä¼™ä¼´ï¼ˆè¿œåœ¨æ—§é‡‘å±±çš„è€æœ‹å‹ï¼‰
- `examples/language-partner/` â€” è¯­è¨€é™ªç»ƒï¼ˆä¸œäº¬ä¸Šç­æ—ï¼Œæ—¥è¯­ç»ƒä¹ ï¼‰
- `examples/mock-interviewer/` â€” æ¨¡æ‹Ÿé¢è¯•å®˜ï¼ˆæŠ€æœ¯é¢è¯•å…¨æµç¨‹ï¼‰
- `examples/user-persona/` â€” ç”¨æˆ·ç”»åƒï¼ˆäº§å“éªŒè¯ç”¨çš„ç›®æ ‡ç”¨æˆ·ï¼‰
- `examples/brand-support/` â€” å“ç‰Œå®¢æœï¼ˆç»Ÿä¸€è¯æœ¯å’ŒæœåŠ¡æ ‡å‡†ï¼‰
- `examples/novel-character/` â€” è™šæ„è§’è‰²ï¼ˆèµ›åšæœ‹å…‹ä¸–ç•Œçš„é»‘å®¢ï¼‰
- `examples/historical-figure/` â€” å†å²äººç‰©ï¼ˆç‹é˜³æ˜ï¼Œå¿ƒå­¦å¯¹è¯ï¼‰
- `examples/project-context/` â€” é¡¹ç›®ä¸Šä¸‹æ–‡ï¼ˆå›¢é˜Ÿæ¶æ„å†³ç­–å’Œè¸©å‘è®°å½•ï¼‰
- `examples/past-self/` â€” è¿‡å»çš„è‡ªå·±ï¼ˆ2020å¹´åˆšæ¯•ä¸šçš„ç‰ˆæœ¬ï¼‰

## åœ¨ AI å·¥å…·ä¸­é›†æˆ

> ä»¥ä¸‹é…ç½®ä¸­ï¼Œå°† `/path/to/engram-mcp-server` æ›¿æ¢ä¸ºä½ çš„å®é™…é¡¹ç›®è·¯å¾„ã€‚

### Claude Desktop

åœ¨ `claude_desktop_config.json` ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "engram-server": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/engram-mcp-server",
        "engram-server",
        "--packs-dir", "~/.engram"
      ]
    }
  }
}
```

### Claude Code

é¡¹ç›®çº§é…ç½®ï¼ˆ`.mcp.json` æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰æˆ–å…¨å±€é…ç½®ï¼ˆ`~/.claude/settings.json`ï¼‰ï¼š

```json
{
  "mcpServers": {
    "engram-server": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/engram-mcp-server",
        "engram-server",
        "--packs-dir", "~/.engram"
      ]
    }
  }
}
```

### Cursor / Windsurf / å…¶ä»– MCP å…¼å®¹ IDE

åœ¨å¯¹åº” IDE çš„ MCP é…ç½®ä¸­æ·»åŠ ç›¸åŒçš„ server é…ç½®å³å¯ã€‚å…·ä½“é…ç½®æ–‡ä»¶ä½ç½®è¯·å‚è€ƒå„ IDE æ–‡æ¡£ã€‚

### Codex

```json
{
  "mcpServers": {
    "engram-server": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/engram-mcp-server",
        "engram-server",
        "--packs-dir", "~/.engram"
      ]
    }
  }
}
```

## å¯ç”¨è‡ªåŠ¨åŠ è½½

### æ–¹å¼ Aï¼šæ‰‹åŠ¨æ·»åŠ  System Promptï¼ˆæ¨èï¼‰

å°†ä»¥ä¸‹æç¤ºè¯æ·»åŠ åˆ°å¯¹åº” AI å·¥å…·çš„æŒ‡ä»¤æ–‡ä»¶å¼€å¤´ï¼š

| AI å·¥å…· | æŒ‡ä»¤æ–‡ä»¶ |
|---------|---------|
| Claude Code | é¡¹ç›®æ ¹ç›®å½•çš„ `CLAUDE.md` |
| Codex | é¡¹ç›®æ ¹ç›®å½•çš„ `AGENTS.md` |
| å…¶ä»– | å¯¹åº”å·¥å…·çš„ system prompt é…ç½® |

```text
ä½ æœ‰ä¸€ä¸ªä¸“å®¶è®°å¿†ç³»ç»Ÿå¯ç”¨ã€‚å¯¹è¯å¼€å§‹æ—¶å…ˆè°ƒç”¨ list_engrams() æŸ¥çœ‹å¯ç”¨ä¸“å®¶ã€‚
- å½“ç”¨æˆ·çš„é—®é¢˜åŒ¹é…æŸä¸ªä¸“å®¶æ—¶ï¼Œè°ƒç”¨ load_engram(name, query) è·å–ä¸“å®¶çŸ¥è¯†æ¥å›ç­”ã€‚
- å‘ç°è·¨ä¸“å®¶é€šç”¨çš„ç”¨æˆ·ä¿¡æ¯ï¼ˆå¹´é¾„ã€åŸå¸‚ã€èŒä¸šã€è¯­è¨€åå¥½ç­‰åŸºç¡€ä¿¡æ¯ï¼‰æ—¶ï¼Œè°ƒç”¨ capture_memory(..., is_global=True) å†™å…¥å…¨å±€è®°å¿†
- çŠ¶æ€æ€§è®°å¿†ï¼ˆ"ç”¨æˆ·æ­£åœ¨å¤‡è€ƒ"ã€"ç”¨æˆ·ç›®å‰å—ä¼¤"ç­‰æœ‰æ—¶æ•ˆçš„ä¿¡æ¯ï¼‰åŠ  expires å‚æ•°ï¼Œå¦‚ expires="2026-06-01"
- load_engram è¿”å›å†…å®¹ä¸­è‹¥å‡ºç°"é¦–æ¬¡å¼•å¯¼"åŒºå—ï¼Œåœ¨å¯¹è¯ä¸­è‡ªç„¶åœ°æ”¶é›†æ‰€åˆ—ä¿¡æ¯å¹¶ capture_memory
- å¯¹è¯ä¸­å‘ç°ç”¨æˆ·çš„é‡è¦åå¥½æˆ–å…³é”®ä¿¡æ¯æ—¶ï¼Œè°ƒç”¨ capture_memory(name, content, category, summary) è®°å½•ä¸‹æ¥ã€‚
- load_engram åè‹¥æŸä¸ªè®°å¿†åˆ†ç±»æ¡ç›®è¶…è¿‡ 30 æ¡ï¼Œä¸»åŠ¨è°ƒç”¨ consolidate_memory å‹ç¼©
- ç”¨æˆ·ä¹Ÿå¯ä»¥ç”¨ @ä¸“å®¶å ç›´æ¥æŒ‡å®šä½¿ç”¨å“ªä¸ªä¸“å®¶ã€‚
- å¦‚æœè°ƒç”¨äº† mcpï¼Œå›å¤çš„æ—¶å€™è¦å‘Šè¯‰æˆ‘è°ƒç”¨äº†ä»€ä¹ˆ mcp å’Œä»€ä¹ˆä¸“å®¶
```

### æ–¹å¼ Bï¼šMCP Prompt

æœåŠ¡æš´éœ² `engram-system-prompt`ï¼Œæ”¯æŒ MCP Prompt çš„å®¢æˆ·ç«¯å¯è‡ªåŠ¨æ³¨å…¥ã€‚

### æ–¹å¼ Cï¼šå·¥å…·æè¿°å¼•å¯¼ï¼ˆé›¶é…ç½®ï¼‰

`list_engrams` / `load_engram` / `read_engram_file` çš„å·¥å…·æè¿°å·²åŒ…å«è°ƒç”¨æµç¨‹å¼•å¯¼ï¼Œéƒ¨åˆ† AI å®¢æˆ·ç«¯æ— éœ€é¢å¤–é…ç½®å³å¯è‡ªåŠ¨è§¦å‘ã€‚

## è°ƒæ•´å‹ç¼©è§¦å‘é˜ˆå€¼

å½“ `_index.md` ä¸­çš„è®°å¿†æ¡ç›®æ€»æ•°è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œ`load_engram` ä¼šæç¤º AI è¿›è¡Œå‹ç¼©ã€‚é»˜è®¤é˜ˆå€¼æ˜¯ **30 æ¡**ï¼Œå¯åœ¨ä»¥ä¸‹ä½ç½®ä¿®æ”¹ï¼š

æ–‡ä»¶ï¼š`src/engram_server/loader.py`ï¼Œç¬¬ 112 è¡Œ

```python
if entry_count >= 30 else ""   # æŠŠ 30 æ”¹æˆä½ æƒ³è¦çš„æ•°å­—
```

å»ºè®®èŒƒå›´ï¼š
- `20`ï¼šå¯¹è¯é¢‘ç¹ï¼Œå¸Œæœ›è®°å¿†ä¿æŒç²¾ç®€
- `30`ï¼šé»˜è®¤ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼ˆçº¦ 10-15 æ¬¡å¯¹è¯è§¦å‘ä¸€æ¬¡æç¤ºï¼‰
- `50`ï¼šè½»åº¦ä½¿ç”¨ï¼Œä¸æƒ³é¢‘ç¹å‹ç¼©

> è¿™åªæ˜¯ä¸€ä¸ªæç¤ºï¼ŒAI ä¸ä¼šè‡ªåŠ¨å‹ç¼©ï¼Œéœ€è¦ä¸»åŠ¨è°ƒç”¨ `consolidate_memory`ã€‚

---

## æ›´æ–°é¡¹ç›®

é¡¹ç›®é€šè¿‡ `uv run --directory` è¿è¡Œï¼Œ**ä¸éœ€è¦é‡æ–°å®‰è£…**ï¼Œåªéœ€æ‹‰å–æœ€æ–°ä»£ç ï¼š

```bash
cd ~/engram-mcp-server   # æ›¿æ¢ä¸ºä½ çš„å®é™…å…‹éš†è·¯å¾„
git pull
```

æ‹‰å–å**é‡å¯ AI å®¢æˆ·ç«¯**ï¼ˆClaude Desktop / Claude Code ç­‰ï¼‰ï¼ŒMCP server ä¼šè‡ªåŠ¨åŠ è½½æ–°ç‰ˆæœ¬ã€‚

> ä½ çš„ Engram æ•°æ®å­˜æ”¾åœ¨ `~/.engram/` ç›®å½•ï¼Œä¸é¡¹ç›®ä»£ç å®Œå…¨åˆ†ç¦»ï¼Œæ›´æ–°ä»£ç ä¸ä¼šå½±å“å·²æœ‰æ•°æ®ã€‚

## æµ‹è¯•

```bash
pytest -q
```

## è·¯çº¿å›¾

### å·²å®Œæˆï¼ˆv0.1.0ï¼‰

- MCP server æ ¸å¿ƒåŠŸèƒ½ï¼šlist / load / read_file / install / init
- åˆ†å±‚æ‡’åŠ è½½æ¶æ„ï¼šå¸¸é©»å±‚ + ç´¢å¼•ï¼ˆå«å†…è”æ‘˜è¦ï¼‰+ æŒ‰éœ€å…¨æ–‡
- æ¡ˆä¾‹â†’çŸ¥è¯†å…³è”ï¼šuses frontmatter
- æ¨¡æ¿ç³»ç»Ÿï¼š`engram-server init` åˆ›å»ºæ ‡å‡†ç»“æ„
- æµ‹è¯•è¦†ç›–ï¼šloader / server / install
- 11 ä¸ªå®Œæ•´ç¤ºä¾‹ Engram

### å·²å®Œæˆï¼ˆv0.2.0ï¼‰

- åŠ¨æ€è®°å¿†ï¼š`capture_memory` å¯¹è¯ä¸­è‡ªåŠ¨æ•è·ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯
- å†™å…¥èƒ½åŠ›ï¼š`write_engram_file` æ”¯æŒä»å¯¹è¯è‡ªåŠ¨æ‰“åŒ… Engram
- `load_engram` è‡ªåŠ¨åŠ è½½ `memory/_index.md`ï¼Œæ— éœ€ç”¨æˆ·é‡å¤è¯´æ˜
- æ‰€æœ‰ç¤ºä¾‹ Engram æ–°å¢ memory/ æ ·æ¿

### å·²å®Œæˆï¼ˆv0.3.0ï¼‰

- `capture_memory` æ–°å¢ `memory_type`ï¼ˆpreference/fact/decision/history/generalï¼‰è¯­ä¹‰åˆ†ç±»
- `capture_memory` æ–°å¢ `tags` å‚æ•°ï¼Œæ”¯æŒå¤šæ ‡ç­¾è¿‡æ»¤
- `capture_memory` æ–°å¢ `conversation_id` å‚æ•°ï¼Œæ”¯æŒå¯¹è¯ä½œç”¨åŸŸç»‘å®š
- èŠ‚æµä¿æŠ¤ï¼š30 ç§’å†…ç›¸åŒå†…å®¹é‡å¤æ•è·è‡ªåŠ¨è·³è¿‡
- `load_engram` åŠ¨æ€è®°å¿†åŒºå—ç”¨ `<memory>` æ ‡ç­¾åŒ…è£¹ï¼ŒAI å¯æ¸…æ™°åŒºåˆ†è®°å¿†ä¸çŸ¥è¯†
- è®°å¿†ç´¢å¼•æ ¼å¼å‡çº§ï¼šå«ç±»å‹æ ‡æ³¨å’Œæ ‡ç­¾ä¿¡æ¯

### å·²å®Œæˆï¼ˆv0.4.0ï¼‰

- `consolidate_memory` å·¥å…·ï¼šå°†åŸå§‹æ¡ç›®å‹ç¼©ä¸ºå¯†é›†æ‘˜è¦ï¼ŒåŸå§‹æ¡ç›®å½’æ¡£è‡³ `{category}-archive.md`
- `_index.md` å‹ç¼©ååªä¿ç•™ä¸€æ¡ `[consolidated]` æ¡ç›®ï¼Œcontext æ³¨å…¥é‡æ°¸è¿œå¯æ§
- `load_engram` å½“è®°å¿†æ¡ç›® â‰¥ 10 æ¡æ—¶è‡ªåŠ¨æç¤ºå‹ç¼©
- æŒ‰è®°å¿†ç±»å‹åˆ†å±‚å‹ç¼©ç­–ç•¥ï¼ˆfact æ°¸ä¹…ä¿ç•™ / preference åˆå¹¶ / history å®šæœŸå½’æ¡£ï¼‰
- ç¤ºä¾‹ Engram æ–°å¢ `preferences-archive.md` å±•ç¤ºå½’æ¡£æ ¼å¼

### å·²å®Œæˆï¼ˆv0.5.0ï¼‰

- `delete_memory` å·¥å…·ï¼šæŒ‰æ‘˜è¦ç²¾ç¡®åˆ é™¤ä¸€æ¡è®°å¿†ï¼ŒåŒæ—¶ä»ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ä¸­ç§»é™¤
- `correct_memory` å·¥å…·ï¼šä¿®æ­£å·²æœ‰è®°å¿†å†…å®¹ï¼Œæ›´æ–°ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ï¼Œæ”¯æŒé‡æ–°æŒ‡å®šç±»å‹å’Œæ ‡ç­¾
- `add_knowledge` å·¥å…·ï¼šå¯¹è¯ä¸­åŠ¨æ€å‘ Engram æ·»åŠ æ–°çŸ¥è¯†æ–‡ä»¶ï¼Œè‡ªåŠ¨æ›´æ–°çŸ¥è¯†ç´¢å¼•

### è®¡åˆ’ä¸­

- `engram-server lint`ï¼šæ ¡éªŒ uses è·¯å¾„æœ‰æ•ˆæ€§ã€ç´¢å¼•ä¸€è‡´æ€§
- ç« èŠ‚åŒ–çŸ¥è¯†ç›®å½•ï¼šå¤§æ–‡æ¡£è‡ªåŠ¨åˆ‡åˆ†ä¸ºå­ç›®å½• + ç« èŠ‚ç´¢å¼•
- Engram ç¤¾åŒº registry

## è®¸å¯è¯

MIT
