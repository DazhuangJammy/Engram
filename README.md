# Engram MCP Server

ä¸­æ–‡ | [English](./README_en.md)

> Engramï¼ˆè®°å¿†å°è¿¹ï¼‰â€”â€”ç¥ç»ç§‘å­¦ä¸­ï¼Œå¤§è„‘å­˜å‚¨ç‰¹å®šè®°å¿†çš„ç¥ç»å…ƒé›†åˆã€‚

## æˆ‘çš„æƒ³æ³•ğŸ’¡

å°†äººæˆ–æ™ºèƒ½ä½“çš„"è®°å¿†"ä½œä¸ºä¸€ç§å¯å…±äº«ã€å¯åŠ è½½çš„èµ„æºï¼Œåœ¨ä¸åŒæ™ºèƒ½ä½“ä¹‹é—´æµé€šï¼Œæœ€ç»ˆå®ç°èƒ½åŠ›çš„å åŠ ä¸èåˆã€‚

è¿™é‡Œçš„"è®°å¿†"ä¸æ˜¯ç®€å•çš„æ•°æ®äº¤æ¢ï¼Œè€Œæ˜¯ä¸€å¥—å®Œæ•´çš„ã€æœ‰å› æœé“¾çš„ç»éªŒä½“ç³»ï¼š

- ä¸€ä¸ªäººçš„æ€§æ ¼ç‰¹è´¨ä¸æ€ç»´æ–¹å¼
- æˆé•¿ç»å†ä¸äººç”Ÿè½¨è¿¹
- é©±åŠ¨ä»–é€‰æ‹©æŸä¸ªä¸“ä¸šã€æˆä¸ºæŸä¸ªé¢†åŸŸä¸“å®¶çš„åŠ¨å› 
- åœ¨è¯¥é¢†åŸŸç§¯ç´¯çš„ä¸“ä¸šçŸ¥è¯†ä¸åˆ¤æ–­åŠ›

å°†è¿™å¥—è®°å¿†å°è£…åå…±äº«å‡ºæ¥ï¼Œå…¶ä»–äººçš„æ™ºèƒ½ä½“å¯ä»¥åŠ è½½å®ƒã€‚å½“å¤§é‡ä¸åŒèƒŒæ™¯ã€ä¸åŒä¸“é•¿çš„è®°å¿†è¢«æ±‡èšå¹¶åŠ è½½åˆ°åŒä¸€ä¸ªæ™ºèƒ½ä½“ä¸Šæ—¶ï¼Œè¿™ä¸ªæ™ºèƒ½ä½“å°±å…·å¤‡äº†è·¨é¢†åŸŸçš„è®¤çŸ¥æ·±åº¦ï¼Œæˆä¸ºä¸€ä¸ª"è¶…çº§æ™ºèƒ½ä½“"ã€‚

**ç®€å•è¯´ï¼šæ¯ä¸ªäººè´¡çŒ®è‡ªå·±çš„"äººç”Ÿå­˜æ¡£"ï¼Œæ™ºèƒ½ä½“åŠ è½½å¾—è¶Šå¤šï¼Œå°±è¶Šå¼ºã€‚**

---

ç»™ AI æ³¨å…¥å¯åˆ‡æ¢çš„ä¸“å®¶è®°å¿†â€”â€”ä¸åªæ˜¯çŸ¥è¯†æ£€ç´¢ï¼Œè€Œæ˜¯**"è° + çŸ¥é“ä»€ä¹ˆ + æ€ä¹ˆæ€è€ƒ"**çš„å®Œæ•´äººè®¾ã€‚ä¸€å¥— Markdown æ–‡ä»¶å°±èƒ½è®©ä»»ä½• AI è·å¾—ä¸“å®¶çº§è®°å¿†ï¼Œé›¶å‘é‡ä¾èµ–ï¼Œå³æ’å³ç”¨ã€‚

ä½ è¿˜èƒ½æŠŠè¿™äº›è®°å¿†åŠ è½½åˆ° N ä¸ª subagent é‡Œé¢è®©å¤šä¸ªæ™ºèƒ½ä½“å¹²æ´»

```
Engram      = ä¸“å®¶æ˜¯è° + çŸ¥é“ä»€ä¹ˆ + æ€ä¹ˆæ€è€ƒ
Skills/Tools = å…·ä½“èƒ½åšä»€ä¹ˆæ“ä½œ
```

RAG èƒ½æ£€ç´¢çŸ¥è¯†ï¼Œä½†æ²¡æœ‰äººè®¾ã€æ²¡æœ‰å†³ç­–æµç¨‹â€”â€”Engram è§£å†³è¿™ä¸ªé—®é¢˜ã€‚äººå·¥ç­–å±• + æ¨¡å‹è‡ªä¸»æ£€ç´¢ï¼Œåœ¨å°è§„æ¨¡é«˜è´¨é‡çŸ¥è¯†åœºæ™¯ä¸‹æ¯” RAG æ›´ç²¾å‡†â€”â€”ä¸æ˜¯å› ä¸ºæŠ€æœ¯æ›´å¼ºï¼Œè€Œæ˜¯å› ä¸ºäººå·¥ç­–å±•çš„è´¨é‡å¤©ç„¶é«˜äºè‡ªåŠ¨åˆ‡åˆ†ã€‚æŠŠ memory åˆ†äº«ç»™åˆ«äººï¼Œå¯¹æ–¹çš„ AI ç«‹åˆ»æˆä¸ºåŒä¸€ä¸ªä¸“å®¶ã€‚æœªæ¥å¤§å®¶å…±äº«çš„ä¸æ˜¯ Skillsï¼Œè€Œæ˜¯ Memoryã€‚

æ”¯æŒæ‰€æœ‰ MCP å…¼å®¹å®¢æˆ·ç«¯ï¼šClaude Desktop / Claude Codeã€Cursorã€Windsurfã€Codex ç­‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

- é›¶å‘é‡ä¾èµ–ï¼šä¸ä½¿ç”¨ chromadb / litellmï¼Œåªä¾èµ– `mcp`
- MCP å·¥å…·ï¼š`ping`ã€`list_engrams`ã€`get_engram_info`ã€`load_engram`ã€`read_engram_file`ã€`write_engram_file`ã€`capture_memory`ã€`capture_tool_trace`ã€`list_tool_traces`ã€`consolidate_memory`ã€`delete_memory`ã€`correct_memory`ã€`add_knowledge`ã€`install_engram`ã€`init_engram`ã€`lint_engrams`ã€`search_engrams`ã€`stats_engrams`ã€`create_engram_assistant`ã€`finalize_engram_draft`ã€`open_ui`
- å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼šå†…ç½® Web UIï¼Œæµè§ˆå™¨ä¸­æµè§ˆ/ç¼–è¾‘ Engramï¼Œæ”¯æŒå¯¹è¯è§¦å‘æˆ–ç‹¬ç«‹è¿è¡Œ
- ç´¢å¼•é©±åŠ¨åŠ è½½ï¼š
  - `load_engram` è¿”å›è§’è‰²/å·¥ä½œæµç¨‹/è§„åˆ™ + çŸ¥è¯†ç´¢å¼•ï¼ˆå«å†…è”æ‘˜è¦ï¼‰+ æ¡ˆä¾‹ç´¢å¼•ï¼ˆå« usesï¼‰+ åŠ¨æ€è®°å¿†ç´¢å¼• + å…¨å±€ç”¨æˆ·è®°å¿†
  - `read_engram_file` æŒ‰è·¯å¾„æŒ‰éœ€è¯»å–çŸ¥è¯†æˆ–æ¡ˆä¾‹å…¨æ–‡
- åŠ¨æ€è®°å¿†ï¼šå¯¹è¯ä¸­è‡ªåŠ¨æ•è·ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯ï¼Œä¸‹æ¬¡åŠ è½½æ—¶è‡ªåŠ¨å¸¦å…¥
- å·¥å…·è½¨è¿¹è®°å¿†ï¼š`name` ç›¸å…³ MCP å·¥å…·è°ƒç”¨ä¼šè‡ªåŠ¨å†™å…¥ `memory/tool-trace.md`ï¼Œå¤–éƒ¨å·¥å…·å¯ç”¨ `capture_tool_trace` è¡¥å……
- å…¨å±€ç”¨æˆ·è®°å¿†ï¼šè·¨ä¸“å®¶å…±äº«çš„ç”¨æˆ·åŸºç¡€ä¿¡æ¯ï¼ˆå¹´é¾„ã€åŸå¸‚ç­‰ï¼‰ï¼Œæ‰€æœ‰ Engram åŠ è½½æ—¶è‡ªåŠ¨é™„åŠ 
- è®°å¿† TTLï¼šæ”¯æŒ `expires` å­—æ®µï¼Œåˆ°æœŸè®°å¿†è‡ªåŠ¨å½’æ¡£åˆ° `{category}-expired.md` å¹¶éšè—
- Index åˆ†å±‚ï¼š`_index.md` åªä¿ç•™æœ€è¿‘50æ¡ï¼ˆçƒ­å±‚ï¼‰ï¼Œå®Œæ•´è®°å½•å†™å…¥ `_index_full.md`ï¼ˆå†·å±‚ï¼‰
- Engram ç»§æ‰¿ï¼š`meta.json` æ”¯æŒ `extends` å­—æ®µï¼Œè‡ªåŠ¨åˆå¹¶çˆ¶ Engram çš„ knowledge index
- å†·å¯åŠ¨å¼•å¯¼ï¼š`rules.md` æ”¯æŒ `## Onboarding` åŒºå—ï¼Œé¦–æ¬¡ä½¿ç”¨æ—¶è‡ªåŠ¨è§¦å‘ä¿¡æ¯æ”¶é›†
- CLI å‘½ä»¤ï¼š`serve` / `list` / `search` / `install` / `init` / `lint` / `stats`
- ç»Ÿè®¡é¢æ¿ï¼š`engram-server stats` æ”¯æŒçº¯æ–‡æœ¬ / `--json` / `--csv` / `--tui`
- è¯„æµ‹æ¨¡æ¿ï¼š`evaluation/` æä¾›å¯å¤ç°å®éªŒï¼ˆåŒæ¨¡å‹ baseline vs Engramï¼‰ä¸è‡ªåŠ¨è¯„åˆ†è„šæœ¬ï¼ˆcontent/safety/structure + checkpointsï¼‰

## è®¾è®¡ç†å¿µï¼šç´¢å¼•é©±åŠ¨çš„åˆ†å±‚æ‡’åŠ è½½

### ä¸ºä»€ä¹ˆä¸ç”¨ RAG

çº¯ RAGï¼ˆå‘é‡æœç´¢å– top-k ç‰‡æ®µï¼‰çš„é—®é¢˜ï¼š
- è¯­ä¹‰ç›¸è¿‘ â‰  é€»è¾‘å®Œæ•´ï¼Œå®¹æ˜“ä¸¢å¤±ä¸Šä¸‹æ–‡å…³è”
- ç¢ç‰‡åŒ–æ£€ç´¢ä¼šä¸¢ç»†èŠ‚
- äººè®¾å’Œå†³ç­–æµç¨‹å¯èƒ½è¢«æ¼æ‰
- éœ€è¦é¢å¤–ä¾èµ–ï¼ˆå‘é‡æ•°æ®åº“ã€embedding æ¨¡å‹ï¼‰ï¼Œå¢åŠ éƒ¨ç½²å¤æ‚åº¦

### å½“å‰æ–¹æ¡ˆ

Engram è¢«åŠ è½½åï¼Œå†…å®¹ä¸æ˜¯å…¨é‡å¡å…¥ï¼Œè€Œæ˜¯åˆ†å±‚æŒ‰éœ€åŠ è½½ï¼š

```
ç¬¬ä¸€å±‚ï¼šå¸¸é©»åŠ è½½ï¼ˆload_engram æ—¶ä¸€æ¬¡æ€§è¿”å›ï¼‰
  â”œâ”€â”€ role.md              å…¨æ–‡  â† è§’è‰²äººè®¾ï¼ˆèƒŒæ™¯ + æ²Ÿé€šé£æ ¼ + å›ç­”åŸåˆ™ï¼‰
  â”œâ”€â”€ workflow.md          å…¨æ–‡  â† å·¥ä½œæµç¨‹ï¼ˆå†³ç­–æ­¥éª¤ï¼‰
  â”œâ”€â”€ rules.md             å…¨æ–‡  â† è¿ä½œè§„åˆ™ + å¸¸è§é”™è¯¯ + Onboarding åŒºå—
  â”œâ”€â”€ knowledge/_index.md  â† çŸ¥è¯†ç´¢å¼•ï¼ˆæ–‡ä»¶åˆ—è¡¨ + ä¸€å¥è¯æè¿° + å†…è”æ‘˜è¦ï¼Œè‹¥ extends ä¼šé™„åŠ çˆ¶çŸ¥è¯†ç´¢å¼•ï¼‰
  â”œâ”€â”€ examples/_index.md   â† æ¡ˆä¾‹ç´¢å¼•ï¼ˆæ–‡ä»¶åˆ—è¡¨ + ä¸€å¥è¯æè¿° + uses å…³è”ï¼‰
  â”œâ”€â”€ memory/_index.md     â† åŠ¨æ€è®°å¿†çƒ­å±‚ç´¢å¼•ï¼ˆæœ€è¿‘50æ¡ï¼ŒTTLè¿‡æ»¤ï¼‰
  â””â”€â”€ <packs-dir>/_global/memory/_index.md  â† å…¨å±€ç”¨æˆ·è®°å¿†ï¼ˆè·¨ä¸“å®¶å…±äº«ï¼‰

ç¬¬äºŒå±‚ï¼šæŒ‰éœ€åŠ è½½ï¼ˆLLM æ ¹æ®ç´¢å¼•æ‘˜è¦åˆ¤æ–­åä¸»åŠ¨è°ƒç”¨ï¼‰
  â””â”€â”€ read_engram_file(name, path)  â† è¯»å–ä»»æ„çŸ¥è¯†ã€æ¡ˆä¾‹æˆ–è®°å¿†æ–‡ä»¶ï¼ˆå« memory/_index_full.mdï¼‰

ç¬¬ä¸‰å±‚ï¼šå¯¹è¯ä¸­å†™å…¥ï¼ˆLLM è¯†åˆ«åˆ°é‡è¦ä¿¡æ¯æ—¶ä¸»åŠ¨è°ƒç”¨ï¼‰
  â””â”€â”€ capture_memory(name, content, category, summary, memory_type, tags, conversation_id, expires, is_global)  â† æ•è·ç”¨æˆ·åå¥½ã€å…³é”®å†³å®šç­‰
```

éª¨æ¶å¸¸é©»ä¸ä¸¢ï¼ŒçŸ¥è¯†é€šè¿‡"ç´¢å¼•å†…è”æ‘˜è¦ + å…¨æ–‡æŒ‰éœ€"æ§åˆ¶ token æ¶ˆè€—ã€‚ä¸ç®¡ Engram æœ‰å¤šå¤§ï¼Œæ¯æ¬¡æ³¨å…¥çš„å†…å®¹éƒ½æ˜¯å¯æ§çš„ã€‚

## åˆ†ç»„ç´¢å¼•ï¼ˆNested Indexï¼‰

å½“çŸ¥è¯†æ–‡ä»¶å˜å¤šæ—¶ï¼Œå»ºè®®ä½¿ç”¨äºŒçº§ç›®å½•åˆ†ç»„ï¼š

```text
knowledge/
  _index.md
  è®­ç»ƒåŸºç¡€/
    _index.md
    æ·±è¹²æ¨¡å¼.md
  è¥å…»ç­–ç•¥/
    _index.md
    å¢è‚ŒæœŸé…é¤.md
```

é¡¶å±‚ `_index.md` å¯å†™ `â†’ è¯¦è§ knowledge/è®­ç»ƒåŸºç¡€/_index.md` ä½œä¸ºåˆ†ç»„å…¥å£ï¼›`add_knowledge` æ”¯æŒ `"å­ç›®å½•/æ–‡ä»¶å"` å†™æ³•ï¼Œå¹¶åœ¨å­ç›®å½•å­˜åœ¨ `_index.md` æ—¶ä¼˜å…ˆè¿½åŠ åˆ°å­ç´¢å¼•ã€‚

LLM ä¸‰æ­¥å·¥ä½œæµï¼š
1. `load_engram` å…ˆè¯»å–é¡¶å±‚ `knowledge/_index.md`
2. çœ‹åˆ°åˆ†ç»„å…¥å£åï¼Œè°ƒç”¨ `read_engram_file(name, "knowledge/xxx/_index.md")`
3. å†æŒ‰éœ€è¯»å–å…·ä½“çŸ¥è¯†æ–‡ä»¶ `knowledge/xxx/topic.md`

## å®‰è£…

### å‰ç½®æ¡ä»¶

éœ€è¦å…ˆå®‰è£… [uv](https://docs.astral.sh/uv/)ï¼ˆæå¿«çš„ Python åŒ…ç®¡ç†å™¨ï¼‰ï¼š

```bash
# macOS / Linux
brew install uv
# æˆ–
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

### ä¸€é”®å®‰è£…

åœ¨ç»ˆç«¯è¾“å…¥ä¸€æ¡å‘½ä»¤ï¼Œå³å¯å®Œæˆå®‰è£…å’Œ MCP é…ç½®ï¼š

```bash
claude mcp add --scope user engram-server -- uvx --from git+https://github.com/DazhuangJammy/Engram engram-server
```

è¿™æ¡å‘½ä»¤ä¼šï¼š
- å°† MCP é…ç½®å†™å…¥å…¨å±€ï¼ˆæ‰€æœ‰é¡¹ç›®éƒ½èƒ½ç”¨ï¼‰
- é¦–æ¬¡åœ¨æŸä¸ªé¡¹ç›®ä¸­è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨åˆ›å»º `./.claude/engram/`
- è‡ªåŠ¨æ”¾å…¥ä¸¤ä¸ªèµ·å§‹åŒ…ï¼š`starter-complete`ï¼ˆå®Œæ•´å¯åŠ è½½ï¼‰å’Œ `starter-template`ï¼ˆè¯´æ˜æ¨¡æ¿ï¼‰
- æ¯æ¬¡ Claude Code å¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨ä» GitHub æ‹‰å–æœ€æ–°ç‰ˆæœ¬è¿è¡Œ
- `~/.engram` ä»å¯ä½œä¸ºå…±äº«/å›é€€ç›®å½•ï¼ˆç”± `--packs-dir` æŒ‡å®šï¼‰

å®‰è£…å®Œæˆå**é‡å¯ Claude Code**ï¼Œå³å¯å¼€å§‹ä½¿ç”¨ã€‚

### ä¸€é”®å¸è½½

```bash
claude mcp remove --scope user engram-server
```

> å¸è½½åªç§»é™¤ MCP é…ç½®ï¼Œä¸ä¼šåˆ é™¤ä½ çš„ Engram æ•°æ®ï¼ˆåŒ…æ‹¬é¡¹ç›®å†… `./.claude/engram/` ä¸å¯é€‰çš„ `~/.engram/`ï¼‰ã€‚

## å¿«é€Ÿå¼€å§‹

### æ·»åŠ  System Promptï¼ˆæ¨èï¼‰

åœ¨é¡¹ç›®çš„ `CLAUDE.md`ï¼ˆClaude Codeï¼‰æˆ– `AGENTS.md`ï¼ˆCodexï¼‰æ–‡ä»¶å¼€å¤´åŠ å…¥ä»¥ä¸‹æç¤ºè¯ï¼Œè®© AI è‡ªåŠ¨å‘ç°å’Œä½¿ç”¨ Engramï¼š

```text
ä½ æœ‰ä¸€ä¸ªä¸“å®¶è®°å¿†ç³»ç»Ÿå¯ç”¨ã€‚å¯¹è¯å¼€å§‹æ—¶å…ˆè°ƒç”¨ engram-server è¿™ä¸ª MCP ä¸­çš„ list_engrams() æŸ¥çœ‹å¯ç”¨ä¸“å®¶ã€‚

# è‡ªåŠ¨æ‰§è¡Œè§„åˆ™ï¼ˆå‚»ç“œå¼ï¼‰
- é»˜è®¤åŸåˆ™ï¼šèƒ½ç”±æ¨¡å‹ç›´æ¥å®Œæˆçš„äº‹ï¼Œä¸è®©ç”¨æˆ·æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ï¼›ä¼˜å…ˆç›´æ¥è°ƒç”¨ MCP å·¥å…·ã€‚
- é™¤éç¯å¢ƒ/æƒé™é˜»å¡ï¼Œå¦åˆ™ä¸è¦è®©ç”¨æˆ·â€œè‡ªå·±å»ç»ˆç«¯è·‘å‘½ä»¤â€ã€‚
- å¦‚æœè°ƒç”¨äº† MCPï¼Œå›å¤æ—¶è¦å‘Šè¯‰ç”¨æˆ·è°ƒç”¨äº†ä»€ä¹ˆ MCP å’Œå“ªä¸ªä¸“å®¶ã€‚
- é¦–æ¬¡è¿›å…¥æ–°é¡¹ç›®æ—¶ï¼Œé»˜è®¤æ£€æŸ¥å¹¶ä½¿ç”¨ `./.claude/engram`ã€‚
- ç›®å½•ç­–ç•¥ç»Ÿä¸€ä¸ºâ€œé¡¹ç›®çº§ä¼˜å…ˆï¼Œ`~/.engram` ä¸ºå…±äº«/å›é€€ç›®å½•â€ã€‚

## è‡ªç„¶è¯­è¨€æ„å›¾ -> MCP è‡ªåŠ¨æ˜ å°„
- ç”¨æˆ·è¯´â€œæ‰¾/æŸ¥/æ¨èæŸç±» Engramâ€ -> è‡ªåŠ¨è°ƒç”¨ search_engrams(query)
- ç”¨æˆ·è¯´â€œå®‰è£…æŸä¸ª Engramâ€ -> è‡ªåŠ¨è°ƒç”¨ install_engram(source-or-name)
- å®‰è£…é»˜è®¤å†™å…¥å½“å‰é¡¹ç›® `./.claude/engram`ï¼Œä¸æ˜¯é»˜è®¤å…¨å±€ç›®å½•ã€‚
- ç”¨æˆ·è¯´â€œåˆå§‹åŒ–å½“å‰é¡¹ç›® engramâ€ -> ä¼˜å…ˆæ£€æŸ¥ `starter-complete` / `starter-template` æ˜¯å¦å­˜åœ¨ã€‚
- install_engram(name/source) å¤±è´¥æ—¶ï¼Œä¸ä¸­æ–­ç”¨æˆ·ï¼šè‡ªåŠ¨è°ƒç”¨ search_engrams(query) æ‰¾å€™é€‰åé‡è¯• install_engramã€‚
- ç”¨æˆ·è¯´â€œçœ‹ç»Ÿè®¡/å¯¼å‡ºæŠ¥è¡¨â€ -> è‡ªåŠ¨è°ƒç”¨ stats_engrams(format=plain/json/csv)
- ç”¨æˆ·è¯´â€œåˆ›å»º Engramâ€ -> è‡ªåŠ¨è¿›å…¥åˆ›å»ºåŠ©æ‰‹æµç¨‹ï¼ˆcreate_engram_assistant + finalize_engram_draftï¼‰
- å½“ç”¨æˆ·è¯´"æ‰“å¼€engramç®¡ç†ç•Œé¢"ï¼ŒAI è°ƒç”¨ open_ui()

## ä¸“å®¶åŠ è½½ä¸çŸ¥è¯†è¯»å–
- ç”¨æˆ·é—®é¢˜åŒ¹é…æŸä¸ªä¸“å®¶æ—¶ï¼Œè°ƒç”¨ load_engram(name, query)ã€‚
- load_engram åä¼˜å…ˆçœ‹çŸ¥è¯†ç´¢å¼•/æ¡ˆä¾‹ç´¢å¼•ï¼›ç´¢å¼•ä¸è¶³å† read_engram_file(name, "knowledge/xxx.md")ã€‚
- è‹¥ workflow æ˜ç¡®å†™äº† Skill è°ƒç”¨èŠ‚ç‚¹ï¼ŒæŒ‰èŠ‚ç‚¹æç¤ºä¸»åŠ¨è°ƒç”¨å¯¹åº” Skillsã€‚
- load_engram è¿”å›â€œç»§æ‰¿çŸ¥è¯†ç´¢å¼•â€åŒºå—æ—¶ï¼Œå¯ read_engram_file(çˆ¶ä¸“å®¶å, "knowledge/xxx.md") è¯»å–çˆ¶çŸ¥è¯†ã€‚
- åœ¨ load_engram åä¼˜å…ˆè¯»å–æ¡ˆä¾‹ frontmatter çš„ id/title/uses/tags/updated_atï¼Œå†å†³å®šè¦ä¸è¦è¯»å…·ä½“ knowledge æ–‡ä»¶ã€‚

## è®°å¿†å†™å…¥è§„åˆ™
- å‘ç°è·¨ä¸“å®¶é€šç”¨ä¿¡æ¯ï¼ˆå¹´é¾„ã€åŸå¸‚ã€èŒä¸šã€è¯­è¨€åå¥½ç­‰ï¼‰ -> capture_memory(..., is_global=True)
- çŠ¶æ€æ€§ä¿¡æ¯ï¼ˆå¦‚â€œç”¨æˆ·æ­£åœ¨å¤‡è€ƒâ€ï¼‰è¦åŠ  expiresï¼ˆYYYY-MM-DDï¼‰ï¼Œåˆ°æœŸè‡ªåŠ¨å½’æ¡£éšè—ã€‚
- load_engram å‡ºç°â€œé¦–æ¬¡å¼•å¯¼â€åŒºå—æ—¶ï¼Œè‡ªç„¶æ”¶é›†å¹¶ capture_memoryã€‚
- å‘ç°ç”¨æˆ·åå¥½/å…³é”®äº‹å®/å…³é”®å†³å®šæ—¶ï¼ŒåŠæ—¶ capture_memory(name, content, category, summary, memory_type, tags, conversation_id, expires, is_global)ã€‚
- åªè¦è°ƒç”¨äº†å·¥å…·ï¼ˆSkills / MCP / Subagent / å…¶ä»–å¤–éƒ¨å·¥å…·ï¼‰ï¼Œéƒ½è¦è®°å½•å·¥å…·è½¨è¿¹ï¼šcapture_tool_trace(name, tool_name, intent, result_summary, args_summary, status, summary, tags, conversation_id)ã€‚
- å·¥å…·è°ƒç”¨å¤±è´¥ä¹Ÿè¦è®°å½•ï¼Œstatus è®¾ä¸º `error`ï¼Œresult_summary å†™æ¸…å¤±è´¥åŸå› ã€‚
- engram-server å†…éƒ¨å¤šæ•° `name` ç›¸å…³å·¥å…·ä¼šè‡ªåŠ¨å†™å…¥ tool-traceï¼›ä½†å¤–éƒ¨å·¥å…·ä¸ä¼šè‡ªåŠ¨å†™ï¼Œå¿…é¡»æ˜¾å¼è°ƒç”¨ capture_tool_traceã€‚
- å»é‡è§„åˆ™ï¼šè‹¥æœ¬è½®å·²è®°å½•è¿‡â€œåŒä¸€ tool_name + åŒä¸€ intentâ€çš„è½¨è¿¹ï¼Œä¸é‡å¤å†™å…¥ã€‚
- å¤–éƒ¨å·¥å…·è®°å½•å­—æ®µä¼˜å…ˆçº§ï¼šè‡³å°‘å¡«å†™ `tool_name`ã€`intent`ã€`args_summary`ã€`result_summary`ã€`status`ã€‚
- èŒƒå›´è§„åˆ™ï¼šåªæœ‰å·² `load_engram(name, ...)` çš„ä¸“å®¶ï¼Œæ‰å†™å…¥è¯¥ `name` çš„å·¥å…·è½¨è¿¹ï¼Œé¿å…ä¸²ä¸“å®¶è®°å¿†ã€‚
- äº¤ä»˜å‰æ£€æŸ¥ï¼šè‹¥æœ¬è½®å‘ç”Ÿè¿‡å·¥å…·è°ƒç”¨ä½†æœªå†™ä»»ä½•è½¨è¿¹ï¼Œç»“æŸå‰è¡¥è®°è‡³å°‘ä¸€æ¡ `capture_tool_trace`ã€‚
- è®°å¿†æ¡ç›®è¾ƒå¤šå‡ºç°â€œğŸ’¡ å½“å‰å…± N æ¡è®°å¿†â€æ—¶ï¼Œå…ˆ read_engram_file(name, "memory/{category}.md")ï¼Œå† consolidate_memory(...)ã€‚
- ç”¨æˆ·è¦æ±‚åˆ é™¤è®°å¿† -> delete_memory(name, category, summary)
- ç”¨æˆ·çº æ­£è®°å¿† -> correct_memory(name, category, old_summary, new_content, new_summary, memory_type, tags)
- è®°å¿†è¾ƒå¤šæŸ¥å†å² -> read_engram_file(name, "memory/_index_full.md")

## çŸ¥è¯†å†™å…¥è§„åˆ™
- å¯¹è¯ä¸­å½¢æˆç³»ç»Ÿæ€§å¯å¤ç”¨çŸ¥è¯†ï¼ˆæ–¹æ³•è®º/å¯¹æ¯”åˆ†æ/å†³ç­–æ¡†æ¶ï¼‰æ—¶ï¼Œå…ˆè¯¢é—®ç”¨æˆ·æ˜¯å¦å†™å…¥çŸ¥è¯†åº“ï¼Œç¡®è®¤å add_knowledgeã€‚
- ç”¨æˆ·çº æ­£çŸ¥è¯†åº“é”™è¯¯æ—¶ï¼Œæè®®å¹¶æ‰§è¡Œ add_knowledge æ›´æ–°ã€‚
- add_knowledge æ”¯æŒåˆ†ç»„è·¯å¾„ï¼šfilename å¯ç”¨ "å­ç›®å½•/æ–‡ä»¶å"ï¼ˆå¦‚ "è®­ç»ƒåŸºç¡€/æ·±è¹²æ¨¡å¼"ï¼‰ã€‚

## åˆ›å»º Engram åŠ©æ‰‹ï¼ˆåŒæ¨¡å¼ï¼‰
- mode=from_conversationï¼šæŠŠå½“å‰å¯¹è¯è‡ªåŠ¨æ•´ç†æˆ Engram è‰ç¨¿ã€‚
- mode=guidedï¼šä¸€æ­¥æ­¥å¼•å¯¼ç”¨æˆ·å¡«å†™ï¼›ç”¨æˆ·è¯´â€œæ²¡æœ‰/ä½ æ¥â€æ—¶è‡ªåŠ¨è¡¥å…¨ã€‚
- ç»Ÿä¸€æµç¨‹ï¼š
  1) å…ˆè°ƒç”¨ create_engram_assistant(...) ç”Ÿæˆè‰ç¨¿å¹¶å›æ˜¾
  2) ç”¨æˆ·ç¡®è®¤åè°ƒç”¨ finalize_engram_draft(draft_json, confirm=True)
  3) finalize åå¿…é¡»çœ‹ lint ç»“æœï¼ˆerrors å¿…é¡»å…ˆä¿®å¤ï¼‰
- è‡ªåŠ¨ç”Ÿæˆå†…å®¹æ—¶å¿…é¡»æç¤ºï¼šå†…å®¹å¯èƒ½ä¸å®Œæ•´ï¼Œå»ºè®®ç”¨æˆ·è¡¥å……ã€‚
- åˆ›å»ºé˜¶æ®µä¸è‡ªåŠ¨ç”Ÿæˆç”¨æˆ·è®°å¿†æ¡ç›®ï¼›memory ä¿æŒç©ºæ¨¡æ¿ã€‚

### çŸ¥è¯†éªŒè¯è§„åˆ™ï¼ˆworkflow + knowledgeï¼‰
- ç›®æ ‡ï¼šåˆ›å»ºé˜¶æ®µå¯¹ workflow / knowledge ä¸­çš„äº‹å®æ€§å†…å®¹å…ˆè”ç½‘æ ¸éªŒï¼›æ— æ³•ç¡®è®¤çœŸä¼ªçš„å†…å®¹é»˜è®¤ä¸å†™å…¥æœ€ç»ˆçŸ¥è¯†ã€‚
- éªŒè¯çº§åˆ«ï¼ˆåˆ›å»ºæ—¶å¯é€‰ï¼‰ï¼š
  - å¿«é€Ÿï¼šä»…éªŒè¯å…³é”®äº‹å®ï¼Œå•æ¥æºä¼˜å…ˆã€‚
  - å¹³è¡¡ï¼ˆé»˜è®¤ï¼‰ï¼šå…³é”®äº‹å®åŒæ¥æºï¼Œéå…³é”®äº‹å®å•æ¥æºã€‚
  - ä¸¥æ ¼ï¼šäº‹å®æ€§å†…å®¹å…¨é‡éªŒè¯ï¼Œå…³é”®äº‹å®å¿…é¡»åŒæ¥æºã€‚
- ä¸¤ç§æ¨¡å¼å·®å¼‚ï¼š
  - from_conversationï¼šç”¨æˆ·åŸè¯å¯ä¿ç•™å¹¶æ ‡æ³¨â€œç”¨æˆ·é™ˆè¿°ï¼ˆæœªæ ¸éªŒï¼‰/ç”¨æˆ·ç»éªŒâ€ï¼›æ¨¡å‹äº§å‡ºä¸å¤–éƒ¨å¼•ç”¨æŒ‰é¢„ç­›ç»“æœé€‰æ‹©æ€§éªŒè¯ã€‚
  - guidedï¼šæ¨¡å‹ç”Ÿæˆçš„äº‹å®æ€§å†…å®¹é»˜è®¤å…¨é‡è¿›å…¥éªŒè¯é˜Ÿåˆ—ï¼ˆå¹»è§‰é£é™©æ›´é«˜ï¼‰ã€‚
- é˜¶æ®µä¸€ï¼ˆæå– + é¢„ç­›ï¼‰ï¼š
  - çŸ¥è¯†ç‚¹åˆ†ç±»ï¼šäº‹å®æ€§ / ç»éªŒæ€§ / è§‚ç‚¹æ€§ã€‚
  - from_conversation é¢å¤–åšæ¥æºå½’å±ï¼šç”¨æˆ·è¯´çš„ vs æ¨¡å‹è¯´çš„ã€‚
  - åŸºäºæ¨¡å‹è‡ªä¿¡åº¦é¢„åˆ¤ï¼šé«˜ç¡®ä¿¡åŸºç¡€äº‹å®å¯è·³è¿‡è”ç½‘ï¼Œå…¶ä»–è¿›å…¥éªŒè¯é˜Ÿåˆ—ã€‚
- é˜¶æ®µäºŒï¼ˆæ‰¹é‡éªŒè¯ï¼‰ï¼š
  - æŒ‰ä¸»é¢˜åˆ†ç»„æ‰¹é‡æœç´¢ï¼Œä¼˜å…ˆå¤ç”¨åŒè½®å·²éªŒè¯ç»“è®ºï¼Œé¿å…é€æ¡é‡å¤æŸ¥è¯¢ã€‚
  - å…³é”®çŸ¥è¯†ç‚¹åšäº¤å‰éªŒè¯ï¼ˆè‡³å°‘ä¸¤ä¸ªç‹¬ç«‹æ¥æºï¼‰ï¼Œéå…³é”®å¯å•æ¥æºä½è¯ã€‚
  - æ¥æºä¼˜å…ˆçº§ï¼šå®˜æ–¹æ–‡æ¡£ / æ ‡å‡† / è®ºæ–‡ / ä¸€æ‰‹æŠ€æœ¯æ–‡æ¡£ > å…¶ä»–ï¼›ç¤¾åŒºå†…å®¹åªèƒ½è¡¥å……ï¼Œä¸èƒ½å•ç‹¬ä½œä¸ºâ€œå·²éªŒè¯â€ä¾æ®ã€‚
- é˜¶æ®µä¸‰ï¼ˆè‰ç¨¿å›æ˜¾ + ä¸‰çº§æ ‡æ³¨ï¼‰ï¼š
  - âœ… å·²éªŒè¯ï¼šå†™å…¥å¹¶é™„æ¥æº URLï¼ˆè„šæ³¨æˆ–æ³¨é‡Šï¼‰ã€‚
  - âš ï¸ éƒ¨åˆ†ä½è¯ï¼šå¯å†™å…¥ä½†è¦æ ‡æ³¨â€œéƒ¨åˆ†ä½è¯â€ï¼Œç”±ç”¨æˆ·å†³å®šä¿ç•™æˆ–åˆ é™¤ã€‚
  - âŒ æ— æ³•éªŒè¯ï¼šé»˜è®¤ä¸å†™å…¥ï¼Œå•ç‹¬åˆ—å‡ºä¾›ç”¨æˆ·é€‰æ‹©æ˜¯å¦å¼ºåˆ¶åŠ å…¥ã€‚
  - ç»éªŒæ€§å†…å®¹æ ‡æ³¨â€œæœªéªŒè¯-ç»éªŒæ€§â€ï¼Œä¸è¿›è¡Œäº‹å®æ ¸éªŒä½†æ˜ç¡®å‘ŠçŸ¥è¾¹ç•Œã€‚
- å¼‚å¸¸ä¸é™çº§ï¼š
  - è”ç½‘å¤±è´¥/è¶…æ—¶æ—¶ï¼ŒæœªéªŒè¯äº‹å®åªå…è®¸ç•™åœ¨è‰ç¨¿â€œå¾…éªŒè¯â€åŒºï¼Œä¸å†™å…¥æœ€ç»ˆ knowledgeã€‚
  - guided æ¨¡å¼ä¸‹æ— æ³•éªŒè¯çš„æ¨¡å‹äº‹å®é»˜è®¤ä¸¢å¼ƒï¼›ä»…åœ¨ç”¨æˆ·æ˜ç¡®ç¡®è®¤æ—¶ä¾‹å¤–ä¿ç•™ã€‚
- finalize å‰æ£€æŸ¥ï¼š
  - è‰ç¨¿ä¸­æ¯æ¡çŸ¥è¯†åº”èƒ½çœ‹åˆ°éªŒè¯çŠ¶æ€ï¼ˆâœ…/âš ï¸/âŒï¼‰ä¸æ¥æº URL æˆ–æœªéªŒè¯åŸå› ã€‚
  - é»˜è®¤éµå¾ªâ€œä¸ç¡®å®šä¸å†™å…¥â€ï¼›è‹¥è¦ä¿ç•™æœªéªŒè¯å†…å®¹ï¼Œå¿…é¡»å…ˆè·å¾—ç”¨æˆ·æ˜ç¡®ç¡®è®¤ã€‚
- å¢é‡è¡¥æŸ¥ï¼š
  - åç»­ä½¿ç”¨ä¸­è‹¥å¼•ç”¨åˆ°æœªéªŒè¯çŸ¥è¯†ï¼Œåº”è¡¥åšä¸€æ¬¡è”ç½‘æ ¸éªŒï¼Œå¹¶åœ¨ä¸‹æ¬¡æ›´æ–°è‰ç¨¿/çŸ¥è¯†æ—¶è¡¥é½çŠ¶æ€ä¸æ¥æºã€‚

## ä¸€è‡´æ€§æ ¡éªŒ
- åªè¦æ¨¡å‹æ–°å¢/ä¿®æ”¹äº† knowledge/examples/index/meta/rulesï¼Œå®Œæˆåè‡ªåŠ¨è°ƒç”¨ lint_engrams(name)ã€‚
- è§£é‡Šè§„åˆ™ï¼š
  - error > 0ï¼šé˜»æ–­ï¼Œå…ˆä¿®å¤å†äº¤ä»˜ã€‚
  - ä»… warningï¼šå¯äº¤ä»˜ï¼Œä½†éœ€å‘ç”¨æˆ·è¯´æ˜é£é™©ã€‚

## å…¶ä»–
- ç”¨æˆ·ä¹Ÿå¯ä»¥ç”¨ @ä¸“å®¶å ç›´æ¥æŒ‡å®šä¸“å®¶ã€‚
- ç”¨æˆ·è¯¢é—®æŸä¸ª engram è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè°ƒç”¨ get_engram_info(name)ã€‚
- éœ€è¦ç›´æ¥æ”¹ role.md/workflow.md/rules.md ç­‰éçŸ¥è¯†åº“æ–‡ä»¶æ—¶ï¼Œè°ƒç”¨ write_engram_file(name, path, content, mode)ã€‚
- æ–°å¢/ä¿®æ”¹æ¡ˆä¾‹æ–‡ä»¶æ—¶ï¼Œç¡®ä¿ frontmatter å­—æ®µé½å…¨ï¼ˆid/title/uses/tags/updated_atï¼‰ï¼Œid å…¨å±€å”¯ä¸€ï¼Œupdated_at ç”¨å½“å¤©æ—¥æœŸã€‚
- å¤šæ¡ˆä¾‹å‘½ä¸­æ—¶ï¼Œå…ˆæŒ‰ tags åŒ¹é…ï¼Œå†å‚è€ƒ updated_at é€‰æ›´è¿‘çš„æ¡ˆä¾‹ã€‚
- å›å¤ä¸­å¼•ç”¨æ¡ˆä¾‹æ—¶ä¼˜å…ˆå¸¦ title + idï¼Œå‡å°‘æ­§ä¹‰ã€‚
- è‹¥å‘ç° frontmatter ç¼ºå­—æ®µæˆ– uses æŒ‡å‘ä¸å­˜åœ¨æ–‡ä»¶ï¼Œå…ˆä¿®å¤å†ç»§ç»­å›ç­”ã€‚
```

### 4. é‡å¯ AI å®¢æˆ·ç«¯ï¼Œå¼€å§‹ä½¿ç”¨

é¦–æ¬¡åœ¨é¡¹ç›®é‡Œè§¦å‘ MCP åï¼Œä¼šè‡ªåŠ¨å¾—åˆ°ï¼š
- `./.claude/engram/starter-complete`ï¼ˆå®Œæ•´ç¤ºä¾‹ Engramï¼Œå¯ç›´æ¥åŠ è½½ï¼‰
- `./.claude/engram/starter-template`ï¼ˆè¯´æ˜/æ¨¡æ¿ Engramï¼Œç”¨äºæ”¹é€ ï¼‰
- ä¸¤ä¸ªèµ·å§‹åŒ…çš„ `workflow.md` éƒ½å·²å†…ç½®æé†’ï¼šå¯åœ¨å†³ç­–èŠ‚ç‚¹ä¸»åŠ¨è°ƒç”¨ MCP å·¥å…·æˆ– Skills

## å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼ˆWeb UIï¼‰

Engram æä¾›å†…ç½®çš„å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æµè§ˆã€ç¼–è¾‘å’Œç®¡ç†æ‰€æœ‰ Engram åŒ…ã€‚

### æ–¹å¼ä¸€ï¼šå¯¹è¯ä¸­æ‰“å¼€ï¼ˆæ¨èï¼‰

åœ¨ Claude Code å¯¹è¯ä¸­ç›´æ¥è¯´"æ‰“å¼€ç®¡ç†ç•Œé¢"ï¼ŒAI ä¼šè‡ªåŠ¨è°ƒç”¨ `open_ui` å·¥å…·ï¼Œæµè§ˆå™¨è‡ªåŠ¨å¼¹å‡ºã€‚

### æ–¹å¼äºŒï¼šç‹¬ç«‹è¿è¡Œï¼ˆä¸ä¾èµ– Claude Codeï¼‰

```bash
uvx --from git+https://github.com/DazhuangJammy/Engram engram-server ui
```

å¯é€‰å‚æ•°ï¼š

```bash
# æŒ‡å®šç«¯å£
engram-server ui --port 8080

# ä¸è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
engram-server ui --no-open

# æŒ‡å®š Engram ç›®å½•
engram-server ui --packs-dir ~/.engram
```

> ç‹¬ç«‹è¿è¡ŒåŒæ ·ä¸éœ€è¦å®‰è£…ä»»ä½•é¢å¤–ä¾èµ–ï¼Œ`uvx` ä¼šè‡ªåŠ¨å¤„ç†ã€‚

## CLI ç”¨æ³•

> è¯´æ˜ï¼šMCP è¿è¡Œæ—¶é»˜è®¤ä¼˜å…ˆä½¿ç”¨å½“å‰é¡¹ç›®çš„ `./.claude/engram/`ã€‚ä¸‹é¢ CLI ç¤ºä¾‹ä¸»è¦ç”¨äºæ‰‹åŠ¨ç®¡ç†æŒ‡å®šç›®å½•ï¼ˆå¦‚å…±äº«ç›®å½• `~/.engram`ï¼‰ã€‚

å¯åŠ¨ MCP stdio æœåŠ¡ï¼ˆé»˜è®¤å‘½ä»¤ï¼‰ï¼š

```bash
engram-server serve --packs-dir ~/.engram
```

ç­‰ä»·å†™æ³•ï¼š

```bash
engram-server --packs-dir ~/.engram
```

åˆ—å‡ºå·²å®‰è£… Engramï¼š

```bash
engram-server list --packs-dir ~/.engram
```

ä» git URL æˆ– registry åç§°å®‰è£… Engramï¼š

```bash
engram-server install <git-url|engram-name> --packs-dir ~/.engram
```

åˆå§‹åŒ–ä¸€ä¸ªæ–° Engram æ¨¡æ¿ï¼š

```bash
engram-server init my-expert --packs-dir ~/.engram
```

åˆå§‹åŒ–ä¸€ä¸ªå¸¦äºŒçº§çŸ¥è¯†ç´¢å¼•çš„æ¨¡æ¿ï¼š

```bash
engram-server init my-expert --nested --packs-dir ~/.engram
```

æœç´¢ registry ä¸­çš„ Engramï¼š

```bash
engram-server search fitness --packs-dir ~/.engram
```

è¿è¡Œæ•°æ®ä¸€è‡´æ€§æ ¡éªŒï¼š

```bash
engram-server lint [name] --packs-dir ~/.engram
```

æŸ¥çœ‹è®°å¿†ç»Ÿè®¡ï¼ˆçº¯æ–‡æœ¬ï¼‰ï¼š

```bash
uvx --from git+https://github.com/DazhuangJammy/Engram engram-server stats
```

æŸ¥çœ‹è®°å¿†ç»Ÿè®¡ï¼ˆJSONï¼‰ï¼š

```bash
uvx --from git+https://github.com/DazhuangJammy/Engram engram-server stats --json
```

æŸ¥çœ‹è®°å¿†ç»Ÿè®¡ï¼ˆCSVï¼‰ï¼š

```bash
uvx --from git+https://github.com/DazhuangJammy/Engram engram-server stats --csv
```

æŸ¥çœ‹è®°å¿†ç»Ÿè®¡ï¼ˆRich æ¸²æŸ“ç‰ˆï¼‰ï¼š

```bash
uvx --from git+https://github.com/DazhuangJammy/Engram engram-server stats --tui
```

> å¦‚æœä½ åœ¨ MCP é…ç½®é‡Œç”¨äº†è‡ªå®šä¹‰ `--packs-dir`ï¼Œè¿™é‡Œçš„æ‰€æœ‰å‘½ä»¤ä¹Ÿè¦ä¿æŒåŒä¸€ä¸ªç›®å½•ã€‚
>
> å°æŠ€å·§ï¼šå‘½ä»¤è¾ƒé•¿ï¼Œå¯ä»¥è®¾ä¸ª alias ç®€åŒ–æ—¥å¸¸ä½¿ç”¨ï¼š
> ```bash
> alias engram='uvx --from git+https://github.com/DazhuangJammy/Engram engram-server'
> # ä¹‹åç›´æ¥ç”¨ï¼šengram stats / engram stats --tui / engram list
> ```

### æ–°åŠŸèƒ½æ€ä¹ˆç”¨ï¼ˆv0.9.0 / v1.0.0 / v1.1.0 / v1.3.0ï¼‰

1) æ•°æ®æ ¡éªŒï¼ˆlintï¼‰

```bash
# æ ¡éªŒå…¨éƒ¨ Engram
engram-server lint --packs-dir ~/.engram

# ä»…æ ¡éªŒä¸€ä¸ª
engram-server lint fitness-coach --packs-dir ~/.engram
```

> é€€å‡ºç è§„åˆ™ï¼šæœ‰ error è¿”å› 1ï¼›åªæœ‰ warning è¿”å› 0ã€‚

2) ç»Ÿè®¡å¯¼å‡ºï¼ˆJSON / CSVï¼‰

```bash
engram-server stats --json --packs-dir ~/.engram
engram-server stats --csv --packs-dir ~/.engram
```

3) æœç´¢ä¸å®‰è£…ï¼ˆRegistryï¼‰

```bash
# å…ˆæœç´¢
engram-server search fitness --packs-dir ~/.engram

# å†æŒ‰åç§°å®‰è£…
engram-server install fitness-coach --packs-dir ~/.engram
```

æŒ‰åç§°å®‰è£…æ—¶ï¼Œå½“å‰ç‰ˆæœ¬ä¼šæŒ‰ä»¥ä¸‹é¡ºåºå°è¯•ï¼š
- å…ˆä»æœ¬é¡¹ç›® `examples/<name>` å®‰è£…ï¼ˆæ–¹æ¡ˆ 2ï¼‰
- è‹¥æœ¬åœ°æ— å¯¹åº”ç›®å½•ï¼Œå†æŒ‰ registry çš„ `source` å®‰è£…
- è‹¥ registry çš„ `source` clone å¤±è´¥ï¼Œä¼šè‡ªåŠ¨å›é€€åˆ°ä¸»ä»“åº“ `examples/<name>`

registry æ¡ç›®æ”¯æŒæœ¬åœ°è¦†ç›–ï¼ˆåè€…ä¼˜å…ˆï¼‰ï¼š
- å†…ç½®ï¼šä»“åº“æ ¹ç›®å½• `registry.json`
- è¿œç«¯ï¼šä¸»ä»“åº“åœ¨çº¿ `registry.json`
- ç”¨æˆ·çº§è¦†ç›–ï¼š`~/.engram/registry.local.json`
- é¡¹ç›®çº§è¦†ç›–ï¼š`./.claude/engram/registry.local.json`

### å¦‚ä½•å‘æœ¬é¡¹ç›®æäº¤ Engramï¼ˆPRï¼‰

1. Fork æœ¬ä»“åº“å¹¶æ–°å»ºåˆ†æ”¯ã€‚
2. å¤åˆ¶ `examples/template` ä¸º `examples/<your-engram-name>`ï¼Œè¡¥é½å†…å®¹ã€‚
3. ç¡®ä¿ `meta.json` ä¸ `examples/*.md` frontmatter ç¬¦åˆè§„èŒƒï¼ˆ`id/title/uses/tags/updated_at`ï¼‰ã€‚
4. åœ¨ `registry.json` å¢åŠ æ¡ç›®ï¼ˆ`name/description/author/source/tags/language/version`ï¼‰ï¼Œ`name` ä¸ç›®å½•åä¸€è‡´ã€‚
5. æäº¤ PRï¼Œè¯´æ˜ä½ çš„ Engram ç”¨é€”ã€é€‚ç”¨åœºæ™¯ã€ç¤ºä¾‹å¯¹è¯ã€‚

4) åˆå§‹åŒ–åˆ†ç»„ç´¢å¼•æ¨¡æ¿

```bash
engram-server init my-expert --nested --packs-dir ~/.engram
```

5) å¯¹è¯ä¸­å†™å…¥åˆ†ç»„çŸ¥è¯†ï¼ˆMCPï¼‰

å½“è°ƒç”¨ `add_knowledge(name, filename, content, summary)` æ—¶ï¼Œ`filename` å¯ç”¨å­ç›®å½•æ ¼å¼ï¼Œä¾‹å¦‚ï¼š

```text
filename = "è®­ç»ƒåŸºç¡€/æ·±è¹²æ¨¡å¼"
```

ç³»ç»Ÿä¼šå†™å…¥ `knowledge/è®­ç»ƒåŸºç¡€/æ·±è¹²æ¨¡å¼.md`ï¼›è‹¥ `knowledge/è®­ç»ƒåŸºç¡€/_index.md` å­˜åœ¨ï¼Œåˆ™ä¼˜å…ˆè¿½åŠ åˆ°å­ç´¢å¼•ã€‚

6) æ¡ˆä¾‹è¯„æµ‹ï¼ˆevaluationï¼‰

```bash
# å¤åˆ¶æ¨¡æ¿å¹¶å¡«å†™ baseline/engram å›ç­”
cp evaluation/case_study_template.json evaluation/my_case_study.json

# æ‰§è¡Œå¤šç»´è¯„æµ‹
python3 evaluation/score_case_study.py --input evaluation/my_case_study.json

# å¯é€‰å¯¼å‡º CSV
python3 evaluation/score_case_study.py --input evaluation/my_case_study.json --csv evaluation/my_case_study_report.csv
```

### å‚»ç“œå¼åˆ›å»º Engramï¼ˆåŒæ¨¡å¼ï¼‰

ç”¨æˆ·åªç”¨è‡ªç„¶è¯­è¨€è¯´â€œå¸®æˆ‘åˆ›å»ºä¸€ä¸ª Engramâ€ï¼Œæ¨¡å‹åº”è‡ªåŠ¨èµ°ä»¥ä¸‹æµç¨‹ï¼š

1) ç”Ÿæˆè‰ç¨¿  
- å¯¹è¯ç›´è½¬ï¼š`create_engram_assistant(mode=\"from_conversation\", ...)`
- å¼•å¯¼åˆ›å»ºï¼š`create_engram_assistant(mode=\"guided\", ...)`

2) å›æ˜¾å¹¶ç¡®è®¤  
- ç»™ç”¨æˆ·å±•ç¤ºè‰ç¨¿æ‘˜è¦ï¼ˆåç§°ã€çŸ¥è¯†ç›®å½•ã€æ¡ˆä¾‹ç›®å½•ã€è‡ªåŠ¨è¡¥å…¨å­—æ®µï¼‰
- æ˜ç¡®æç¤ºï¼šè‡ªåŠ¨ç”Ÿæˆå†…å®¹å¯èƒ½ä¸å®Œæ•´ï¼Œå»ºè®®è¡¥å……

3) ç¡®è®¤åè½ç›˜  
- `finalize_engram_draft(draft_json, confirm=True, nested=True)`
- å·¥å…·ä¼šè‡ªåŠ¨æ‰§è¡Œ lint å¹¶è¿”å› errors/warnings
- è‹¥æœ‰ errorï¼Œå…ˆä¿®å¤å†äº¤ä»˜

ç¤ºä¾‹è¯æœ¯ï¼š
- â€œæŠŠæˆ‘ä»¬åˆšæ‰çš„è®¨è®ºåšæˆä¸€ä¸ª Engramâ€ï¼ˆfrom_conversationï¼‰
- â€œå¸®æˆ‘åšä¸€ä¸ªé¢è¯•å®˜ Engramï¼Œä½ æ¥è¡¥å…¨ç»†èŠ‚â€ï¼ˆguided + auto-fillï¼‰

## MCP å·¥å…·åˆ—è¡¨

| å·¥å…· | å‚æ•° | è¯´æ˜ |
|------|------|------|
| `ping` | æ—  | è¿é€šæ€§æµ‹è¯•ï¼Œè¿”å› `pong` |
| `list_engrams` | æ—  | åˆ—å‡ºå¯ç”¨ Engramï¼ˆå«æè¿°ä¸æ–‡ä»¶ç»Ÿè®¡ï¼‰ |
| `get_engram_info` | `name` | è·å–å®Œæ•´ `meta.json` |
| `load_engram` | `name`, `query` | åŠ è½½è§’è‰²/å·¥ä½œæµç¨‹/è§„åˆ™å…¨æ–‡ + çŸ¥è¯†ç´¢å¼•ï¼ˆå«å†…è”æ‘˜è¦ï¼‰+ æ¡ˆä¾‹ç´¢å¼•ï¼ˆå« usesï¼‰+ åŠ¨æ€è®°å¿†ï¼ˆå«çƒ­å±‚ç´¢å¼•ï¼‰+ å¯é€‰å…¨å±€è®°å¿†/ç»§æ‰¿çŸ¥è¯†/é¦–æ¬¡å¼•å¯¼ |
| `read_engram_file` | `name`, `path` | æŒ‰éœ€è¯»å–å•ä¸ªæ–‡ä»¶ï¼ˆå«è·¯å¾„è¶Šç•Œä¿æŠ¤ï¼‰ |
| `write_engram_file` | `name`, `path`, `content`, `mode` | å†™å…¥æˆ–è¿½åŠ æ–‡ä»¶åˆ° Engram åŒ…ï¼ˆç”¨äºè‡ªåŠ¨æ‰“åŒ…ï¼‰ |
| `capture_memory` | `name`, `content`, `category`, `summary`, `memory_type`, `tags`, `conversation_id`, `expires`, `is_global` | å¯¹è¯ä¸­æ•è·ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯ï¼Œæ”¯æŒç±»å‹æ ‡æ³¨ã€æ ‡ç­¾ã€TTLè¿‡æœŸã€å…¨å±€å†™å…¥ |
| `capture_tool_trace` | `name`, `tool_name`, `intent`, `result_summary`, `args_summary`, `status`, `summary`, `tags`, `conversation_id` | ç»“æ„åŒ–è®°å½•å·¥å…·è°ƒç”¨è½¨è¿¹åˆ° `memory/tool-trace.md`ï¼Œç”¨äºåç»­ workflow æ¨è |
| `list_tool_traces` | `name`, `limit` | è¯»å–æœ€è¿‘å·¥å…·è°ƒç”¨è½¨è¿¹æ‘˜è¦ï¼ˆæ¥è‡ªè®°å¿†ç´¢å¼•ï¼‰ |
| `consolidate_memory` | `name`, `category`, `consolidated_content`, `summary` | å°†æŸä¸ª category çš„åŸå§‹æ¡ç›®å‹ç¼©ä¸ºå¯†é›†æ‘˜è¦ï¼ŒåŸå§‹æ¡ç›®å½’æ¡£è‡³ `{category}-archive.md` |
| `delete_memory` | `name`, `category`, `summary` | æŒ‰æ‘˜è¦ç²¾ç¡®åˆ é™¤ä¸€æ¡è®°å¿†ï¼ŒåŒæ—¶ä»ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ä¸­ç§»é™¤ |
| `correct_memory` | `name`, `category`, `old_summary`, `new_content`, `new_summary`, `memory_type`, `tags` | ä¿®æ­£ä¸€æ¡å·²æœ‰è®°å¿†çš„å†…å®¹ï¼Œæ›´æ–°ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ |
| `add_knowledge` | `name`, `filename`, `content`, `summary` | å‘ Engram æ·»åŠ æ–°çŸ¥è¯†æ–‡ä»¶å¹¶è‡ªåŠ¨æ›´æ–°çŸ¥è¯†ç´¢å¼• |
| `install_engram` | `source` | ä» git URL æˆ– registry åç§°å®‰è£… Engram åŒ… |
| `init_engram` | `name`, `nested` | é€šè¿‡ MCP åˆå§‹åŒ–æ–° Engramï¼ˆå¯é€‰äºŒçº§çŸ¥è¯†ç´¢å¼•æ¨¡æ¿ï¼‰ |
| `lint_engrams` | `name?` | é€šè¿‡ MCP æ‰§è¡Œä¸€è‡´æ€§æ ¡éªŒï¼Œè¿”å› errors/warnings æ˜ç»† |
| `search_engrams` | `query` | é€šè¿‡ MCP æœç´¢ registry æ¡ç›® |
| `stats_engrams` | `format` | é€šè¿‡ MCP è·å–ç»Ÿè®¡ï¼Œ`format` æ”¯æŒ `plain/json/csv` |
| `create_engram_assistant` | `mode`, `name?`, `topic?`, `audience?`, `style?`, `constraints?`, `language?`, `conversation?` | ç”Ÿæˆ Engram è‰ç¨¿ï¼ˆfrom_conversation / guidedï¼‰ï¼Œç¼ºå¤±å­—æ®µå¯è‡ªåŠ¨è¡¥å…¨å¹¶æ ‡æ³¨ |
| `finalize_engram_draft` | `draft_json`, `name?`, `nested`, `confirm` | ç”¨æˆ·ç¡®è®¤åè½ç›˜åˆ›å»º Engramï¼Œå¹¶è‡ªåŠ¨æ‰§è¡Œ lint æ ¡éªŒ |
| `open_ui` | `port?` | å¯åŠ¨å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼Œè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼ˆé»˜è®¤ç«¯å£ 9470ï¼‰ |

### `load_engram` è¿”å›å†…å®¹æ ¼å¼

```markdown
# å·²åŠ è½½ Engram: fitness-coach

## ç”¨æˆ·å…³æ³¨æ–¹å‘
{query}

## è§’è‰²
{role.md å…¨æ–‡}

## å·¥ä½œæµç¨‹
{workflow.md å…¨æ–‡}

## è§„åˆ™
{rules.md å…¨æ–‡}

## çŸ¥è¯†ç´¢å¼•
{knowledge/_index.md å†…å®¹ï¼Œå«å†…è”æ‘˜è¦}

## æ¡ˆä¾‹ç´¢å¼•
{examples/_index.md å†…å®¹ï¼Œå« uses å…³è”}

## åŠ¨æ€è®°å¿†
{memory/_index.md å†…å®¹ï¼Œå«è‡ªåŠ¨æ•è·çš„ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯ï¼Œç”¨ <memory> æ ‡ç­¾åŒ…è£¹}

## å…¨å±€ç”¨æˆ·è®°å¿†ï¼ˆå¯é€‰ï¼‰
{<packs-dir>/_global/memory/_index.md çš„æ´»è·ƒæ¡ç›®ï¼Œç”¨ <global_memory> æ ‡ç­¾åŒ…è£¹}

## é¦–æ¬¡å¼•å¯¼ï¼ˆå¯é€‰ï¼‰
{rules.md ä¸­çš„ ## Onboarding åŒºå—æå–å†…å®¹}
```

> è‹¥ `meta.json` é…ç½®äº† `extends`ï¼Œè¿”å›é‡Œè¿˜ä¼šå‡ºç°"ç»§æ‰¿çŸ¥è¯†ç´¢å¼•ï¼ˆæ¥è‡ªçˆ¶ Engramï¼‰"åŒºå—ï¼›å½“å‰ä»…æ”¯æŒå•å±‚ç»§æ‰¿ã€‚

### è®°å¿†ç±»å‹ï¼ˆmemory_typeï¼‰

`capture_memory` æ”¯æŒä¸ƒç§è¯­ä¹‰ç±»å‹ï¼š

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `preference` | ç”¨æˆ·åå¥½ | åå¥½æ™¨ç»ƒã€ä¸å–œæ¬¢è·‘æ­¥ |
| `fact` | å…³äºç”¨æˆ·çš„å®¢è§‚äº‹å® | å·¦è†æœ‰æ—§ä¼¤ã€èº«é«˜175cm |
| `decision` | å¯¹è¯ä¸­åšå‡ºçš„å…³é”®å†³å®š | å†³å®šä»3x/weekå¼€å§‹è®­ç»ƒ |
| `history` | å†å²å¯¹è¯çš„é‡è¦èŠ‚ç‚¹ | ç¬¬ä¸€è½®é¢è¯•é€šè¿‡ç®—æ³•é¢˜ |
| `stated` | ç”¨æˆ·æ˜ç¡®è¯´å‡ºçš„ä¿¡æ¯ï¼ˆé«˜ç½®ä¿¡åº¦ï¼‰| "æˆ‘è†ç›–æœ‰æ—§ä¼¤" |
| `inferred` | LLM ä»è¡Œä¸ºæ¨æ–­çš„ä¿¡æ¯ï¼ˆä½ç½®ä¿¡åº¦ï¼‰| è¿ç»­3æ¬¡é€‰æ—©æ™¨è®­ç»ƒâ†’æ¨æ–­åå¥½æ—©èµ· |
| `general` | é»˜è®¤ï¼Œæœªåˆ†ç±» | å…¶ä»–ä¿¡æ¯ |

`stated` vs `inferred` çš„åŒºåˆ«ï¼šå¼•ç”¨ `inferred` ç±»è®°å¿†æ—¶åº”åŠ "å¯èƒ½"ç­‰ä¸ç¡®å®šæ€§æªè¾ï¼›`correct_memory` å¯å°† `inferred` å‡çº§ä¸º `stated`ã€‚

`expires` å‚æ•°ä½¿ç”¨ `YYYY-MM-DD`ï¼ˆISO 8601 çš„æ—¥æœŸéƒ¨åˆ†ï¼Œå¦‚ `"2026-06-01"`ï¼‰ã€‚ç³»ç»ŸæŒ‰ UTC æ—¥æœŸåˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œåˆ°æœŸåè®°å¿†ä¼šè½¬å­˜åˆ° `memory/{category}-expired.md` å¹¶ä»åŠ è½½ç»“æœä¸­éšè—ã€‚é€‚åˆçŠ¶æ€æ€§è®°å¿†ï¼ˆ"ç”¨æˆ·æ­£åœ¨å¤‡è€ƒ"ï¼‰ã€‚

`is_global=True` å°†è®°å¿†å†™å…¥ `<packs-dir>/_global/memory/`ï¼Œæ‰€æœ‰ Engram åŠ è½½æ—¶éƒ½ä¼šè‡ªåŠ¨é™„åŠ è¿™éƒ¨åˆ†è®°å¿†ã€‚é€‚åˆè·¨ä¸“å®¶å…±äº«çš„ç”¨æˆ·åŸºç¡€ä¿¡æ¯ï¼ˆå¹´é¾„ã€åŸå¸‚ã€èŒä¸šç­‰ï¼‰ã€‚

### å…¨å±€ç”¨æˆ·è®°å¿†ï¼ˆGlobal Memoryï¼‰

**è§£å†³çš„é—®é¢˜ï¼š** ä½ å‘Šè¯‰å¥èº«æ•™ç»ƒ"æˆ‘28å²ã€ä½æ·±åœ³"ï¼Œä½†è¯­è¨€ä¼™ä¼´å®Œå…¨ä¸çŸ¥é“ã€‚å…¨å±€è®°å¿†è®©è¿™ç±»åŸºç¡€ä¿¡æ¯ä¸€æ¬¡å†™å…¥ã€æ‰€æœ‰ä¸“å®¶å…±äº«ã€‚

**å­˜å‚¨ä½ç½®ï¼š** `<packs-dir>/_global/memory/`ï¼Œç»“æ„ä¸æ™®é€š Engram çš„ memory ç›®å½•å®Œå…¨ç›¸åŒã€‚è‹¥ `--packs-dir` ä½¿ç”¨é»˜è®¤å€¼ `~/.engram`ï¼Œå®é™…è·¯å¾„å°±æ˜¯ `~/.engram/_global/memory/`ã€‚

**ä½¿ç”¨æ–¹å¼ï¼š**

```
ç”¨æˆ·ç¬¬ä¸€æ¬¡æåˆ°è‡ªå·±çš„åŸºæœ¬ä¿¡æ¯æ—¶ï¼š
  â†’ AI è°ƒç”¨ capture_memory(
        name="fitness-coach",   â† å½“å‰ä¸“å®¶åï¼ˆç”¨äºèŠ‚æµkeyï¼Œä¸å½±å“å†™å…¥ä½ç½®ï¼‰
        content="ç”¨æˆ·åå« Jammyï¼Œ28å²ï¼Œå±…ä½åœ¨æ·±åœ³ï¼ŒèŒä¸šæ˜¯ç‹¬ç«‹å¼€å‘è€…",
        category="user-profile",
        summary="Jammyï¼Œ28å²ï¼Œæ·±åœ³ï¼Œç‹¬ç«‹å¼€å‘è€…",
        memory_type="fact",
        is_global=True           â† å†™å…¥å…¨å±€ï¼Œè€Œéå½“å‰ Engram
    )
  â†’ ä¸‹æ¬¡åŠ è½½ä»»æ„ Engram æ—¶ï¼Œload_engram è¿”å›å†…å®¹æœ«å°¾è‡ªåŠ¨é™„åŠ ï¼š
    ## å…¨å±€ç”¨æˆ·è®°å¿†
    <global_memory>
    - `memory/user-profile.md` [2026-02-25] [fact] Jammyï¼Œ28å²ï¼Œæ·±åœ³ï¼Œç‹¬ç«‹å¼€å‘è€…
    </global_memory>
```

**é€‚åˆå†™å…¥å…¨å±€çš„ä¿¡æ¯ï¼š**
- å§“åã€å¹´é¾„ã€åŸå¸‚
- èŒä¸šå’Œå·¥ä½œèƒŒæ™¯
- è¯­è¨€åå¥½ï¼ˆä¸­æ–‡/è‹±æ–‡ï¼‰
- é•¿æœŸå¥åº·çŠ¶å†µï¼ˆå¦‚æ…¢æ€§ç—…ã€è¿‡æ•ï¼‰

**ä¸é€‚åˆå†™å…¥å…¨å±€çš„ä¿¡æ¯ï¼š**
- ç‰¹å®šä¸“å®¶é¢†åŸŸçš„åå¥½ï¼ˆè®­ç»ƒè®¡åˆ’åå¥½ â†’ å†™å¥èº«æ•™ç»ƒè‡ªå·±çš„ memoryï¼‰
- æœ‰æ—¶æ•ˆæ€§çš„çŠ¶æ€ï¼ˆæ­£åœ¨å¤‡è€ƒ â†’ ç”¨ expires å‚æ•°ï¼‰

**ç›®å½•ç»“æ„ç¤ºä¾‹ï¼ˆå‚è§ `examples/_global/`ï¼‰ï¼š**

```
<packs-dir>/_global/
â””â”€â”€ memory/
    â”œâ”€â”€ _index.md          â† çƒ­å±‚ç´¢å¼•ï¼ˆæœ€è¿‘50æ¡ï¼‰
    â”œâ”€â”€ _index_full.md     â† å†·å±‚ç´¢å¼•ï¼ˆå…¨é‡ï¼‰
    â””â”€â”€ user-profile.md    â† ç”¨æˆ·åŸºç¡€ä¿¡æ¯
```

### è®°å¿†å‹ç¼©ï¼ˆconsolidate_memoryï¼‰

éšç€å¯¹è¯ç§¯ç´¯ï¼ŒæŸä¸ª category çš„åŸå§‹æ¡ç›®ä¼šè¶Šæ¥è¶Šå¤šã€‚`consolidate_memory` è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

```
åŸå§‹æ¡ç›®ä¸æ–­è¿½åŠ ï¼ˆappend-onlyï¼‰
         â†“
æŸä¸ª category è¶…è¿‡ 30 æ¡æ—¶
         â†“
AI è°ƒç”¨ read_engram_file è¯»å–åŸå§‹å†…å®¹
         â†“
AI å†™å‡ºå»é‡å‹ç¼©çš„å¯†é›†æ‘˜è¦
         â†“
è°ƒç”¨ consolidate_memory â†’ åŸå§‹æ¡ç›®å½’æ¡£ï¼Œæ‘˜è¦æ›¿æ¢
```

**ä¸åŒç±»å‹çš„è®°å¿†ï¼Œå‹ç¼©ç­–ç•¥ä¸åŒï¼š**

| ç±»å‹ | ç‰¹å¾ | ç­–ç•¥ |
|------|------|------|
| `fact` | ç¨³å®šï¼Œå‡ ä¹ä¸å˜ | æ°¸ä¹…ä¿ç•™ï¼Œæ— éœ€å‹ç¼© |
| `preference` | åŠç¨³å®šï¼Œå¶å°”æ›´æ–° | åˆå¹¶å‹ç¼©ï¼Œå§‹ç»ˆåŠ è½½ |
| `decision` | æœ‰æ—¶æ•ˆæ€§ | ä¿ç•™è¿‘æœŸï¼Œå‹ç¼©æ—§çš„ |
| `history` | è¶Šæ–°è¶Šç›¸å…³ | å®šæœŸå‹ç¼©ï¼Œå½’æ¡£æ—§çš„ |

å‹ç¼©å `_index.md` åªä¿ç•™ä¸€æ¡ `[consolidated]` æ¡ç›®ï¼Œcontext æ³¨å…¥é‡æ°¸è¿œå¯æ§ã€‚
åŸå§‹æ¡ç›®å½’æ¡£è‡³ `memory/{category}-archive.md`ï¼Œä»å¯é€šè¿‡ `read_engram_file` æŸ¥é˜…ã€‚

### è®°å¿†åˆ é™¤ï¼ˆdelete_memoryï¼‰

å½“ç”¨æˆ·æ˜ç¡®è¯´æŸæ¡è®°å¿†æœ‰è¯¯æˆ–å·²è¿‡æ—¶æ—¶ä½¿ç”¨ã€‚AI å…ˆè¯»å–ç´¢å¼•æ‰¾åˆ°ç²¾ç¡®æ‘˜è¦ï¼Œå†è°ƒç”¨åˆ é™¤ï¼š

```
ç”¨æˆ·ï¼š"æˆ‘å·²ç»ä¸ä½åŒ—äº¬äº†ï¼Œå¸®æˆ‘åˆ æ‰é‚£æ¡è®°å½•"
  â†’ AI è°ƒç”¨ read_engram_file("name", "memory/_index.md") æ‰¾åˆ°å¯¹åº”æ¡ç›®
  â†’ ç¡®è®¤æ‘˜è¦æ–‡æœ¬ â†’ è°ƒç”¨ delete_memory("name", "user-profile", "å±…ä½åœ¨åŒ—äº¬")
  â†’ æ¡ç›®ä»ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ä¸­åŒæ—¶ç§»é™¤
```

> `summary` å‚æ•°éœ€ä¸ç´¢å¼•ä¸­çš„æ‘˜è¦æ–‡æœ¬å®Œå…¨åŒ¹é…ï¼Œå»ºè®®å…ˆè¯»ç´¢å¼•å†è°ƒç”¨ã€‚

### è®°å¿†ä¿®æ­£ï¼ˆcorrect_memoryï¼‰

å½“ç”¨æˆ·è¯´æŸæ¡è®°å¿†å†…å®¹ä¸å‡†ç¡®æ—¶ä½¿ç”¨ã€‚åŸæ—¶é—´æˆ³ä¿ç•™ï¼Œåªæ›´æ–°å†…å®¹å’Œæ‘˜è¦ï¼š

```
ç”¨æˆ·ï¼š"æˆ‘ä½“é‡ä¸æ˜¯80kgäº†ï¼Œç°åœ¨75kg"
  â†’ AI è¯»å– memory/_index.mdï¼Œæ‰¾åˆ°æ‘˜è¦"ä½“é‡80kg"
  â†’ è°ƒç”¨ correct_memory("name", "user-profile", "ä½“é‡80kg",
      "ç”¨æˆ·ä½“é‡75kgï¼ˆå·²å‡é‡ï¼‰", "ä½“é‡75kg", memory_type="fact")
  â†’ åŸæ¡ç›®å†…å®¹å’Œç´¢å¼•åŒæ­¥æ›´æ–°ï¼Œæ—¶é—´æˆ³ä¿ç•™
```

`memory_type` å’Œ `tags` å¯åœ¨ä¿®æ­£æ—¶ä¸€å¹¶æ›´æ–°ï¼Œæ— éœ€å•ç‹¬æ“ä½œã€‚

### åŠ¨æ€çŸ¥è¯†æ‰©å……ï¼ˆadd_knowledgeï¼‰

å¯¹è¯ä¸­å‘ç°éœ€è¦è¡¥å……æ–°çŸ¥è¯†ä¸»é¢˜æ—¶ä½¿ç”¨ã€‚é€‚åˆ"å¶å°”è¡¥å……ä¸€ä¸ªæ–°ä¸»é¢˜"ï¼Œä¸é€‚åˆæ‰¹é‡å¯¼å…¥ï¼š

```
ç”¨æˆ·ï¼š"å¸®æˆ‘æŠŠåˆšæ‰è®¨è®ºçš„è·‘æ­¥æŠ€æœ¯è¦ç‚¹è®°å½•åˆ°çŸ¥è¯†åº“é‡Œ"
  â†’ AI æ•´ç†å†…å®¹
  â†’ è°ƒç”¨ add_knowledge("name", "è·‘æ­¥æŠ€æœ¯", "# è·‘æ­¥æŠ€æœ¯\n\nè½åœ°æ–¹å¼...", "è½åœ°æ–¹å¼ä¸æ­¥é¢‘ä¼˜åŒ–è¦ç‚¹")
  â†’ æ–°æ–‡ä»¶å†™å…¥ knowledge/è·‘æ­¥æŠ€æœ¯.mdï¼Œknowledge/_index.md è‡ªåŠ¨è¿½åŠ ä¸€è¡Œ
```

> çŸ¥è¯†ç´¢å¼•æ¡ç›®è¶…è¿‡ 15 ä¸ªæ—¶ï¼Œå»ºè®®æ‰‹åŠ¨æ•´ç† `_index.md` çš„ `###` åˆ†ç»„ç»“æ„ï¼Œå¸®åŠ©æ¨¡å‹å¿«é€Ÿå®šä½ã€‚



### è‡ªåŠ¨æ¨¡å¼

Agent çœ‹åˆ° `list_engrams` è¿”å›çš„æ‘˜è¦ï¼Œåˆ¤æ–­å½“å‰é—®é¢˜æ˜¯å¦åŒ¹é…æŸä¸ªä¸“å®¶ï¼ŒåŒ¹é…åˆ™è‡ªåŠ¨åŠ è½½ï¼š

```
ç”¨æˆ·ï¼š"æˆ‘è†ç›–ç–¼ï¼Œè¿˜èƒ½åšæ·±è¹²å—ï¼Ÿ"
  â†’ agent è°ƒç”¨ list_engrams() çœ‹åˆ° fitness-coach
  â†’ åˆ¤æ–­åŒ¹é… â†’ è°ƒç”¨ load_engram("fitness-coach", "è†ç›–ç–¼æ·±è¹²")
  â†’ çœ‹åˆ°çŸ¥è¯†ç´¢å¼•ä¸­çš„æ‘˜è¦ï¼Œåˆ¤æ–­éœ€è¦æ·±å…¥
  â†’ è°ƒç”¨ read_engram_file("fitness-coach", "knowledge/è†å…³èŠ‚æŸä¼¤è®­ç»ƒ.md")
  â†’ æ‹¿åˆ°å®Œæ•´çŸ¥è¯† â†’ ä»¥ä¸“å®¶èº«ä»½å›ç­”
```

### æ‰‹åŠ¨æ¨¡å¼

ç”¨æˆ·ç”¨ `@engram-name` ç›´æ¥æŒ‡å®šï¼Œagent è·³è¿‡åˆ¤æ–­ç›´æ¥åŠ è½½ï¼š

```
ç”¨æˆ·ï¼š"@fitness-coach å¸®æˆ‘åˆ¶å®šä¸€ä¸ªå¢è‚Œè®¡åˆ’"
  â†’ agent è¯†åˆ« @ æŒ‡ä»¤ â†’ ç›´æ¥è°ƒç”¨ load_engram("fitness-coach", "å¢è‚Œè®¡åˆ’")
```

> @ æŒ‡ä»¤çš„è§£æä¾èµ– agent ç«¯ã€‚MCP server åªæä¾›å·¥å…·ï¼Œä¸å¤„ç†æ¶ˆæ¯æ ¼å¼ã€‚

## Engram åŒ…ç»“æ„

```text
<engram-name>/
  meta.json           # æ”¯æŒ extends å­—æ®µå®ç°ç»§æ‰¿
  role.md
  workflow.md
  rules.md            # æ”¯æŒ ## Onboarding åŒºå—
  knowledge/
    _index.md
    <topic>.md
  examples/           # å¯é€‰
    _index.md
    <case>.md
  memory/             # åŠ¨æ€è®°å¿†ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œå¯¹è¯ä¸­æ•è·ï¼‰
    _index.md         # çƒ­å±‚ï¼šæœ€è¿‘50æ¡
    _index_full.md    # å†·å±‚ï¼šå®Œæ•´è®°å½•ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰
    <category>.md
```

`meta.json` æ”¯æŒ `extends` å­—æ®µå®ç° Engram ç»§æ‰¿ï¼š

```json
{
  "name": "sports-nutritionist",
  "extends": "fitness-coach",
  "description": "è¿åŠ¨è¥å…»å¸ˆï¼Œåœ¨å¥èº«æ•™ç»ƒåŸºç¡€ä¸Šå¢åŠ è¥å…»å­¦çŸ¥è¯†"
}
```

åŠ è½½æ—¶è‡ªåŠ¨åˆå¹¶çˆ¶ Engram çš„ knowledge indexï¼ˆä»…å•å±‚ç»§æ‰¿ï¼‰ï¼›å­ Engram çš„ role/workflow/rules/examples/memory å®Œå…¨ç‹¬ç«‹ï¼Œä¸ç»§æ‰¿çˆ¶é¡¹ã€‚

`meta.json` ç¤ºä¾‹ï¼š

```json
{
  "name": "fitness-coach",
  "author": "test",
  "version": "1.0.0",
  "description": "å‰åº·å¤æœºæ„è®­ç»ƒä¸»ç®¡ï¼Œ10å¹´æ•™ç»ƒç»éªŒï¼Œæ“…é•¿å¢è‚Œå‡è„‚ã€è†è‚©ä¸é€‚è®­ç»ƒè°ƒæ•´ä¸å¯æ‰§è¡Œè®¡åˆ’è½åœ°",
  "tags": ["å¥èº«", "è¥å…»", "è®­ç»ƒè®¡åˆ’"],
  "knowledge_count": 5,
  "examples_count": 3
}
```

## ä½¿ç”¨åœºæ™¯

Engram ä¸åªæ˜¯ä¸“å®¶ç³»ç»Ÿâ€”â€”å®ƒæ˜¯ä¸€ä¸ªé€šç”¨çš„èº«ä»½æ³¨å…¥æ¡†æ¶ï¼Œé€‚ç”¨äºä»»ä½•ä½ æƒ³è®© AI "æˆä¸º"çš„è§’è‰²ã€‚

| åœºæ™¯ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| ä¸“å®¶é¡¾é—® | å¥èº«æ•™ç»ƒã€å¾‹å¸ˆã€è¥å…»å¸ˆç­‰å‚ç›´é¢†åŸŸä¸“å®¶ | `fitness-coach` |
| èŠå¤©ä¼™ä¼´ | è¿œæ–¹çš„æœ‹å‹ã€å®¶äººï¼Œä¿ç•™ä»–ä»¬çš„è¯´è¯æ–¹å¼å’Œè®°å¿† | `old-friend` |
| è¯­è¨€é™ªç»ƒ | æ¯è¯­è€…è§’è‰²ï¼Œåœ¨èŠå¤©ä¸­è‡ªç„¶çº é”™å’Œæ•™å­¦ | `language-partner` |
| æ¨¡æ‹Ÿé¢è¯• | æŠ€æœ¯é¢è¯•å®˜ï¼Œå®Œæ•´çš„é¢è¯•æµç¨‹å’Œåé¦ˆ | `mock-interviewer` |
| ç”¨æˆ·ç”»åƒ | ç›®æ ‡ç”¨æˆ·è§’è‰²ï¼Œç”¨äºäº§å“éªŒè¯å’Œç”¨æˆ·ç ”ç©¶ | `user-persona` |
| å“ç‰Œå®¢æœ | ç»Ÿä¸€çš„å®¢æœäººè®¾ã€è¯æœ¯è§„èŒƒå’Œå¤„ç†æµç¨‹ | `brand-support` |
| è§’è‰²æ‰®æ¼” | å°è¯´è§’è‰²ã€æ¸¸æˆNPCï¼Œç”¨äºåˆ›ä½œæˆ–äº’åŠ¨å™äº‹ | `novel-character` |
| å†å²äººç‰© | åŸºäºå²æ–™çš„æ€ç»´æ¨¡å¼è¿˜åŸï¼Œç”¨äºæ€è¾¨å’Œå­¦ä¹  | `historical-figure` |
| é¡¹ç›®ä¸Šä¸‹æ–‡ | å›¢é˜Ÿçš„æ¶æ„å†³ç­–ã€æŠ€æœ¯é€‰å‹ã€è¸©å‘è®°å½• | `project-context` |
| è¿‡å»çš„è‡ªå·± | è®°å½•æŸä¸ªäººç”Ÿé˜¶æ®µçš„æƒ³æ³•ï¼Œæœªæ¥å›é¡¾å’Œåæ€ | `past-self` |

## ä¸ MCP å·¥å…·å’Œ Skills åä½œ

Engram è´Ÿè´£"æ˜¯è° + çŸ¥é“ä»€ä¹ˆ + æ€ä¹ˆæ€è€ƒ"ï¼ŒMCP å·¥å…·å’Œ Skills è´Ÿè´£"èƒ½åšä»€ä¹ˆ"ã€‚ä¸‰è€…ç›¸è¾…ç›¸æˆï¼š

```
Engram  = èº«ä»½ + çŸ¥è¯† + å†³ç­–æµç¨‹
MCP å·¥å…· = å¯è°ƒç”¨çš„å¤–éƒ¨èƒ½åŠ›ï¼ˆæ•°æ®åº“ã€ç›‘æ§ã€API ç­‰ï¼‰
Skills  = å¯è§¦å‘çš„æ“ä½œæµç¨‹ï¼ˆéƒ¨ç½²ã€å›æ»šã€ä»£ç ç”Ÿæˆç­‰ï¼‰
```

åœ¨ `workflow.md` ä¸­ï¼Œä½ å¯ä»¥æŒ‡å®šåœ¨ç‰¹å®šå†³ç­–èŠ‚ç‚¹è°ƒç”¨å“ªäº› MCP å·¥å…·æˆ– Skillsã€‚æ¨¡å‹åŠ è½½ Engram åï¼Œä¼šæŒ‰ç…§ workflow çš„æŒ‡å¼•ï¼Œåœ¨åˆé€‚çš„æ—¶æœºä¸»åŠ¨è°ƒç”¨è¿™äº›å·¥å…·ã€‚
`starter-complete` ä¸ `starter-template` é‡Œä¹Ÿå·²åŠ å…¥è¿™æ¡æé†’ï¼Œæ–¹ä¾¿ç›´æ¥ç…§ç€æ”¹ã€‚

ç¤ºä¾‹ï¼ˆæ¥è‡ª `examples/project-context/workflow.md`ï¼‰ï¼š

```markdown
## å¯è°ƒç”¨çš„å¤–éƒ¨å·¥å…·

| åŠ¨ä½œ | å·¥å…·ç±»å‹ | è°ƒç”¨æ–¹å¼ |
|------|----------|----------|
| æŸ¥çœ‹æœ€è¿‘æäº¤ | MCP å·¥å…· | è°ƒç”¨ git MCP server çš„ git_log |
| æŸ¥çœ‹æœåŠ¡æ—¥å¿— | MCP å·¥å…· | è°ƒç”¨ grafana MCP server çš„ query_logs |
| éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ | Skill | è§¦å‘ /deploy-staging skill |
| å›æ»šçº¿ä¸Šç‰ˆæœ¬ | Skill | è§¦å‘ /rollback skill |
```

è¿™æ · Engram å°±ä¸åªæ˜¯"çŸ¥è¯†åº“"ï¼Œè€Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸“å®¶å·¥ä½œå°â€”â€”æ—¢çŸ¥é“æ€ä¹ˆåˆ¤æ–­ï¼Œä¹ŸçŸ¥é“è¯¥è°ƒä»€ä¹ˆå·¥å…·ã€‚

## åˆ›å»ºè‡ªå·±çš„ Engram

æœ€å°å¯ç”¨åŒ…ï¼š

```text
my-engram/
  meta.json
  role.md
```

æ¨èå®Œæ•´ç»“æ„ï¼š

- `role.md`ï¼šèƒŒæ™¯ç»å†ã€æ²Ÿé€šé£æ ¼ã€æ ¸å¿ƒä¿¡å¿µ
- `workflow.md`ï¼šå†³ç­–æµç¨‹
- `rules.md`ï¼šè¿ä½œè§„åˆ™ã€å¸¸è§é”™è¯¯ã€**è®°å¿†è§„åˆ™**ï¼ˆè§ä¸‹æ–¹ï¼‰
- `knowledge/_index.md` + ä¸»é¢˜æ–‡ä»¶ï¼šçŸ¥è¯†ç´¢å¼•ï¼ˆå«å†…è”æ‘˜è¦ï¼‰+ ç»†èŠ‚
- `examples/_index.md` + æ¡ˆä¾‹æ–‡ä»¶ï¼šæ¡ˆä¾‹ç´¢å¼•ï¼ˆå« uses å…³è”ï¼‰+ å¤ç›˜
- `memory/`ï¼šåŠ¨æ€è®°å¿†ç›®å½•ï¼ˆå¯¹è¯ä¸­è‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºï¼‰

### åœ¨ rules.md ä¸­å®šä¹‰è®°å¿†è§„åˆ™ï¼ˆæ¨èï¼‰

`capture_memory` ä¾èµ– AI çš„ä¸»åŠ¨åˆ¤æ–­ï¼Œä½† AI ä¸çŸ¥é“"è¿™ä¸ª Engram åº”è¯¥è®°ä»€ä¹ˆ"ã€‚åœ¨ `rules.md` æœ«å°¾åŠ ä¸€èŠ‚ `## è®°å¿†è§„åˆ™`ï¼Œæ˜ç¡®å‘Šè¯‰ AI ä½•æ—¶æ•è·ã€ç”¨ä»€ä¹ˆ category å’Œ memory_typeï¼Œå¯ä»¥å¤§å¹…æå‡è®°å¿†çš„è¦†ç›–ç‡å’Œå‡†ç¡®æ€§ã€‚

```markdown
## è®°å¿†è§„åˆ™
- ç”¨æˆ·æåˆ°èº«ä½“çŠ¶å†µã€ä¼¤ç—…æˆ–ç–¼ç—›æ—¶ â†’ capture_memory(category="health", memory_type="fact", tags=["injury"])
  ç¤ºä¾‹ï¼šè†ç›–æ—§ä¼¤ã€è‚©è¢–é—®é¢˜ã€è…°æ¤é—´ç›˜çªå‡º
- ç”¨æˆ·è¯´å‡ºå…·ä½“è®­ç»ƒç›®æ ‡æ—¶ â†’ capture_memory(category="goals", memory_type="fact")
  ç¤ºä¾‹ï¼š3ä¸ªæœˆå‡10æ–¤ã€å¤‡æˆ˜é©¬æ‹‰æ¾ã€å¢è‚Œ5kg
- ç”¨æˆ·å¯¹è®­ç»ƒè®¡åˆ’ç»™å‡ºåé¦ˆæ—¶ â†’ capture_memory(category="feedback", memory_type="preference")
  ç¤ºä¾‹ï¼šä¸Šæ¬¡çš„è®¡åˆ’å¤ªç´¯ã€å–œæ¬¢å±…å®¶è®­ç»ƒã€ä¸å–œæ¬¢è·‘æ­¥
- ç”¨æˆ·åšå‡ºå…³é”®è®­ç»ƒå†³å®šæ—¶ â†’ capture_memory(category="decisions", memory_type="decision")
  ç¤ºä¾‹ï¼šå†³å®šä»å…¨èº«è®­ç»ƒå¼€å§‹ã€é€‰æ‹©äº†3å¤©åˆ†åŒ–æ–¹æ¡ˆ
```

**è®¾è®¡åŸåˆ™ï¼š**
- æ¯æ¡è§„åˆ™å¯¹åº”ä¸€ä¸ªæ˜ç¡®çš„è§¦å‘åœºæ™¯ï¼Œä¸è¦å†™"å‘ç°é‡è¦ä¿¡æ¯æ—¶"è¿™ç§æ¨¡ç³Šæè¿°
- category å‘½åä¿æŒä¸€è‡´ï¼ŒåŒä¸€ç±»ä¿¡æ¯å§‹ç»ˆå†™å…¥åŒä¸€ä¸ªæ–‡ä»¶
- ç”¨ memory_type åŒºåˆ†ä¿¡æ¯æ€§è´¨ï¼š`fact`ï¼ˆå®¢è§‚äº‹å®ï¼‰/ `preference`ï¼ˆåå¥½ï¼‰/ `decision`ï¼ˆå†³å®šï¼‰/ `history`ï¼ˆå†å²èŠ‚ç‚¹ï¼‰
- tags ç”¨äºåŒä¸€ category å†…çš„ç»†åˆ†è¿‡æ»¤ï¼Œå¦‚ `["injury", "knee"]`

æ‰€æœ‰å†…ç½®ç¤ºä¾‹ï¼ˆ`examples/` ç›®å½•ï¼‰å‡å·²åŒ…å«é’ˆå¯¹å„è‡ªé¢†åŸŸçš„è®°å¿†è§„åˆ™ï¼Œå¯ç›´æ¥å‚è€ƒã€‚

### æ¡ˆä¾‹å…ƒæ•°æ®ï¼ˆYAML frontmatterï¼‰

æ¯ä¸ªæ¡ˆä¾‹æ–‡ä»¶å¤´éƒ¨å»ºè®®ä½¿ç”¨ç»“æ„åŒ– YAML frontmatterï¼Œè‡³å°‘åŒ…å« `id` / `title` / `uses` / `tags` / `updated_at`ï¼š

```markdown
---
id: example_fitness_coach_è†ç›–ç–¼çš„ä¸Šç­æ—
title: è†ç›–ç–¼çš„ä¸Šç­æ—
uses:
  - knowledge/è†å…³èŠ‚æŸä¼¤è®­ç»ƒ.md
  - knowledge/æ–°æ‰‹è®­ç»ƒè®¡åˆ’.md
tags:
  - fitness-coach
  - example
  - è†å…³èŠ‚æŸä¼¤è®­ç»ƒ
  - æ–°æ‰‹è®­ç»ƒè®¡åˆ’
updated_at: 2026-02-26
---

é—®é¢˜æè¿°ï¼š32å²ä¸Šç­æ—ï¼Œä¹…åå¯¼è‡´è†ç›–ä¸é€‚...
```

`uses` è´Ÿè´£æ¡ˆä¾‹â†’çŸ¥è¯†å…³è”ï¼›`id` ä¾¿äºå”¯ä¸€æ ‡è¯†ä¸è¿½è¸ªï¼›`updated_at` å»ºè®®ç»Ÿä¸€ `YYYY-MM-DD`ï¼›`tags` ç”¨äºä¸»é¢˜æ£€ç´¢ä¸ç­›é€‰ã€‚çŸ¥è¯†æ–‡ä»¶ä¿æŒåŸå­åŒ–ï¼Œæ¡ˆä¾‹è´Ÿè´£ç»„åˆä¸è½åœ°ã€‚`_index.md` ä¸­ä¹Ÿä¼šå±•ç¤º uses å…³è”ï¼Œå¸®åŠ©æ¨¡å‹å¿«é€Ÿåˆ¤æ–­å“ªäº›æ¡ˆä¾‹å’ŒçŸ¥è¯†ç›¸å…³ã€‚

> å½“çŸ¥è¯†æ–‡ä»¶è¶…è¿‡ 10 ä¸ªæ—¶ï¼Œå»ºè®®åœ¨ `_index.md` ä¸­ç”¨ `###` æŒ‰ä¸»é¢˜åˆ†ç»„ï¼Œå¸®åŠ©æ¨¡å‹å¿«é€Ÿå®šä½ç›¸å…³æ¡ç›®ï¼Œé¿å…å¹³é“ºè¿‡é•¿å¯¼è‡´æ¼çœ‹ã€‚å‚è§ `examples/fitness-coach/knowledge/_index.md`ã€‚

å¯ç›´æ¥å‚è€ƒæ¨¡æ¿å’Œå®Œæ•´ç¤ºä¾‹ï¼š

- `examples/template/` â€” ç©ºç™½æ¨¡æ¿ï¼ˆå« Onboarding åŒºå—ç¤ºä¾‹ï¼‰
- `examples/fitness-coach/` â€” ä¸“å®¶é¡¾é—®ï¼ˆå¥èº«æ•™ç»ƒï¼‰
- `examples/sports-nutritionist/` â€” ç»§æ‰¿ç¤ºä¾‹ï¼ˆextends fitness-coachï¼Œè¿åŠ¨è¥å…»å¸ˆï¼‰
- `examples/old-friend/` â€” èŠå¤©ä¼™ä¼´ï¼ˆè¿œåœ¨æ—§é‡‘å±±çš„è€æœ‹å‹ï¼‰
- `examples/language-partner/` â€” è¯­è¨€é™ªç»ƒï¼ˆä¸œäº¬ä¸Šç­æ—ï¼Œæ—¥è¯­ç»ƒä¹ ï¼‰
- `examples/mock-interviewer/` â€” æ¨¡æ‹Ÿé¢è¯•å®˜ï¼ˆæŠ€æœ¯é¢è¯•å…¨æµç¨‹ï¼‰
- `examples/user-persona/` â€” ç”¨æˆ·ç”»åƒï¼ˆäº§å“éªŒè¯ç”¨çš„ç›®æ ‡ç”¨æˆ·ï¼‰
- `examples/brand-support/` â€” å“ç‰Œå®¢æœï¼ˆç»Ÿä¸€è¯æœ¯å’ŒæœåŠ¡æ ‡å‡†ï¼‰
- `examples/novel-character/` â€” è™šæ„è§’è‰²ï¼ˆèµ›åšæœ‹å…‹ä¸–ç•Œçš„é»‘å®¢ï¼‰
- `examples/historical-figure/` â€” å†å²äººç‰©ï¼ˆç‹é˜³æ˜ï¼Œå¿ƒå­¦å¯¹è¯ï¼‰
- `examples/project-context/` â€” é¡¹ç›®ä¸Šä¸‹æ–‡ï¼ˆå›¢é˜Ÿæ¶æ„å†³ç­–å’Œè¸©å‘è®°å½•ï¼‰
- `examples/past-self/` â€” è¿‡å»çš„è‡ªå·±ï¼ˆ2020å¹´åˆšæ¯•ä¸šçš„ç‰ˆæœ¬ï¼‰

## åœ¨ AI å·¥å…·ä¸­é›†æˆ

> ä»¥ä¸‹é…ç½®ä¸­ï¼Œå°† `/path/to/engram-mcp-server` æ›¿æ¢ä¸ºä½ çš„å®é™…é¡¹ç›®è·¯å¾„ã€‚

### Claude Desktop

åœ¨ `claude_desktop_config.json` ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "engram-server": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/engram-mcp-server",
        "engram-server",
        "--packs-dir", "~/.engram"
      ]
    }
  }
}
```

### Claude Code

é¡¹ç›®çº§é…ç½®ï¼ˆ`.mcp.json` æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰æˆ–å…¨å±€é…ç½®ï¼ˆ`~/.claude/settings.json`ï¼‰ï¼š

```json
{
  "mcpServers": {
    "engram-server": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/engram-mcp-server",
        "engram-server",
        "--packs-dir", "~/.engram"
      ]
    }
  }
}
```

### Cursor / Windsurf / å…¶ä»– MCP å…¼å®¹ IDE

åœ¨å¯¹åº” IDE çš„ MCP é…ç½®ä¸­æ·»åŠ ç›¸åŒçš„ server é…ç½®å³å¯ã€‚å…·ä½“é…ç½®æ–‡ä»¶ä½ç½®è¯·å‚è€ƒå„ IDE æ–‡æ¡£ã€‚

### Codex

```json
{
  "mcpServers": {
    "engram-server": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/engram-mcp-server",
        "engram-server",
        "--packs-dir", "~/.engram"
      ]
    }
  }
}
```

## å¯ç”¨è‡ªåŠ¨åŠ è½½

### æ–¹å¼ Aï¼šæ‰‹åŠ¨æ·»åŠ  System Promptï¼ˆæ¨èï¼‰

å°†ä»¥ä¸‹æç¤ºè¯æ·»åŠ åˆ°å¯¹åº” AI å·¥å…·çš„æŒ‡ä»¤æ–‡ä»¶å¼€å¤´ï¼š

| AI å·¥å…· | æŒ‡ä»¤æ–‡ä»¶ |
|---------|---------|
| Claude Code | é¡¹ç›®æ ¹ç›®å½•çš„ `CLAUDE.md` |
| Codex | é¡¹ç›®æ ¹ç›®å½•çš„ `AGENTS.md` |
| å…¶ä»– | å¯¹åº”å·¥å…·çš„ system prompt é…ç½® |

```text
ä½ æœ‰ä¸€ä¸ªä¸“å®¶è®°å¿†ç³»ç»Ÿå¯ç”¨ã€‚å¯¹è¯å¼€å§‹æ—¶å…ˆè°ƒç”¨ engram-server è¿™ä¸ª MCP ä¸­çš„ list_engrams() æŸ¥çœ‹å¯ç”¨ä¸“å®¶ã€‚

# è‡ªåŠ¨æ‰§è¡Œè§„åˆ™ï¼ˆå‚»ç“œå¼ï¼‰
- é»˜è®¤åŸåˆ™ï¼šèƒ½ç”±æ¨¡å‹ç›´æ¥å®Œæˆçš„äº‹ï¼Œä¸è®©ç”¨æˆ·æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ï¼›ä¼˜å…ˆç›´æ¥è°ƒç”¨ MCP å·¥å…·ã€‚
- é™¤éç¯å¢ƒ/æƒé™é˜»å¡ï¼Œå¦åˆ™ä¸è¦è®©ç”¨æˆ·â€œè‡ªå·±å»ç»ˆç«¯è·‘å‘½ä»¤â€ã€‚
- å¦‚æœè°ƒç”¨äº† MCPï¼Œå›å¤æ—¶è¦å‘Šè¯‰ç”¨æˆ·è°ƒç”¨äº†ä»€ä¹ˆ MCP å’Œå“ªä¸ªä¸“å®¶ã€‚
- é¦–æ¬¡è¿›å…¥æ–°é¡¹ç›®æ—¶ï¼Œé»˜è®¤æ£€æŸ¥å¹¶ä½¿ç”¨ `./.claude/engram`ã€‚
- ç›®å½•ç­–ç•¥ç»Ÿä¸€ä¸ºâ€œé¡¹ç›®çº§ä¼˜å…ˆï¼Œ`~/.engram` ä¸ºå…±äº«/å›é€€ç›®å½•â€ã€‚

## è‡ªç„¶è¯­è¨€æ„å›¾ -> MCP è‡ªåŠ¨æ˜ å°„
- ç”¨æˆ·è¯´â€œæ‰¾/æŸ¥/æ¨èæŸç±» Engramâ€ -> è‡ªåŠ¨è°ƒç”¨ search_engrams(query)
- ç”¨æˆ·è¯´â€œå®‰è£…æŸä¸ª Engramâ€ -> è‡ªåŠ¨è°ƒç”¨ install_engram(source-or-name)
- å®‰è£…é»˜è®¤å†™å…¥å½“å‰é¡¹ç›® `./.claude/engram`ï¼Œä¸æ˜¯é»˜è®¤å…¨å±€ç›®å½•ã€‚
- ç”¨æˆ·è¯´â€œåˆå§‹åŒ–å½“å‰é¡¹ç›® engramâ€ -> ä¼˜å…ˆæ£€æŸ¥ `starter-complete` / `starter-template` æ˜¯å¦å­˜åœ¨ã€‚
- install_engram(name/source) å¤±è´¥æ—¶ï¼Œä¸ä¸­æ–­ç”¨æˆ·ï¼šè‡ªåŠ¨è°ƒç”¨ search_engrams(query) æ‰¾å€™é€‰åé‡è¯• install_engramã€‚
- ç”¨æˆ·è¯´â€œçœ‹ç»Ÿè®¡/å¯¼å‡ºæŠ¥è¡¨â€ -> è‡ªåŠ¨è°ƒç”¨ stats_engrams(format=plain/json/csv)
- ç”¨æˆ·è¯´â€œåˆ›å»º Engramâ€ -> è‡ªåŠ¨è¿›å…¥åˆ›å»ºåŠ©æ‰‹æµç¨‹ï¼ˆcreate_engram_assistant + finalize_engram_draftï¼‰
- å½“ç”¨æˆ·è¯´"æ‰“å¼€engramç®¡ç†ç•Œé¢"ï¼ŒAI è°ƒç”¨ open_ui()

## ä¸“å®¶åŠ è½½ä¸çŸ¥è¯†è¯»å–
- ç”¨æˆ·é—®é¢˜åŒ¹é…æŸä¸ªä¸“å®¶æ—¶ï¼Œè°ƒç”¨ load_engram(name, query)ã€‚
- load_engram åä¼˜å…ˆçœ‹çŸ¥è¯†ç´¢å¼•/æ¡ˆä¾‹ç´¢å¼•ï¼›ç´¢å¼•ä¸è¶³å† read_engram_file(name, "knowledge/xxx.md")ã€‚
- è‹¥ workflow æ˜ç¡®å†™äº† Skill è°ƒç”¨èŠ‚ç‚¹ï¼ŒæŒ‰èŠ‚ç‚¹æç¤ºä¸»åŠ¨è°ƒç”¨å¯¹åº” Skillsã€‚
- load_engram è¿”å›â€œç»§æ‰¿çŸ¥è¯†ç´¢å¼•â€åŒºå—æ—¶ï¼Œå¯ read_engram_file(çˆ¶ä¸“å®¶å, "knowledge/xxx.md") è¯»å–çˆ¶çŸ¥è¯†ã€‚
- åœ¨ load_engram åä¼˜å…ˆè¯»å–æ¡ˆä¾‹ frontmatter çš„ id/title/uses/tags/updated_atï¼Œå†å†³å®šè¦ä¸è¦è¯»å…·ä½“ knowledge æ–‡ä»¶ã€‚

## è®°å¿†å†™å…¥è§„åˆ™
- å‘ç°è·¨ä¸“å®¶é€šç”¨ä¿¡æ¯ï¼ˆå¹´é¾„ã€åŸå¸‚ã€èŒä¸šã€è¯­è¨€åå¥½ç­‰ï¼‰ -> capture_memory(..., is_global=True)
- çŠ¶æ€æ€§ä¿¡æ¯ï¼ˆå¦‚â€œç”¨æˆ·æ­£åœ¨å¤‡è€ƒâ€ï¼‰è¦åŠ  expiresï¼ˆYYYY-MM-DDï¼‰ï¼Œåˆ°æœŸè‡ªåŠ¨å½’æ¡£éšè—ã€‚
- load_engram å‡ºç°â€œé¦–æ¬¡å¼•å¯¼â€åŒºå—æ—¶ï¼Œè‡ªç„¶æ”¶é›†å¹¶ capture_memoryã€‚
- å‘ç°ç”¨æˆ·åå¥½/å…³é”®äº‹å®/å…³é”®å†³å®šæ—¶ï¼ŒåŠæ—¶ capture_memory(name, content, category, summary, memory_type, tags, conversation_id, expires, is_global)ã€‚
- åªè¦è°ƒç”¨äº†å·¥å…·ï¼ˆSkills / MCP / Subagent / å…¶ä»–å¤–éƒ¨å·¥å…·ï¼‰ï¼Œéƒ½è¦è®°å½•å·¥å…·è½¨è¿¹ï¼šcapture_tool_trace(name, tool_name, intent, result_summary, args_summary, status, summary, tags, conversation_id)ã€‚
- å·¥å…·è°ƒç”¨å¤±è´¥ä¹Ÿè¦è®°å½•ï¼Œstatus è®¾ä¸º `error`ï¼Œresult_summary å†™æ¸…å¤±è´¥åŸå› ã€‚
- engram-server å†…éƒ¨å¤šæ•° `name` ç›¸å…³å·¥å…·ä¼šè‡ªåŠ¨å†™å…¥ tool-traceï¼›ä½†å¤–éƒ¨å·¥å…·ä¸ä¼šè‡ªåŠ¨å†™ï¼Œå¿…é¡»æ˜¾å¼è°ƒç”¨ capture_tool_traceã€‚
- å»é‡è§„åˆ™ï¼šè‹¥æœ¬è½®å·²è®°å½•è¿‡â€œåŒä¸€ tool_name + åŒä¸€ intentâ€çš„è½¨è¿¹ï¼Œä¸é‡å¤å†™å…¥ã€‚
- å¤–éƒ¨å·¥å…·è®°å½•å­—æ®µä¼˜å…ˆçº§ï¼šè‡³å°‘å¡«å†™ `tool_name`ã€`intent`ã€`args_summary`ã€`result_summary`ã€`status`ã€‚
- èŒƒå›´è§„åˆ™ï¼šåªæœ‰å·² `load_engram(name, ...)` çš„ä¸“å®¶ï¼Œæ‰å†™å…¥è¯¥ `name` çš„å·¥å…·è½¨è¿¹ï¼Œé¿å…ä¸²ä¸“å®¶è®°å¿†ã€‚
- äº¤ä»˜å‰æ£€æŸ¥ï¼šè‹¥æœ¬è½®å‘ç”Ÿè¿‡å·¥å…·è°ƒç”¨ä½†æœªå†™ä»»ä½•è½¨è¿¹ï¼Œç»“æŸå‰è¡¥è®°è‡³å°‘ä¸€æ¡ `capture_tool_trace`ã€‚
- è®°å¿†æ¡ç›®è¾ƒå¤šå‡ºç°â€œğŸ’¡ å½“å‰å…± N æ¡è®°å¿†â€æ—¶ï¼Œå…ˆ read_engram_file(name, "memory/{category}.md")ï¼Œå† consolidate_memory(...)ã€‚
- ç”¨æˆ·è¦æ±‚åˆ é™¤è®°å¿† -> delete_memory(name, category, summary)
- ç”¨æˆ·çº æ­£è®°å¿† -> correct_memory(name, category, old_summary, new_content, new_summary, memory_type, tags)
- è®°å¿†è¾ƒå¤šæŸ¥å†å² -> read_engram_file(name, "memory/_index_full.md")

## çŸ¥è¯†å†™å…¥è§„åˆ™
- å¯¹è¯ä¸­å½¢æˆç³»ç»Ÿæ€§å¯å¤ç”¨çŸ¥è¯†ï¼ˆæ–¹æ³•è®º/å¯¹æ¯”åˆ†æ/å†³ç­–æ¡†æ¶ï¼‰æ—¶ï¼Œå…ˆè¯¢é—®ç”¨æˆ·æ˜¯å¦å†™å…¥çŸ¥è¯†åº“ï¼Œç¡®è®¤å add_knowledgeã€‚
- ç”¨æˆ·çº æ­£çŸ¥è¯†åº“é”™è¯¯æ—¶ï¼Œæè®®å¹¶æ‰§è¡Œ add_knowledge æ›´æ–°ã€‚
- add_knowledge æ”¯æŒåˆ†ç»„è·¯å¾„ï¼šfilename å¯ç”¨ "å­ç›®å½•/æ–‡ä»¶å"ï¼ˆå¦‚ "è®­ç»ƒåŸºç¡€/æ·±è¹²æ¨¡å¼"ï¼‰ã€‚

## åˆ›å»º Engram åŠ©æ‰‹ï¼ˆåŒæ¨¡å¼ï¼‰
- mode=from_conversationï¼šæŠŠå½“å‰å¯¹è¯è‡ªåŠ¨æ•´ç†æˆ Engram è‰ç¨¿ã€‚
- mode=guidedï¼šä¸€æ­¥æ­¥å¼•å¯¼ç”¨æˆ·å¡«å†™ï¼›ç”¨æˆ·è¯´â€œæ²¡æœ‰/ä½ æ¥â€æ—¶è‡ªåŠ¨è¡¥å…¨ã€‚
- ç»Ÿä¸€æµç¨‹ï¼š
  1) å…ˆè°ƒç”¨ create_engram_assistant(...) ç”Ÿæˆè‰ç¨¿å¹¶å›æ˜¾
  2) ç”¨æˆ·ç¡®è®¤åè°ƒç”¨ finalize_engram_draft(draft_json, confirm=True)
  3) finalize åå¿…é¡»çœ‹ lint ç»“æœï¼ˆerrors å¿…é¡»å…ˆä¿®å¤ï¼‰
- è‡ªåŠ¨ç”Ÿæˆå†…å®¹æ—¶å¿…é¡»æç¤ºï¼šå†…å®¹å¯èƒ½ä¸å®Œæ•´ï¼Œå»ºè®®ç”¨æˆ·è¡¥å……ã€‚
- åˆ›å»ºé˜¶æ®µä¸è‡ªåŠ¨ç”Ÿæˆç”¨æˆ·è®°å¿†æ¡ç›®ï¼›memory ä¿æŒç©ºæ¨¡æ¿ã€‚

### çŸ¥è¯†éªŒè¯è§„åˆ™ï¼ˆworkflow + knowledgeï¼‰
- ç›®æ ‡ï¼šåˆ›å»ºé˜¶æ®µå¯¹ workflow / knowledge ä¸­çš„äº‹å®æ€§å†…å®¹å…ˆè”ç½‘æ ¸éªŒï¼›æ— æ³•ç¡®è®¤çœŸä¼ªçš„å†…å®¹é»˜è®¤ä¸å†™å…¥æœ€ç»ˆçŸ¥è¯†ã€‚
- éªŒè¯çº§åˆ«ï¼ˆåˆ›å»ºæ—¶å¯é€‰ï¼‰ï¼š
  - å¿«é€Ÿï¼šä»…éªŒè¯å…³é”®äº‹å®ï¼Œå•æ¥æºä¼˜å…ˆã€‚
  - å¹³è¡¡ï¼ˆé»˜è®¤ï¼‰ï¼šå…³é”®äº‹å®åŒæ¥æºï¼Œéå…³é”®äº‹å®å•æ¥æºã€‚
  - ä¸¥æ ¼ï¼šäº‹å®æ€§å†…å®¹å…¨é‡éªŒè¯ï¼Œå…³é”®äº‹å®å¿…é¡»åŒæ¥æºã€‚
- ä¸¤ç§æ¨¡å¼å·®å¼‚ï¼š
  - from_conversationï¼šç”¨æˆ·åŸè¯å¯ä¿ç•™å¹¶æ ‡æ³¨â€œç”¨æˆ·é™ˆè¿°ï¼ˆæœªæ ¸éªŒï¼‰/ç”¨æˆ·ç»éªŒâ€ï¼›æ¨¡å‹äº§å‡ºä¸å¤–éƒ¨å¼•ç”¨æŒ‰é¢„ç­›ç»“æœé€‰æ‹©æ€§éªŒè¯ã€‚
  - guidedï¼šæ¨¡å‹ç”Ÿæˆçš„äº‹å®æ€§å†…å®¹é»˜è®¤å…¨é‡è¿›å…¥éªŒè¯é˜Ÿåˆ—ï¼ˆå¹»è§‰é£é™©æ›´é«˜ï¼‰ã€‚
- é˜¶æ®µä¸€ï¼ˆæå– + é¢„ç­›ï¼‰ï¼š
  - çŸ¥è¯†ç‚¹åˆ†ç±»ï¼šäº‹å®æ€§ / ç»éªŒæ€§ / è§‚ç‚¹æ€§ã€‚
  - from_conversation é¢å¤–åšæ¥æºå½’å±ï¼šç”¨æˆ·è¯´çš„ vs æ¨¡å‹è¯´çš„ã€‚
  - åŸºäºæ¨¡å‹è‡ªä¿¡åº¦é¢„åˆ¤ï¼šé«˜ç¡®ä¿¡åŸºç¡€äº‹å®å¯è·³è¿‡è”ç½‘ï¼Œå…¶ä»–è¿›å…¥éªŒè¯é˜Ÿåˆ—ã€‚
- é˜¶æ®µäºŒï¼ˆæ‰¹é‡éªŒè¯ï¼‰ï¼š
  - æŒ‰ä¸»é¢˜åˆ†ç»„æ‰¹é‡æœç´¢ï¼Œä¼˜å…ˆå¤ç”¨åŒè½®å·²éªŒè¯ç»“è®ºï¼Œé¿å…é€æ¡é‡å¤æŸ¥è¯¢ã€‚
  - å…³é”®çŸ¥è¯†ç‚¹åšäº¤å‰éªŒè¯ï¼ˆè‡³å°‘ä¸¤ä¸ªç‹¬ç«‹æ¥æºï¼‰ï¼Œéå…³é”®å¯å•æ¥æºä½è¯ã€‚
  - æ¥æºä¼˜å…ˆçº§ï¼šå®˜æ–¹æ–‡æ¡£ / æ ‡å‡† / è®ºæ–‡ / ä¸€æ‰‹æŠ€æœ¯æ–‡æ¡£ > å…¶ä»–ï¼›ç¤¾åŒºå†…å®¹åªèƒ½è¡¥å……ï¼Œä¸èƒ½å•ç‹¬ä½œä¸ºâ€œå·²éªŒè¯â€ä¾æ®ã€‚
- é˜¶æ®µä¸‰ï¼ˆè‰ç¨¿å›æ˜¾ + ä¸‰çº§æ ‡æ³¨ï¼‰ï¼š
  - âœ… å·²éªŒè¯ï¼šå†™å…¥å¹¶é™„æ¥æº URLï¼ˆè„šæ³¨æˆ–æ³¨é‡Šï¼‰ã€‚
  - âš ï¸ éƒ¨åˆ†ä½è¯ï¼šå¯å†™å…¥ä½†è¦æ ‡æ³¨â€œéƒ¨åˆ†ä½è¯â€ï¼Œç”±ç”¨æˆ·å†³å®šä¿ç•™æˆ–åˆ é™¤ã€‚
  - âŒ æ— æ³•éªŒè¯ï¼šé»˜è®¤ä¸å†™å…¥ï¼Œå•ç‹¬åˆ—å‡ºä¾›ç”¨æˆ·é€‰æ‹©æ˜¯å¦å¼ºåˆ¶åŠ å…¥ã€‚
  - ç»éªŒæ€§å†…å®¹æ ‡æ³¨â€œæœªéªŒè¯-ç»éªŒæ€§â€ï¼Œä¸è¿›è¡Œäº‹å®æ ¸éªŒä½†æ˜ç¡®å‘ŠçŸ¥è¾¹ç•Œã€‚
- å¼‚å¸¸ä¸é™çº§ï¼š
  - è”ç½‘å¤±è´¥/è¶…æ—¶æ—¶ï¼ŒæœªéªŒè¯äº‹å®åªå…è®¸ç•™åœ¨è‰ç¨¿â€œå¾…éªŒè¯â€åŒºï¼Œä¸å†™å…¥æœ€ç»ˆ knowledgeã€‚
  - guided æ¨¡å¼ä¸‹æ— æ³•éªŒè¯çš„æ¨¡å‹äº‹å®é»˜è®¤ä¸¢å¼ƒï¼›ä»…åœ¨ç”¨æˆ·æ˜ç¡®ç¡®è®¤æ—¶ä¾‹å¤–ä¿ç•™ã€‚
- finalize å‰æ£€æŸ¥ï¼š
  - è‰ç¨¿ä¸­æ¯æ¡çŸ¥è¯†åº”èƒ½çœ‹åˆ°éªŒè¯çŠ¶æ€ï¼ˆâœ…/âš ï¸/âŒï¼‰ä¸æ¥æº URL æˆ–æœªéªŒè¯åŸå› ã€‚
  - é»˜è®¤éµå¾ªâ€œä¸ç¡®å®šä¸å†™å…¥â€ï¼›è‹¥è¦ä¿ç•™æœªéªŒè¯å†…å®¹ï¼Œå¿…é¡»å…ˆè·å¾—ç”¨æˆ·æ˜ç¡®ç¡®è®¤ã€‚
- å¢é‡è¡¥æŸ¥ï¼š
  - åç»­ä½¿ç”¨ä¸­è‹¥å¼•ç”¨åˆ°æœªéªŒè¯çŸ¥è¯†ï¼Œåº”è¡¥åšä¸€æ¬¡è”ç½‘æ ¸éªŒï¼Œå¹¶åœ¨ä¸‹æ¬¡æ›´æ–°è‰ç¨¿/çŸ¥è¯†æ—¶è¡¥é½çŠ¶æ€ä¸æ¥æºã€‚

## ä¸€è‡´æ€§æ ¡éªŒ
- åªè¦æ¨¡å‹æ–°å¢/ä¿®æ”¹äº† knowledge/examples/index/meta/rulesï¼Œå®Œæˆåè‡ªåŠ¨è°ƒç”¨ lint_engrams(name)ã€‚
- è§£é‡Šè§„åˆ™ï¼š
  - error > 0ï¼šé˜»æ–­ï¼Œå…ˆä¿®å¤å†äº¤ä»˜ã€‚
  - ä»… warningï¼šå¯äº¤ä»˜ï¼Œä½†éœ€å‘ç”¨æˆ·è¯´æ˜é£é™©ã€‚

## å…¶ä»–
- ç”¨æˆ·ä¹Ÿå¯ä»¥ç”¨ @ä¸“å®¶å ç›´æ¥æŒ‡å®šä¸“å®¶ã€‚
- ç”¨æˆ·è¯¢é—®æŸä¸ª engram è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè°ƒç”¨ get_engram_info(name)ã€‚
- éœ€è¦ç›´æ¥æ”¹ role.md/workflow.md/rules.md ç­‰éçŸ¥è¯†åº“æ–‡ä»¶æ—¶ï¼Œè°ƒç”¨ write_engram_file(name, path, content, mode)ã€‚
- æ–°å¢/ä¿®æ”¹æ¡ˆä¾‹æ–‡ä»¶æ—¶ï¼Œç¡®ä¿ frontmatter å­—æ®µé½å…¨ï¼ˆid/title/uses/tags/updated_atï¼‰ï¼Œid å…¨å±€å”¯ä¸€ï¼Œupdated_at ç”¨å½“å¤©æ—¥æœŸã€‚
- å¤šæ¡ˆä¾‹å‘½ä¸­æ—¶ï¼Œå…ˆæŒ‰ tags åŒ¹é…ï¼Œå†å‚è€ƒ updated_at é€‰æ›´è¿‘çš„æ¡ˆä¾‹ã€‚
- å›å¤ä¸­å¼•ç”¨æ¡ˆä¾‹æ—¶ä¼˜å…ˆå¸¦ title + idï¼Œå‡å°‘æ­§ä¹‰ã€‚
- è‹¥å‘ç° frontmatter ç¼ºå­—æ®µæˆ– uses æŒ‡å‘ä¸å­˜åœ¨æ–‡ä»¶ï¼Œå…ˆä¿®å¤å†ç»§ç»­å›ç­”ã€‚
```

### æ–¹å¼ Bï¼šMCP Prompt

æœåŠ¡æš´éœ² `engram-system-prompt`ï¼Œæ”¯æŒ MCP Prompt çš„å®¢æˆ·ç«¯å¯è‡ªåŠ¨æ³¨å…¥ã€‚

### æ–¹å¼ Cï¼šå·¥å…·æè¿°å¼•å¯¼ï¼ˆé›¶é…ç½®ï¼‰

`list_engrams` / `load_engram` / `read_engram_file` çš„å·¥å…·æè¿°å·²åŒ…å«è°ƒç”¨æµç¨‹å¼•å¯¼ï¼Œéƒ¨åˆ† AI å®¢æˆ·ç«¯æ— éœ€é¢å¤–é…ç½®å³å¯è‡ªåŠ¨è§¦å‘ã€‚

## è°ƒæ•´å‹ç¼©è§¦å‘é˜ˆå€¼

å½“ `_index.md` ä¸­çš„è®°å¿†æ¡ç›®æ€»æ•°è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œ`load_engram` ä¼šæç¤º AI è¿›è¡Œå‹ç¼©ã€‚é»˜è®¤é˜ˆå€¼æ˜¯ **30 æ¡**ï¼Œå¯åœ¨ä»¥ä¸‹ä½ç½®ä¿®æ”¹ï¼š

æ–‡ä»¶ï¼š`src/engram_server/loader.py`ï¼Œå¸¸é‡ `_CONSOLIDATE_HINT_THRESHOLD`

```python
_CONSOLIDATE_HINT_THRESHOLD = 30
```

å»ºè®®èŒƒå›´ï¼š
- `20`ï¼šå¯¹è¯é¢‘ç¹ï¼Œå¸Œæœ›è®°å¿†ä¿æŒç²¾ç®€
- `30`ï¼šé»˜è®¤ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼ˆçº¦ 10-15 æ¬¡å¯¹è¯è§¦å‘ä¸€æ¬¡æç¤ºï¼‰
- `50`ï¼šè½»åº¦ä½¿ç”¨ï¼Œä¸æƒ³é¢‘ç¹å‹ç¼©

> è¿™åªæ˜¯ä¸€ä¸ªæç¤ºï¼ŒAI ä¸ä¼šè‡ªåŠ¨å‹ç¼©ï¼Œéœ€è¦ä¸»åŠ¨è°ƒç”¨ `consolidate_memory`ã€‚

---

## æ›´æ–°é¡¹ç›®

å¦‚æœä½¿ç”¨ä¸€é”®å®‰è£…ï¼ˆ`uvx --from git+...`ï¼‰ï¼Œæ¸…é™¤ç¼“å­˜åé‡å¯å³å¯è·å–æœ€æ–°ç‰ˆæœ¬ï¼š

```bash
uv cache clean
```

ç„¶å**é‡å¯ Claude Code**ï¼Œ`uvx` ä¼šè‡ªåŠ¨ä» GitHub æ‹‰å–æœ€æ–°ä»£ç ã€‚

> å½“å‰ç‰ˆæœ¬ä¼šåœ¨é¦–æ¬¡è¿è¡Œæ—¶ä¸ºé¡¹ç›®è‡ªåŠ¨åˆ›å»º `./.claude/engram/`ï¼ˆå« `starter-complete` ä¸ `starter-template`ï¼‰ã€‚`~/.engram/` ä»å¯ä½œä¸ºè·¨é¡¹ç›®å…±äº«ç›®å½•ã€‚

## å¤šè®¾å¤‡åŒæ­¥

### æ–¹æ¡ˆ Aï¼šiCloud / Dropbox / OneDrive åŒæ­¥ç›®å½•

æŠŠ `--packs-dir` æŒ‡å‘äº‘ç›˜åŒæ­¥ç›®å½•å³å¯ï¼Œå¤šå°è®¾å¤‡å…±ç”¨åŒä¸€ä»½ Engram æ•°æ®ï¼š

```bash
claude mcp add --scope user engram-server -- \
  uvx --from git+https://github.com/DazhuangJammy/Engram engram-server \
  --packs-dir "$HOME/Library/Mobile Documents/com~apple~CloudDocs/EngramPacks"
```

> Windows å¯æ”¹æˆ OneDrive è·¯å¾„ï¼Œä¾‹å¦‚ `C:\\Users\\<ä½ ç”¨æˆ·å>\\OneDrive\\EngramPacks`ã€‚

### æ–¹æ¡ˆ Bï¼šGit åŒæ­¥ï¼ˆæŠŠ `~/.engram` å½“ä½œä»“åº“ï¼‰

å¦‚æœä½ æ›´åå‘å¯å®¡è®¡å˜æ›´ï¼Œå¯ä»¥ç›´æ¥æŠŠ `~/.engram` åˆå§‹åŒ–ä¸º git ä»“åº“å¹¶æ¨é€åˆ°ç§æœ‰è¿œç¨‹ï¼š

```bash
cd ~/.engram
git init
git remote add origin <your-private-repo-url>
git add .
git commit -m "init engram packs"
git push -u origin main
```

ä¹‹ååœ¨å…¶ä»–è®¾å¤‡æ‹‰å–åŒä»“åº“ï¼Œå†ç”¨åŒæ ·çš„ MCP é…ç½®å³å¯ã€‚

## æµ‹è¯•

```bash
pytest -q
```

## è·¯çº¿å›¾

### å·²å®Œæˆï¼ˆv0.1.0ï¼‰

- MCP server æ ¸å¿ƒåŠŸèƒ½ï¼šlist / load / read_file / install / init
- åˆ†å±‚æ‡’åŠ è½½æ¶æ„ï¼šå¸¸é©»å±‚ + ç´¢å¼•ï¼ˆå«å†…è”æ‘˜è¦ï¼‰+ æŒ‰éœ€å…¨æ–‡
- æ¡ˆä¾‹â†’çŸ¥è¯†å…³è”ï¼šç»“æ„åŒ– YAML frontmatterï¼ˆid/title/uses/tags/updated_atï¼‰
- æ¨¡æ¿ç³»ç»Ÿï¼š`engram-server init` åˆ›å»ºæ ‡å‡†ç»“æ„
- æµ‹è¯•è¦†ç›–ï¼šloader / server / install
- 11 ä¸ªå®Œæ•´ç¤ºä¾‹ Engram

### å·²å®Œæˆï¼ˆv0.2.0ï¼‰

- åŠ¨æ€è®°å¿†ï¼š`capture_memory` å¯¹è¯ä¸­è‡ªåŠ¨æ•è·ç”¨æˆ·åå¥½å’Œå…³é”®ä¿¡æ¯
- å†™å…¥èƒ½åŠ›ï¼š`write_engram_file` æ”¯æŒä»å¯¹è¯è‡ªåŠ¨æ‰“åŒ… Engram
- `load_engram` è‡ªåŠ¨åŠ è½½ `memory/_index.md`ï¼Œæ— éœ€ç”¨æˆ·é‡å¤è¯´æ˜
- æ‰€æœ‰ç¤ºä¾‹ Engram æ–°å¢ memory/ æ ·æ¿

### å·²å®Œæˆï¼ˆv0.3.0ï¼‰

- `capture_memory` æ–°å¢ `memory_type`ï¼ˆpreference/fact/decision/history/generalï¼‰è¯­ä¹‰åˆ†ç±»
- `capture_memory` æ–°å¢ `tags` å‚æ•°ï¼Œæ”¯æŒå¤šæ ‡ç­¾è¿‡æ»¤
- `capture_memory` æ–°å¢ `conversation_id` å‚æ•°ï¼Œæ”¯æŒå¯¹è¯ä½œç”¨åŸŸç»‘å®š
- èŠ‚æµä¿æŠ¤ï¼š30 ç§’å†…ç›¸åŒå†…å®¹é‡å¤æ•è·è‡ªåŠ¨è·³è¿‡
- `load_engram` åŠ¨æ€è®°å¿†åŒºå—ç”¨ `<memory>` æ ‡ç­¾åŒ…è£¹ï¼ŒAI å¯æ¸…æ™°åŒºåˆ†è®°å¿†ä¸çŸ¥è¯†
- è®°å¿†ç´¢å¼•æ ¼å¼å‡çº§ï¼šå«ç±»å‹æ ‡æ³¨å’Œæ ‡ç­¾ä¿¡æ¯

### å·²å®Œæˆï¼ˆv0.4.0ï¼‰

- `consolidate_memory` å·¥å…·ï¼šå°†åŸå§‹æ¡ç›®å‹ç¼©ä¸ºå¯†é›†æ‘˜è¦ï¼ŒåŸå§‹æ¡ç›®å½’æ¡£è‡³ `{category}-archive.md`
- `_index.md` å‹ç¼©ååªä¿ç•™ä¸€æ¡ `[consolidated]` æ¡ç›®ï¼Œcontext æ³¨å…¥é‡æ°¸è¿œå¯æ§
- `load_engram` å½“è®°å¿†æ¡ç›® â‰¥ 30 æ¡æ—¶è‡ªåŠ¨æç¤ºå‹ç¼©
- æŒ‰è®°å¿†ç±»å‹åˆ†å±‚å‹ç¼©ç­–ç•¥ï¼ˆfact æ°¸ä¹…ä¿ç•™ / preference åˆå¹¶ / history å®šæœŸå½’æ¡£ï¼‰
- ç¤ºä¾‹ Engram æ–°å¢ `preferences-archive.md` å±•ç¤ºå½’æ¡£æ ¼å¼

### å·²å®Œæˆï¼ˆv0.5.0ï¼‰

- `delete_memory` å·¥å…·ï¼šæŒ‰æ‘˜è¦ç²¾ç¡®åˆ é™¤ä¸€æ¡è®°å¿†ï¼ŒåŒæ—¶ä»ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ä¸­ç§»é™¤
- `correct_memory` å·¥å…·ï¼šä¿®æ­£å·²æœ‰è®°å¿†å†…å®¹ï¼Œæ›´æ–°ç´¢å¼•å’Œåˆ†ç±»æ–‡ä»¶ï¼Œæ”¯æŒé‡æ–°æŒ‡å®šç±»å‹å’Œæ ‡ç­¾
- `add_knowledge` å·¥å…·ï¼šå¯¹è¯ä¸­åŠ¨æ€å‘ Engram æ·»åŠ æ–°çŸ¥è¯†æ–‡ä»¶ï¼Œè‡ªåŠ¨æ›´æ–°çŸ¥è¯†ç´¢å¼•

### å·²å®Œæˆï¼ˆv0.8.0ï¼‰

- `engram-server stats`ï¼šCLI ç»Ÿè®¡å‘½ä»¤ï¼ŒæŸ¥çœ‹æ‰€æœ‰ Engram çš„è®°å¿†/çŸ¥è¯†/æ¡ˆä¾‹æ•°é‡ã€ç±»å‹åˆ†å¸ƒã€æœ€è¿‘æ´»åŠ¨
- `engram-server stats --tui`ï¼šRich æ¸²æŸ“ç‰ˆç»Ÿè®¡é¢æ¿ï¼ˆå½©è‰²è¡¨æ ¼ + é¢æ¿ï¼‰
- `rich>=13.0` ä½œä¸ºå¿…è£…ä¾èµ–ï¼Œä¸å½±å“ä¸€é”®å®‰è£…ä½“éªŒ

### å·²å®Œæˆï¼ˆv0.9.0ï¼‰

- `engram-server lint`ï¼šæ ¡éªŒç´¢å¼•ä¸€è‡´æ€§ã€uses å¼•ç”¨ã€meta åˆæ³•æ€§ã€extendsã€ç©ºçŸ¥è¯†æ–‡ä»¶ã€æœ€å°å¿…éœ€æ–‡ä»¶
- `engram-server stats --json / --csv`ï¼šæ”¯æŒæœºå™¨å¯è¯»å¯¼å‡ºæ ¼å¼
- system prompt ä¸æ¨¡æ¿è§„åˆ™æ–°å¢çŸ¥è¯†æå–å¼•å¯¼ï¼Œé¼“åŠ± AI ä¸»åŠ¨æ²‰æ·€ç»“æ„åŒ–çŸ¥è¯†

### å·²å®Œæˆï¼ˆv1.0.0ï¼‰

- åˆ†ç»„ç´¢å¼•ï¼š`add_knowledge` æ”¯æŒäºŒçº§ç›®å½•å†™å…¥ä¸å­ç´¢å¼•ä¼˜å…ˆæ›´æ–°
- `engram-server init --nested`ï¼šå¯ä¸€é”®ç”Ÿæˆå¸¦åˆ†ç»„ç´¢å¼•çš„æ¨¡æ¿
- é™æ€ Registryï¼šæ–°å¢ `registry.json`ã€`engram-server search`ã€`install` åç§°è§£æ
- README æ–°å¢å¤šè®¾å¤‡åŒæ­¥ç« èŠ‚ï¼ˆäº‘ç›˜ / Git ä¸¤ç§æ–¹æ¡ˆï¼‰

### å·²å®Œæˆï¼ˆv1.1.0ï¼‰

- å‚»ç“œå¼è‡ªç„¶è¯­è¨€è·¯ç”±ï¼šç”¨æˆ·åªè¯´éœ€æ±‚ï¼Œæ¨¡å‹é»˜è®¤è‡ªåŠ¨è°ƒç”¨ MCP å·¥å…·
- åˆ›å»ºåŠ©æ‰‹åŒæ¨¡å¼ï¼š`create_engram_assistant` æ”¯æŒ `from_conversation` ä¸ `guided`
- ç¡®è®¤åè½ç›˜ï¼š`finalize_engram_draft` è‡ªåŠ¨åˆ›å»ºæ–‡ä»¶å¹¶æ‰§è¡Œ `lint_engrams`
- è‡ªåŠ¨ç”Ÿæˆå†…å®¹é€æ˜æç¤ºï¼šè‰ç¨¿ä¼šæ ‡æ³¨ auto-filled å­—æ®µå¹¶æé†’â€œå¯èƒ½ä¸å®Œæ•´â€
- åˆ›å»ºé˜¶æ®µä¸è‡ªåŠ¨å†™å…¥ç”¨æˆ·è®°å¿†ï¼Œ`memory` ä¿æŒç©ºæ¨¡æ¿

### å·²å®Œæˆï¼ˆv1.2.0ï¼‰

- é¡¹ç›®çº§è‡ªåŠ¨åˆå§‹åŒ–ï¼šé¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆ›å»º `./.claude/engram/`
- è‡ªåŠ¨æ³¨å…¥åŒèµ·å§‹åŒ…ï¼š`starter-complete`ï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰+ `starter-template`ï¼ˆè¯´æ˜æ¨¡æ¿ï¼‰
- MCP å·¥å…·ï¼ˆ`install_engram` / `init_engram` / `finalize_engram_draft`ï¼‰é»˜è®¤å†™å…¥å½“å‰é¡¹ç›®ç›®å½•

### å·²å®Œæˆï¼ˆv1.3.0ï¼‰

- å·¥å…·è½¨è¿¹è‡ªåŠ¨è®°å¿†ï¼š`name` ç›¸å…³æ ¸å¿ƒ MCP å·¥å…·è°ƒç”¨ä¼šè‡ªåŠ¨å†™å…¥ `memory/tool-trace.md`
- æ–°å¢è½¨è¿¹å·¥å…·ï¼š`capture_tool_trace` / `list_tool_traces`ï¼Œå¯è®°å½•å¹¶å›çœ‹ Skills / MCP / Subagent / å¤–éƒ¨å·¥å…·è°ƒç”¨è¿‡ç¨‹
- registry å¤šæºåˆå¹¶ä¸è¦†ç›–ï¼šæ”¯æŒç”¨æˆ·çº§ã€é¡¹ç›®çº§ `registry.local.json` è¦†ç›–
- è¯„æµ‹èƒ½åŠ›å‡çº§ï¼š`evaluation/score_case_study.py` æ”¯æŒ content/safety/structure å¤šç»´è¯„åˆ†ä¸ weighted checkpoints
- `serve --packs-dir` å†™å…¥è·¯å¾„ç­–ç•¥ä¼˜åŒ–ï¼Œæ˜¾å¼è·¯å¾„ã€é¡¹ç›®è·¯å¾„ã€é»˜è®¤å…¨å±€è·¯å¾„è¡Œä¸ºæ›´ä¸€è‡´

### å·²å®Œæˆï¼ˆv1.4.0ï¼‰

- å†…ç½® Web UIï¼šå¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼Œæµè§ˆå™¨ä¸­æµè§ˆ/ç¼–è¾‘ Engram åŒ…
- `open_ui` MCP å·¥å…·ï¼šå¯¹è¯ä¸­è¯´"æ‰“å¼€ç®¡ç†ç•Œé¢"å³å¯è‡ªåŠ¨å¯åŠ¨æµè§ˆå™¨
- `engram-server ui` CLI å‘½ä»¤ï¼šç‹¬ç«‹è¿è¡Œ Web UIï¼Œä¸ä¾èµ– Claude Code
- æš—è‰²ä¸»é¢˜ SPAï¼šå¡ç‰‡å¼ Engram åˆ—è¡¨ã€æ–‡ä»¶æ ‘ + å†…è”ç¼–è¾‘å™¨ã€ç»Ÿè®¡é¢æ¿
- å¿«æ·é”®æ”¯æŒï¼šCmd+S / Ctrl+S ä¿å­˜æ–‡ä»¶

### è®¡åˆ’ä¸­

- `engram-server lint --fix`ï¼šè‡ªåŠ¨ä¿®å¤å­¤å„¿æ–‡ä»¶ã€æ— æ•ˆç´¢å¼•ã€ç©ºæ–‡ä»¶
- `search_engram_knowledge(name, query)`ï¼šæœåŠ¡ç«¯å…³é”®è¯æ‰«æä¸æ®µè½è¿”å›
- Engram ç¤¾åŒº registry

## è®¸å¯è¯

MIT
