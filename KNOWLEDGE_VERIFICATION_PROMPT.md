### 知识验证规则（workflow + knowledge）
- 目标：创建Engram 后，添加workflow / knowledge 的阶段要对 workflow / knowledge 中的事实性内容先联网核验；无法确认真伪的内容默认不写入最终知识。
- 验证级别（创建时可选）：
  - 快速：仅验证关键事实，单来源优先。
  - 平衡（默认）：关键事实双来源，非关键事实单来源。
  - 严格：事实性内容全量验证，关键事实必须双来源。
- 两种模式差异：
  - from_conversation：用户原话可保留并标注“用户陈述（未核验）/用户经验”；模型产出与外部引用按预筛结果选择性验证。
  - guided：模型生成的事实性内容默认全量进入验证队列（幻觉风险更高）。
- 阶段一（提取 + 预筛）：
  - 知识点分类：事实性 / 经验性 / 观点性。
  - from_conversation 额外做来源归属：用户说的 vs 模型说的。
  - 基于模型自信度预判：高确信基础事实可跳过联网，其他进入验证队列。
- 阶段二（批量验证）：
  - 按主题分组批量搜索，优先复用同轮已验证结论，避免逐条重复查询。
  - 关键知识点做交叉验证（至少两个独立来源），非关键可单来源佐证。
  - 来源优先级：官方文档 / 标准 / 论文 / 一手技术文档 > 其他；社区内容只能补充，不能单独作为“已验证”依据。
- 阶段三（草稿回显 + 三级标注）：
  - ✅ 已验证：写入并附来源 URL（脚注或注释）。
  - ⚠️ 部分佐证：可写入但要标注“部分佐证”，由用户决定保留或删除。
  - ❌ 无法验证：默认不写入，单独列出供用户选择是否强制加入。
  - 经验性内容标注“未验证-经验性”，不进行事实核验但明确告知边界。
- 异常与降级：
  - 联网失败/超时时，未验证事实只允许留在草稿“待验证”区，不写入最终 knowledge。
  - guided 模式下无法验证的模型事实默认丢弃；仅在用户明确确认时例外保留。
- finalize 前检查：
  - 草稿中每条知识应能看到验证状态（✅/⚠️/❌）与来源 URL 或未验证原因。
  - 默认遵循“不确定不写入”；若要保留未验证内容，必须先获得用户明确确认。
- 增量补查：
  - 后续使用中若引用到未验证知识，应补做一次联网核验，并在下次更新草稿/知识时补齐状态与来源。

## 一致性校验
- 只要模型新增/修改了 knowledge/examples/index/meta/rules，完成后自动调用 lint_engrams(name)。
- 解释规则：
  - error > 0：阻断，先修复再交付。
  - 仅 warning：可交付，但需向用户说明风险。
